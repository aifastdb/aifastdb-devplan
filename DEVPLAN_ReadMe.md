# AiFastDb-DevPlan å®Œæ•´åŠŸèƒ½æ–‡æ¡£

> æ–‡æ¡£ç‰ˆæœ¬: 1.1.0  
> åˆ›å»ºæ—¥æœŸ: 2026-02-09  
> æœ€åæ›´æ–°: 2026-02-13  
> é¡¹ç›®ä»“åº“: https://github.com/aifastdb/aifastdb-devplan  
> npm åŒ…: `aifastdb-devplan` v1.0.3  
> å…³è”é¡¹ç›®: `aifastdb` (åº•å±‚å­˜å‚¨å¼•æ“)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 èƒŒæ™¯ä¸å®šä½

**AiFastDb-DevPlan** æ˜¯ä¸€ä¸ªåŸºäº `aifastdb` å­˜å‚¨å¼•æ“çš„é€šç”¨å¼€å‘è®¡åˆ’ç®¡ç†ç³»ç»Ÿï¼Œä½œä¸ºç‹¬ç«‹çš„ **MCP Server** å‘å¸ƒï¼Œä¾› Cursor IDE å’Œ Claude Desktop ç­‰ AI å·¥å…·ä½¿ç”¨ã€‚

æ ¸å¿ƒèƒ½åŠ›ï¼š
- **æ–‡æ¡£ç®¡ç†**ï¼šå°†å¤§å‹å¼€å‘è®¡åˆ’æ–‡æ¡£æ‹†åˆ†ä¸ºç»“æ„åŒ–çš„ç‰‡æ®µï¼ˆ11 ç§æ ‡å‡†ç±»å‹ï¼‰ï¼ŒAI å¯æŒ‰éœ€è¯»å–
- **æ–‡æ¡£æœç´¢**ï¼šæ”¯æŒå­—é¢åŒ¹é…ã€è¯­ä¹‰æœç´¢ï¼ˆVibeSynapse Candle MiniLMï¼‰å’Œæ··åˆæœç´¢ï¼ˆRRF èåˆæ’åºï¼‰ï¼Œè‡ªåŠ¨é™çº§
- **ä»»åŠ¡è¿½è¸ª**ï¼šä¸»ä»»åŠ¡ï¼ˆå¼€å‘é˜¶æ®µï¼‰â†’ å­ä»»åŠ¡ï¼ˆå…·ä½“å·¥ä½œé¡¹ï¼‰çš„ä¸¤çº§ä»»åŠ¡ä½“ç³»ï¼Œè‡ªåŠ¨è®¡æ•°å’Œè¿›åº¦ç»Ÿè®¡
- **ä»»åŠ¡æ’åº**ï¼šä¸»ä»»åŠ¡å’Œå­ä»»åŠ¡æ”¯æŒ `order` æ’åºåºå·ï¼Œè‡ªåŠ¨åˆ†é…ã€ç¨³å®šæ’åº
- **é˜¶æ®µè‡ªåŠ¨æ‰§è¡Œ**ï¼šé€šè¿‡"å¼€å§‹ phase-X"æŒ‡ä»¤è‡ªåŠ¨å¯åŠ¨å¼€å‘é˜¶æ®µï¼ŒAI è‡ªåŠ¨åˆ›å»º TodoList å¹¶é€ä¸ªæ‰§è¡Œå­ä»»åŠ¡
- **æ¨¡å—èšåˆ**ï¼šé€šè¿‡åŠŸèƒ½æ¨¡å—ï¼ˆModuleï¼‰ç»´åº¦ç»„ç»‡ä»»åŠ¡å’Œæ–‡æ¡£ï¼Œæä¾›æ¨¡å—ä¸­å¿ƒè§†å›¾
- **Git é›†æˆ**ï¼šä»»åŠ¡å®Œæˆæ—¶é”šå®š Git commitï¼Œæ”¯æŒå›æ»šæ£€æµ‹å’ŒçŠ¶æ€åŒæ­¥
- **å¯è§†åŒ–**ï¼šå†…ç½®é¡¹ç›®å›¾è°±å’Œç»Ÿè®¡ä»ªè¡¨ç›˜ï¼Œå®æ—¶å±•ç¤ºé¡¹ç›®å…¨è²Œ

### 1.2 ç‰ˆæœ¬æ¼”è¿›

```
v1.0.0 (2026-02-08)  ä» ai_db ç‹¬ç«‹æ‹†åˆ†ï¼Œ16 ä¸ª MCP å·¥å…·
  â†“
v2.0.0 (2026-02-09)  åŒå¼•æ“æ¶æ„ â€” Graph (SocialGraphV2) + Document (JSONL)
  â†“
v2.1.0 (2026-02-09)  æ•°æ®è¿ç§»å·¥å…· â€” document â†” graph åŒå‘è¿ç§»
  â†“
v3.0.0 (2026-02-09)  é¡¹ç›®å›¾è°±æœåŠ¡ â€” vis-network äº¤äº’å¼å›¾è°±
  â†“
v3.x   (2026-02-09)  ç»Ÿè®¡ä»ªè¡¨ç›˜ã€ä¾§è¾¹æ å¯¼èˆªã€UI å¢å¼º
  â†“
v4.0.0 (2026-02-13)  ä»»åŠ¡æ’åº + è¯­ä¹‰æœç´¢ â€” order å­—æ®µã€VibeSynapse é›†æˆ
  â†“
v4.2.0 (2026-02-13)  æ–‡æ¡£åˆ—è¡¨å¼¹å±‚ + ç»Ÿè®¡æ å¢å¼º â€” å±‚çº§å±•ç¤ºã€/api/docs ç«¯ç‚¹
  â†“
v5.0.0 (è§„åˆ’ä¸­)      Autopilot æ¨¡å— â€” cursor_auto èåˆã€/api/auto/* ç«¯ç‚¹ã€3 ä¸ªæ–° MCP å·¥å…·
```

### 1.3 é¡¹ç›®ç»“æ„

```
aifastdb-devplan/
â”œâ”€â”€ package.json                        # npm åŒ…é…ç½® (v1.0.3)
â”œâ”€â”€ tsconfig.json                       # TypeScript é…ç½® (ES2020, CommonJS, strict)
â”œâ”€â”€ README.md                           # ä½¿ç”¨è¯´æ˜ï¼ˆä¸­è‹±åŒè¯­ï¼‰
â”œâ”€â”€ DEVPLAN_ReadMe.md                   # æœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ src/                                # TypeScript â€” DevPlan æ ¸å¿ƒ + MCP + å¯è§†åŒ–
â”‚   â”œâ”€â”€ types.ts                        # æ‰€æœ‰ç±»å‹å®šä¹‰ï¼ˆ463 è¡Œ + Autopilot ç±»å‹ï¼‰
â”‚   â”œâ”€â”€ dev-plan-interface.ts           # IDevPlanStore æŠ½è±¡æ¥å£ï¼ˆ249 è¡Œï¼Œ30+ æ–¹æ³•ï¼‰
â”‚   â”œâ”€â”€ dev-plan-document-store.ts      # Document å¼•æ“å®ç°ï¼ˆEnhancedDocumentStore/JSONLï¼‰
â”‚   â”œâ”€â”€ dev-plan-graph-store.ts         # Graph å¼•æ“å®ç°ï¼ˆSocialGraphV2ï¼‰
â”‚   â”œâ”€â”€ dev-plan-factory.ts             # å·¥å‚å‡½æ•° + å¼•æ“é€‰æ‹©é€»è¾‘
â”‚   â”œâ”€â”€ dev-plan-migrate.ts             # æ•°æ®è¿ç§»å·¥å…·ï¼ˆdocument â†” graphï¼‰
â”‚   â”œâ”€â”€ index.ts                        # npm åŒ…å¯¼å‡ºå…¥å£
â”‚   â”œâ”€â”€ mcp-server/
â”‚   â”‚   â””â”€â”€ index.ts                    # MCP Server â€” 23 ä¸ª devplan_* å·¥å…·ï¼ˆè§„åˆ’ +3 autopilot å·¥å…·ï¼‰
â”‚   â””â”€â”€ visualize/
â”‚       â”œâ”€â”€ template.ts                 # è‡ªåŒ…å« HTML æ¨¡æ¿ï¼ˆvis-network + æš—è‰²ä¸»é¢˜ï¼‰
â”‚       â””â”€â”€ server.ts                   # è½»é‡ HTTP æœåŠ¡å™¨ï¼ˆç°æœ‰ API + è§„åˆ’ /api/auto/* ç«¯ç‚¹ï¼‰
â”‚
â”œâ”€â”€ executor/                           # Python â€” Autopilot æ‰§è¡Œå™¨ï¼ˆè§„åˆ’ä¸­ï¼Œä» cursor_auto è¿å…¥ï¼‰
â”‚   â”œâ”€â”€ pyproject.toml                  #   Python ä¾èµ–ä¸é¡¹ç›®å…ƒæ•°æ®
â”‚   â”œâ”€â”€ README.md                       #   executor ä½¿ç”¨è¯´æ˜
â”‚   â”œâ”€â”€ src/                            #   Python æºç 
â”‚   â”‚   â”œâ”€â”€ engine.py                   #     ä¸»æ§å¼•æ“ï¼ˆåŒé€šé“å†³ç­–ï¼‰
â”‚   â”‚   â”œâ”€â”€ devplan_client.py           #     DevPlan HTTP å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ cursor_controller.py        #     GUI è‡ªåŠ¨åŒ–
â”‚   â”‚   â”œâ”€â”€ vision_analyzer.py          #     è§†è§‰åˆ†æï¼ˆç²¾ç®€åï¼‰
â”‚   â”‚   â”œâ”€â”€ ui_server.py                #     Web UI ç›‘æ§
â”‚   â”‚   â””â”€â”€ config.py                   #     é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ templates/                      #   Web UI å‰ç«¯
â”‚   â””â”€â”€ tests/                          #   Python æµ‹è¯•
â”‚
â””â”€â”€ .cursor/
    â””â”€â”€ rules/
        â””â”€â”€ dev-plan-management.mdc     # Cursor Rules é…ç½®
```

> **æ³¨æ„**ï¼š`executor/` ç›®å½•ä¸ºè§„åˆ’ä¸­çš„ Autopilot æ¨¡å—ï¼ˆv5.0.0ï¼‰ï¼Œè¯¦è§ [ç¬¬ 13 èŠ‚](#13-autopilot-æ¨¡å—--cursor_auto-èåˆæ–¹æ¡ˆ)ã€‚`tsconfig.json` çš„ `include: ["src/**/*"]` å’Œ `package.json` çš„ `files: ["dist"]` å¤©ç„¶æ’é™¤ `executor/`ï¼Œå¯¹ TypeScript ç¼–è¯‘å’Œ npm å‘å¸ƒé›¶å½±å“ã€‚

### 1.4 ä¾èµ–å…³ç³»

```
aifastdb-devplan (ç‹¬ç«‹é¡¹ç›®)
  â”‚
  â”œâ”€â”€ [TypeScript] src/
  â”‚   â”œâ”€â”€ aifastdb (^2.5.1)                 # åº•å±‚å­˜å‚¨å¼•æ“
  â”‚   â”‚   â”œâ”€â”€ EnhancedDocumentStore         # Document å¼•æ“çš„åº•å±‚ä¾èµ–
  â”‚   â”‚   â”œâ”€â”€ SocialGraphV2                 # Graph å¼•æ“çš„åº•å±‚ä¾èµ–ï¼ˆå« HNSW å‘é‡ç´¢å¼•ï¼‰
  â”‚   â”‚   â”œâ”€â”€ VibeSynapse                   # æ„ŸçŸ¥å¼•æ“ï¼ˆCandle MiniLM Embedding ç”Ÿæˆï¼‰
  â”‚   â”‚   â””â”€â”€ ContentType / DocumentInput   # ç±»å‹ä¾èµ–
  â”‚   â””â”€â”€ @modelcontextprotocol/sdk (^1.0.0) # MCP åè®® SDK
  â”‚
  â””â”€â”€ [Python] executor/ (è§„åˆ’ä¸­)
      â”œâ”€â”€ requests                          # HTTP å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨ /api/auto/* ç«¯ç‚¹ï¼‰
      â”œâ”€â”€ pyautogui                         # GUI è‡ªåŠ¨åŒ–ï¼ˆé¼ æ ‡ã€é”®ç›˜ã€æˆªå›¾ï¼‰
      â”œâ”€â”€ pygetwindow                       # çª—å£ç®¡ç†
      â”œâ”€â”€ ollama                            # è§†è§‰ AI æ¨¡å‹è°ƒç”¨
      â”œâ”€â”€ Pillow                            # å›¾åƒå¤„ç†
      â”œâ”€â”€ pyperclip                         # å‰ªè´´æ¿æ“ä½œ
      â””â”€â”€ Flask                             # Web UI ç›‘æ§åç«¯
```

ä¾èµ–æ–¹å‘å§‹ç»ˆæ˜¯ `aifastdb-devplan â†’ aifastdb`ï¼ˆå•å‘ä¾èµ–ï¼‰ï¼Œ`ai_db` ä¸çŸ¥æ™“ä¹Ÿä¸ä¾èµ– `aifastdb-devplan` çš„å­˜åœ¨ã€‚TypeScript å’Œ Python ä¹‹é—´é€šè¿‡ HTTP API é€šä¿¡ï¼Œæ— ç›´æ¥ä»£ç ä¾èµ–ã€‚

---

## 2. åŒå¼•æ“å­˜å‚¨æ¶æ„

### 2.1 æ¦‚è¿°

DevPlan æ”¯æŒä¸¤ç§å­˜å‚¨å¼•æ“ï¼Œæ¯ä¸ªé¡¹ç›®ç‹¬ç«‹é€‰æ‹©ï¼š

| å¼•æ“ | åº•å±‚å®ç° | æ•°æ®æ ¼å¼ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|------|---------|
| **graph** (é»˜è®¤) | `SocialGraphV2` | WAL + åˆ†ç‰‡æ–‡ä»¶ | å¤©ç„¶çš„å®ä½“-å…³ç³»æ¨¡å‹ï¼Œæ”¯æŒå›¾å¯¼å‡ºå’Œå¯è§†åŒ– | æ–°é¡¹ç›®ï¼ˆæ¨èï¼‰ |
| **document** | `EnhancedDocumentStore` | JSONL è¿½åŠ å†™å…¥ | è½»é‡ã€ç®€å•ã€å¤©ç„¶è·Ÿéš Git ç‰ˆæœ¬ | æ—§é¡¹ç›®å…¼å®¹ |

### 2.2 å¼•æ“é€‰æ‹©æœºåˆ¶

å¼•æ“é€‰æ‹©ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

| ä¼˜å…ˆçº§ | æ¡ä»¶ | é€‰æ‹©çš„å¼•æ“ |
|--------|------|-----------|
| 1 | `createDevPlan()` æ˜¾å¼ä¼ å…¥ `engine` å‚æ•° | ä½¿ç”¨æŒ‡å®šå¼•æ“ |
| 2 | `.devplan/{projectName}/engine.json` å·²å­˜åœ¨ | ä½¿ç”¨é…ç½®çš„å¼•æ“ |
| 3 | å·²æœ‰ JSONL æ•°æ®æ–‡ä»¶ï¼ˆ`documents.jsonl` / `tasks.jsonl`ï¼‰ | `document`ï¼ˆå‘åå…¼å®¹ï¼‰ |
| 4 | å…¨æ–°é¡¹ç›® | `graph`ï¼ˆé»˜è®¤ï¼‰ |

`engine.json` æ ¼å¼ï¼š

```json
{
  "engine": "graph",
  "version": "1.0.0"
}
```

### 2.3 Graph å¼•æ“æ•°æ®æ¨¡å‹æ˜ å°„

DevPlan çš„å±‚çº§ç»“æ„æ˜ å°„ä¸º `SocialGraphV2` çš„å®ä½“-å…³ç³»æ¨¡å‹ï¼š

**å®ä½“ç±»å‹ï¼ˆ5 ç§ï¼‰ï¼š**

| DevPlan æ¦‚å¿µ | Entity ç±»å‹ | è¯´æ˜ |
|-------------|-------------|------|
| é¡¹ç›® | `devplan-project` | æ ¹èŠ‚ç‚¹ |
| æ–‡æ¡£ç‰‡æ®µ | `devplan-doc` | section + subSection å”¯ä¸€æ ‡è¯† |
| ä¸»ä»»åŠ¡ | `devplan-main-task` | å¯¹åº”å¼€å‘é˜¶æ®µ |
| å­ä»»åŠ¡ | `devplan-sub-task` | å¯¹åº”å…·ä½“å·¥ä½œé¡¹ |
| åŠŸèƒ½æ¨¡å— | `devplan-module` | ç‹¬ç«‹åŠŸèƒ½åŒºåŸŸ |

**å…³ç³»ç±»å‹ï¼ˆ7 ç§ï¼‰ï¼š**

| å…³ç³»ç±»å‹ | æ–¹å‘ | è¯´æ˜ |
|---------|------|------|
| `has_document` | project â†’ doc | é¡¹ç›®æ‹¥æœ‰æ–‡æ¡£ |
| `has_main_task` | project â†’ main-task | é¡¹ç›®æ‹¥æœ‰ä¸»ä»»åŠ¡ |
| `has_sub_task` | main-task â†’ sub-task | ä¸»ä»»åŠ¡åŒ…å«å­ä»»åŠ¡ |
| `module_has_task` | module â†’ main-task | æ¨¡å—å…³è”ä¸»ä»»åŠ¡ |
| `module_has_doc` | module â†’ doc | æ¨¡å—å…³è”æ–‡æ¡£ |
| `task_has_doc` | main-task â†’ doc | ä¸»ä»»åŠ¡å…³è”æ–‡æ¡£ï¼ˆåŒå‘ï¼‰ |
| `doc_has_child` | doc â†’ doc | æ–‡æ¡£åŒ…å«å­æ–‡æ¡£ï¼ˆæ–‡æ¡£å±‚çº§å…³ç³»ï¼‰ |

### 2.4 æ•°æ®è¿ç§»

é€šè¿‡ `devplan_migrate_engine` MCP å·¥å…·æˆ– `migrateEngine()` API å®ç°åŒå‘è¿ç§»ï¼š

```
æºå¼•æ“å®ä¾‹ â†’ è¯»å–å…¨éƒ¨æ•°æ® â†’ [å¯é€‰] å¤‡ä»½æºæ•°æ® â†’ å†™å…¥ç›®æ ‡å¼•æ“ â†’ æ›´æ–° engine.json
```

æ•°æ®å†™å…¥é¡ºåºï¼ˆå°Šé‡ graph å¼•æ“çš„ä¾èµ–å…³ç³»ï¼‰ï¼š
1. **æ¨¡å—** (modules) â€” æ— ä¾èµ–
2. **æ–‡æ¡£** (documents) â€” æ— ä¾èµ–
3. **ä¸»ä»»åŠ¡** (mainTasks) â€” æ— ä¾èµ–
4. **å­ä»»åŠ¡** (subTasks) â€” ä¾èµ–ä¸»ä»»åŠ¡å­˜åœ¨

è¿ç§»å‚æ•°ï¼š

| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `projectName` | string | æ˜¯ | é¡¹ç›®åç§° |
| `targetEngine` | `"graph"` \| `"document"` | æ˜¯ | ç›®æ ‡å¼•æ“ç±»å‹ |
| `dryRun` | boolean | å¦ | é¢„è§ˆæ¨¡å¼ï¼ˆé»˜è®¤ `false`ï¼‰ |
| `backup` | boolean | å¦ | è¿ç§»å‰å¤‡ä»½ï¼ˆé»˜è®¤ `true`ï¼‰ |

---

## 3. æ ¸å¿ƒæ•°æ®æ¨¡å‹

### 3.1 æ–‡æ¡£ç‰‡æ®µ (DevPlanDoc)

å°†å¤§å‹å¼€å‘è®¡åˆ’æ–‡æ¡£æ‹†åˆ†ä¸ºç»“æ„åŒ–ç‰‡æ®µï¼Œæ”¯æŒ **11 ç§æ ‡å‡† section ç±»å‹**ï¼š

| Section ç±»å‹ | è¯´æ˜ | æ”¯æŒå­æ–‡æ¡£ |
|-------------|------|-----------|
| `overview` | æ¦‚è¿°ï¼šé¡¹ç›®èƒŒæ™¯ã€ç›®æ ‡ã€æ¶æ„å›¾ã€ç‰ˆæœ¬è¯´æ˜ | å¦ |
| `core_concepts` | æ ¸å¿ƒæ¦‚å¿µï¼šæœ¯è¯­å®šä¹‰ã€æ•°æ®æ¨¡å‹ã€å…³é”®æŠ½è±¡ | å¦ |
| `api_design` | API è®¾è®¡ï¼šæ¥å£å®šä¹‰ã€ç±»å‹ç³»ç»Ÿã€ä½¿ç”¨æ–¹å¼ | å¦ |
| `file_structure` | æ–‡ä»¶ç»“æ„ï¼šç›®å½•æ ‘ã€æ¨¡å—åˆ’åˆ†ã€ä»£ç ç»„ç»‡ | å¦ |
| `config` | é…ç½®è®¾è®¡ï¼šé…ç½®æ–‡ä»¶æ ¼å¼ã€ç¯å¢ƒå˜é‡ã€ç¤ºä¾‹ | å¦ |
| `examples` | ä½¿ç”¨ç¤ºä¾‹ï¼šä»£ç ç‰‡æ®µã€è°ƒç”¨æ¼”ç¤ºã€æœ€ä½³å®è·µ | å¦ |
| `technical_notes` | æŠ€æœ¯ç¬”è®°ï¼šæ€§èƒ½ã€å®‰å…¨ã€é”™è¯¯å¤„ç†ç­‰ | **æ˜¯**ï¼ˆé€šè¿‡ `subSection`ï¼‰ |
| `api_endpoints` | API ç«¯ç‚¹æ±‡æ€»ï¼šREST/RPC ç«¯ç‚¹åˆ—è¡¨ | å¦ |
| `milestones` | é‡Œç¨‹ç¢‘ï¼šç‰ˆæœ¬ç›®æ ‡ã€äº¤ä»˜èŠ‚ç‚¹ã€æ—¶é—´çº¿ | å¦ |
| `changelog` | å˜æ›´è®°å½•ï¼šç‰ˆæœ¬å†å²ã€ä¿®æ”¹å†…å®¹ | å¦ |
| `custom` | è‡ªå®šä¹‰ç« èŠ‚ï¼šç”¨æˆ·è‡ªè¡Œæ‰©å±• | **æ˜¯**ï¼ˆé€šè¿‡ `subSection`ï¼‰ |

**å…³é”®å­—æ®µï¼š**

```typescript
interface DevPlanDoc {
  id: string;                    // æ–‡æ¡£ ID
  projectName: string;           // é¡¹ç›®åç§°
  section: DevPlanSection;       // ç‰‡æ®µç±»å‹ï¼ˆ11 ç§ä¹‹ä¸€ï¼‰
  title: string;                 // æ–‡æ¡£æ ‡é¢˜
  content: string;               // Markdown å†…å®¹
  version: string;               // æ–‡æ¡£ç‰ˆæœ¬
  subSection?: string;           // å­åˆ†ç±»ï¼ˆç”¨äº technical_notes / customï¼‰
  moduleId?: string;             // å…³è”çš„åŠŸèƒ½æ¨¡å— ID
  relatedTaskIds?: string[];     // å…³è”çš„ä¸»ä»»åŠ¡ ID åˆ—è¡¨
  parentDoc?: string;            // çˆ¶æ–‡æ¡£æ ‡è¯†ï¼ˆ"section" æˆ– "section|subSection" æ ¼å¼ï¼‰
  childDocs?: string[];          // å­æ–‡æ¡£æ ‡è¯†åˆ—è¡¨ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼Œä»… Graph å¼•æ“æ”¯æŒï¼‰
  createdAt: number;             // åˆ›å»ºæ—¶é—´ï¼ˆUnix æ¯«ç§’ï¼‰
  updatedAt: number;             // æ›´æ–°æ—¶é—´ï¼ˆUnix æ¯«ç§’ï¼‰
}
```

### 3.2 ä¸»ä»»åŠ¡ (MainTask)

å¯¹åº”ä¸€ä¸ªå®Œæ•´çš„**å¼€å‘é˜¶æ®µ**ï¼Œä¸‹è¾–å¤šä¸ªå­ä»»åŠ¡ã€‚

```typescript
interface MainTask {
  id: string;                    // æ–‡æ¡£ ID
  projectName: string;           // é¡¹ç›®åç§°
  taskId: string;                // ä¸»ä»»åŠ¡æ ‡è¯†ï¼ˆå¦‚ "phase-7"ï¼‰
  title: string;                 // ä»»åŠ¡æ ‡é¢˜
  priority: 'P0' | 'P1' | 'P2'; // ä¼˜å…ˆçº§
  description?: string;          // ä»»åŠ¡æè¿°
  estimatedHours?: number;       // é¢„è®¡å·¥æ—¶
  moduleId?: string;             // å…³è”çš„åŠŸèƒ½æ¨¡å— ID
  relatedSections?: string[];    // å…³è”çš„æ–‡æ¡£ç‰‡æ®µï¼ˆæ ¼å¼ï¼š"section" æˆ– "section|subSection"ï¼‰
  order?: number;                // æ’åºåºå·ï¼ˆæ•°å€¼è¶Šå°è¶Šé å‰ï¼Œä¸å¡«åˆ™è‡ªåŠ¨åˆ†é…ï¼‰
  totalSubtasks: number;         // å­ä»»åŠ¡æ€»æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  completedSubtasks: number;     // å·²å®Œæˆå­ä»»åŠ¡æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  status: TaskStatus;            // pending | in_progress | completed | cancelled
  completedAt: number | null;    // å®Œæˆæ—¶é—´
  createdAt: number;
  updatedAt: number;
}
```

### 3.3 å­ä»»åŠ¡ (SubTask)

ä¸ Cursor IDE çš„ TodoList ç²’åº¦ä¸€è‡´ï¼Œæ˜¯æœ€å°çš„ä»»åŠ¡å•å…ƒã€‚

```typescript
interface SubTask {
  id: string;
  projectName: string;
  taskId: string;                // å­ä»»åŠ¡æ ‡è¯†ï¼ˆå¦‚ "T7.2"ï¼‰
  parentTaskId: string;          // çˆ¶ä¸»ä»»åŠ¡æ ‡è¯†ï¼ˆå¦‚ "phase-7"ï¼‰
  title: string;
  estimatedHours?: number;
  description?: string;
  relatedFiles?: string[];       // æ¶‰åŠçš„ä»£ç æ–‡ä»¶
  order?: number;                // æ’åºåºå·ï¼ˆæ•°å€¼è¶Šå°è¶Šé å‰ï¼Œä¸å¡«åˆ™è‡ªåŠ¨åˆ†é…ï¼‰
  status: TaskStatus;
  completedAt: number | null;
  completedAtCommit?: string;    // å®Œæˆæ—¶çš„ Git commit hashï¼ˆçŸ­ SHAï¼‰
  revertReason?: string;         // è¢« syncWithGit è‡ªåŠ¨å›é€€çš„åŸå› 
  createdAt: number;
  updatedAt: number;
}
```

### 3.4 åŠŸèƒ½æ¨¡å— (Module)

åŠŸèƒ½æ¨¡å—æ˜¯ä¸€ç­‰å®ä½“ï¼Œæä¾›**æ¨¡å—ç»´åº¦**çš„èšåˆè§†å›¾ã€‚ä¸€ä¸ªæ¨¡å—å¯ä»¥å…³è”å¤šä¸ªä¸»ä»»åŠ¡å’Œå¤šä¸ªæ–‡æ¡£ã€‚

```typescript
interface Module {
  id: string;
  projectName: string;
  moduleId: string;              // æ¨¡å—æ ‡è¯†ï¼ˆå¦‚ "vector-store"ï¼‰
  name: string;                  // æ¨¡å—åç§°ï¼ˆå¦‚ "å‘é‡å­˜å‚¨æ¨¡å—"ï¼‰
  description?: string;
  status: 'planning' | 'active' | 'completed' | 'deprecated';
  mainTaskCount: number;         // å…³è”çš„ä¸»ä»»åŠ¡æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  subTaskCount: number;          // å…³è”çš„å­ä»»åŠ¡æ€»æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  completedSubTaskCount: number; // å·²å®Œæˆå­ä»»åŠ¡æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  docCount: number;              // å…³è”çš„æ–‡æ¡£æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  createdAt: number;
  updatedAt: number;
}
```

### 3.5 å…³ç³»æ¨¡å‹

```
Module â”€â”€1:Nâ”€â”€â–¶ MainTask â”€â”€1:Nâ”€â”€â–¶ SubTask
Module â”€â”€1:Nâ”€â”€â–¶ DevPlanDoc
MainTask â—€â”€â”€N:Mâ”€â”€â–¶ DevPlanDoc   (é€šè¿‡ task_has_doc å…³ç³»åŒå‘å…³è”)

ä¸€ä¸ªæ¨¡å—å¯ä»¥å…³è”å¤šä¸ªä¸»ä»»åŠ¡å’Œå¤šä¸ªæ–‡æ¡£ã€‚
ä¸»ä»»åŠ¡é€šè¿‡ moduleId å­—æ®µå…³è”åˆ°ä¸€ä¸ªæ¨¡å—ã€‚
æ–‡æ¡£é€šè¿‡ moduleId å­—æ®µå…³è”åˆ°ä¸€ä¸ªæ¨¡å—ã€‚
å­ä»»åŠ¡é€šè¿‡çˆ¶ä¸»ä»»åŠ¡é—´æ¥å…³è”åˆ°æ¨¡å—ã€‚

ä¸»ä»»åŠ¡å¯é€šè¿‡ relatedSections å­—æ®µè®°å½•å…³è”çš„æ–‡æ¡£ç‰‡æ®µï¼›
æ–‡æ¡£å¯é€šè¿‡ relatedTaskIds å­—æ®µè®°å½•å…³è”çš„ä¸»ä»»åŠ¡ã€‚
åœ¨ Graph å¼•æ“ä¸­ï¼Œè¿™ç§åŒå‘å…³ç³»é€šè¿‡ task_has_doc å…³ç³»ç±»å‹ç‰©ç†å­˜å‚¨ï¼›
åœ¨ Document å¼•æ“ä¸­ï¼Œå…³ç³»é€šè¿‡ä¸¤ä¾§çš„å­—æ®µç»´æŠ¤ã€‚
```

---

## 4. MCP å·¥å…·ï¼ˆ23 ä¸ªï¼Œè§„åˆ’æ‰©å±•è‡³ 26 ä¸ªï¼‰

`aifastdb-devplan` ä½œä¸º MCP Server æä¾› 23 ä¸ªå·¥å…·ï¼Œå·¥å…·åç»Ÿä¸€ä»¥ `devplan_` ä¸ºå‰ç¼€ã€‚è§„åˆ’ä¸­çš„ v5.0.0 å°†æ–°å¢ 3 ä¸ª `devplan_auto_*` å·¥å…·ï¼ˆè¯¦è§ [ç¬¬ 13.4.1 èŠ‚](#1341-æ–°å¢-mcp-å·¥å…·3-ä¸ª--å…±-26-ä¸ª)ï¼‰ã€‚

### 4.1 åˆå§‹åŒ–ï¼ˆ1 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_init` | åˆå§‹åŒ–é¡¹ç›®å¼€å‘è®¡åˆ’ï¼›ä¸ä¼  `projectName` åˆ™åˆ—å‡ºå·²æœ‰è®¡åˆ’ | â€” | `projectName` |

è¿”å›å€¼åŒ…å« `engine`ï¼ˆå½“å‰å¼•æ“ç±»å‹ï¼‰ã€`availableEngines`ï¼ˆå¯ç”¨å¼•æ“åˆ—è¡¨ï¼‰ã€`availableSections`ï¼ˆ11 ç§æ–‡æ¡£ç±»å‹ï¼‰ã€‚

### 4.2 æ–‡æ¡£ç®¡ç†ï¼ˆ3 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_save_section` | ä¿å­˜/æ›´æ–°æ–‡æ¡£ç‰‡æ®µï¼ˆåŒ section+subSection å·²å­˜åœ¨åˆ™è¦†ç›–ï¼‰ | `projectName`, `section`, `title`, `content` | `version`, `subSection`, `moduleId`, `relatedTaskIds`, `parentDoc` |
| `devplan_get_section` | è¯»å–æŒ‡å®šæ–‡æ¡£ç‰‡æ®µ | `projectName`, `section` | `subSection` |
| `devplan_list_sections` | åˆ—å‡ºé¡¹ç›®çš„æ‰€æœ‰æ–‡æ¡£ç‰‡æ®µ | `projectName` | â€” |

`section` å¯é€‰å€¼ï¼š`overview`, `core_concepts`, `api_design`, `file_structure`, `config`, `examples`, `technical_notes`, `api_endpoints`, `milestones`, `changelog`, `custom`

### 4.3 ä»»åŠ¡ç®¡ç†ï¼ˆ6 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_create_main_task` | åˆ›å»ºä¸»ä»»åŠ¡ï¼ˆå¼€å‘é˜¶æ®µï¼‰ | `projectName`, `taskId`, `title`, `priority` | `description`, `estimatedHours`, `moduleId`, `relatedDocSections`, `order` |
| `devplan_add_sub_task` | åœ¨ä¸»ä»»åŠ¡ä¸‹æ·»åŠ å­ä»»åŠ¡ | `projectName`, `taskId`, `parentTaskId`, `title` | `estimatedHours`, `description`, `order` |
| `devplan_upsert_task` | å¹‚ç­‰å¯¼å…¥ï¼ˆupsertï¼‰ä¸»ä»»åŠ¡æˆ–å­ä»»åŠ¡ï¼Œé˜²æ­¢é‡å¤ | `projectName`, `taskType`, `taskId`, `title` | `priority`, `parentTaskId`, `description`, `estimatedHours`, `status`, `preserveStatus`, `moduleId`, `relatedDocSections`, `order` |
| `devplan_complete_task` | å®Œæˆä»»åŠ¡ï¼ˆè‡ªåŠ¨æ›´æ–°ä¸»ä»»åŠ¡è¿›åº¦ã€é”šå®š Git commitï¼‰ | `projectName`, `taskId` | `taskType`ï¼ˆé»˜è®¤ `"sub"`ï¼‰ |
| `devplan_list_tasks` | åˆ—å‡ºä»»åŠ¡ï¼ˆæ”¯æŒå¤šç§æŸ¥è¯¢æ¨¡å¼ï¼‰ | `projectName` | `parentTaskId`, `status`, `priority`, `moduleId` |
| `devplan_start_phase` | å¯åŠ¨/æ¢å¤å¼€å‘é˜¶æ®µï¼ˆè‡ªåŠ¨æ ‡è®° in_progressï¼Œè¿”å›å…¨éƒ¨å­ä»»åŠ¡ï¼‰ | `projectName`, `taskId` | â€” |

**`devplan_list_tasks` çš„ä¸‰ç§æŸ¥è¯¢æ¨¡å¼ï¼š**

| æ¡ä»¶ | è¡Œä¸º |
|------|------|
| ä¼ äº† `parentTaskId` | åˆ—å‡ºæŒ‡å®šä¸»ä»»åŠ¡ä¸‹çš„å­ä»»åŠ¡ |
| æœªä¼  `parentTaskId` ä½†ä¼ äº† `status` | è·¨æ‰€æœ‰ä¸»ä»»åŠ¡èšåˆåŒ¹é…çŠ¶æ€çš„å­ä»»åŠ¡ |
| ä¸¤è€…éƒ½æœªä¼  | åˆ—å‡ºä¸»ä»»åŠ¡åˆ—è¡¨ |

**`order` å‚æ•° â€” ä»»åŠ¡æ’åºï¼š**

ä¸»ä»»åŠ¡å’Œå­ä»»åŠ¡å‡æ”¯æŒ `order` æ’åºåºå·ï¼Œæ§åˆ¶åˆ—è¡¨ä¸­çš„æ˜¾ç¤ºé¡ºåºï¼š

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| æ•°å€¼è¶Šå°è¶Šé å‰ | `order: 1` æ’åœ¨ `order: 2` å‰é¢ |
| ä¸å¡«åˆ™è‡ªåŠ¨åˆ†é… | è‡ªåŠ¨å–å½“å‰æœ€å¤§ order + 1ï¼Œè¿½åŠ åˆ°æœ«å°¾ |
| null æ’æœ€å | æœªè®¾ç½® order çš„ä»»åŠ¡æ’åœ¨æ‰€æœ‰æœ‰ order çš„ä»»åŠ¡ä¹‹å |
| ç›¸åŒ order æŒ‰åˆ›å»ºæ—¶é—´ | order ç›¸åŒæ—¶ï¼ŒæŒ‰ `createdAt` å‡åºæ’åˆ— |

æ’åºç”Ÿæ•ˆäº `devplan_list_tasks`ã€`devplan_start_phase` çš„è¿”å›ç»“æœï¼Œä»¥åŠ `devplan_export_markdown` çš„è¾“å‡ºé¡ºåºã€‚

**`devplan_upsert_task` çš„çŠ¶æ€ä¿æŠ¤ï¼š**

å½“ `preserveStatus` ä¸º `true`ï¼ˆé»˜è®¤ï¼‰æ—¶ï¼Œå·²æœ‰çš„æ›´é«˜ä¼˜å…ˆçº§çŠ¶æ€ä¼šè¢«ä¿ç•™ã€‚ä¾‹å¦‚å·²å®Œæˆçš„ä»»åŠ¡ä¸ä¼šè¢«å›é€€ä¸º pendingã€‚çŠ¶æ€ä¼˜å…ˆçº§ï¼š`completed > in_progress > pending`ã€‚

**`devplan_start_phase` â€” å¯åŠ¨/æ¢å¤å¼€å‘é˜¶æ®µï¼ˆè‡ªåŠ¨æ‰§è¡Œå¼€å‘ä»»åŠ¡ï¼‰ï¼š**

å½“ç”¨æˆ·è¯´å‡º"å¼€å§‹/ç»§ç»­/æ¢å¤ phase-X å¼€å‘"æ—¶ï¼ŒAI è‡ªåŠ¨è°ƒç”¨æ­¤å·¥å…·å¯åŠ¨å¼€å‘é˜¶æ®µã€‚è¿™æ˜¯ä¸€ä¸ª**å¹‚ç­‰æ“ä½œ**ï¼šé¦–æ¬¡è°ƒç”¨ä¸ºå¯åŠ¨ï¼Œå†æ¬¡è°ƒç”¨ä¸ºæ¢å¤ï¼ˆå·²å®Œæˆå­ä»»åŠ¡ä¿æŒ completed çŠ¶æ€ï¼‰ã€‚

| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `projectName` | string | æ˜¯ | é¡¹ç›®åç§° |
| `taskId` | string | æ˜¯ | ä¸»ä»»åŠ¡ IDï¼ˆå¦‚ `"phase-23"`ï¼‰ |

**è¿”å›å€¼ç»“æ„ï¼š**

```typescript
{
  mainTask: {
    taskId: string;          // ä¸»ä»»åŠ¡ ID
    title: string;           // ä¸»ä»»åŠ¡æ ‡é¢˜
    priority: string;        // ä¼˜å…ˆçº§
    status: 'in_progress';   // å§‹ç»ˆè¿”å› in_progress
    description?: string;    // æè¿°
    estimatedHours?: number; // é¢„è®¡å·¥æ—¶
    moduleId?: string;       // å…³è”æ¨¡å—
    totalSubtasks: number;   // å­ä»»åŠ¡æ€»æ•°
    completedSubtasks: number; // å·²å®Œæˆå­ä»»åŠ¡æ•°
  };
  subTasks: [{               // å…¨éƒ¨å­ä»»åŠ¡åˆ—è¡¨
    taskId: string;
    title: string;
    status: TaskStatus;      // ä¿ç•™å®é™…çŠ¶æ€ï¼ˆcompleted/pending/in_progressï¼‰
    description?: string;
    estimatedHours?: number;
  }];
  relatedDocSections: string[];  // å…³è”çš„æ–‡æ¡£ç‰‡æ®µæ ‡è¯†åˆ—è¡¨
  message: string;               // æ‘˜è¦ä¿¡æ¯
}
```

**è‡ªåŠ¨æ‰§è¡Œå·¥ä½œæµï¼ˆAI ç«¯è¡Œä¸ºï¼‰ï¼š**

```
ç”¨æˆ·: "å¼€å§‹ phase-23 å¼€å‘"
  â†“
1. AI è°ƒç”¨ devplan_start_phase(projectName, taskId: "phase-23")
  â†“
2. å·¥å…·è‡ªåŠ¨å°†ä¸»ä»»åŠ¡çŠ¶æ€æ ‡è®°ä¸º in_progressï¼ˆå·²æ˜¯ in_progress/completed åˆ™è·³è¿‡ï¼‰
  â†“
3. å·¥å…·è¿”å›ä¸»ä»»åŠ¡ä¿¡æ¯ + å…¨éƒ¨å­ä»»åŠ¡åˆ—è¡¨ï¼ˆå«å·²å®ŒæˆçŠ¶æ€ï¼‰
  â†“
4. AI å°†å­ä»»åŠ¡åˆ—è¡¨è½¬ä¸º Cursor TodoListï¼ˆä½¿ç”¨ TodoWriteï¼‰
   - completed å­ä»»åŠ¡ â†’ æ ‡è®°ä¸º completed
   - pending å­ä»»åŠ¡ â†’ æ ‡è®°ä¸º pending
  â†“
5. AI è¾“å‡ºé˜¶æ®µè¿›åº¦æ‘˜è¦ï¼ˆå·²å®Œæˆ X/Yï¼Œå‰©ä½™ Z ä¸ªï¼‰
  â†“
6. AI è‡ªåŠ¨å®šä½ç¬¬ä¸€ä¸ª pending å­ä»»åŠ¡ï¼Œå¼€å§‹æ‰§è¡Œå¼€å‘ä»»åŠ¡
  â†“
7. æ¯å®Œæˆä¸€ä¸ªå­ä»»åŠ¡ â†’ devplan_complete_task å›å†™çŠ¶æ€ â†’ æ›´æ–° Todo â†’ ç»§ç»­ä¸‹ä¸€ä¸ª
  â†“
8. æ‰€æœ‰å­ä»»åŠ¡å®Œæˆåï¼Œdevplan è‡ªåŠ¨æ ‡è®°ä¸»ä»»åŠ¡ä¸º completed
```

### 4.4 è¿›åº¦ä¸å¯¼å‡ºï¼ˆ2 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_get_progress` | è·å–é¡¹ç›®æ•´ä½“è¿›åº¦ï¼šæ–‡æ¡£ç‰‡æ®µæ•°ã€ä¸»ä»»åŠ¡æ•°ã€å­ä»»åŠ¡å®Œæˆç‡ã€å„é˜¶æ®µè¿›åº¦æ¡ | `projectName` | â€” |
| `devplan_export_markdown` | å¯¼å‡ºå¼€å‘è®¡åˆ’ä¸º Markdown æ–‡æ¡£ | `projectName` | `scope`ï¼ˆ`"full"` æˆ– `"tasks"`ï¼Œé»˜è®¤ `"tasks"`ï¼‰ |

### 4.5 æ¨¡å—ç®¡ç†ï¼ˆ4 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_create_module` | åˆ›å»º/æ³¨å†ŒåŠŸèƒ½æ¨¡å— | `projectName`, `moduleId`, `name` | `description`, `status` |
| `devplan_list_modules` | åˆ—å‡ºæ‰€æœ‰åŠŸèƒ½æ¨¡å—ï¼ˆå«ä»»åŠ¡æ•°ã€æ–‡æ¡£æ•°ç»Ÿè®¡ï¼‰ | `projectName` | `status` |
| `devplan_get_module` | è·å–æ¨¡å—è¯¦æƒ…ï¼ˆå«å…³è”çš„ä¸»ä»»åŠ¡ã€å­ä»»åŠ¡ã€æ–‡æ¡£ï¼‰ | `projectName`, `moduleId` | â€” |
| `devplan_update_module` | æ›´æ–°æ¨¡å—ä¿¡æ¯ | `projectName`, `moduleId` | `name`, `description`, `status` |

æ¨¡å—çŠ¶æ€ï¼ˆ`status`ï¼‰å¯é€‰å€¼ï¼š`planning`, `active`, `completed`, `deprecated`

### 4.6 æ–‡æ¡£æœç´¢ï¼ˆ2 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_search_sections` | æœç´¢æ–‡æ¡£ç‰‡æ®µï¼ˆæ”¯æŒå­—é¢/è¯­ä¹‰/æ··åˆä¸‰ç§æ¨¡å¼ï¼‰ | `projectName`, `query` | `mode`, `limit`, `minScore` |
| `devplan_rebuild_index` | é‡å»ºæ‰€æœ‰æ–‡æ¡£çš„å‘é‡ Embedding ç´¢å¼• | `projectName` | â€” |

**`devplan_search_sections` â€” ä¸‰ç§æœç´¢æ¨¡å¼ï¼š**

| æ¨¡å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `literal` | çº¯å­—é¢åŒ¹é…ï¼ˆæ ‡é¢˜/å†…å®¹åŒ…å«æŸ¥è¯¢è¯ï¼‰ | ç²¾ç¡®å…³é”®è¯æœç´¢ |
| `semantic` | çº¯è¯­ä¹‰å‘é‡æœç´¢ï¼ˆembed(query) â†’ å‘é‡è¿‘é‚»ï¼‰ | æ¦‚å¿µæ€§æœç´¢ï¼ˆå¦‚æœ"å®‰å…¨"å¯åŒ¹é…"æƒé™æ§åˆ¶"ï¼‰ |
| `hybrid`ï¼ˆé»˜è®¤ï¼‰ | å­—é¢ + è¯­ä¹‰ RRF èåˆæ’åº | æ¨èçš„æ—¥å¸¸æœç´¢æ¨¡å¼ |

**å‚æ•°è¯´æ˜ï¼š**

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `query` | string | (å¿…éœ€) | æœç´¢æŸ¥è¯¢æ–‡æœ¬ |
| `mode` | `"literal"` \| `"semantic"` \| `"hybrid"` | `"hybrid"` | æœç´¢æ¨¡å¼ |
| `limit` | number | 10 | æœ€å¤§è¿”å›ç»“æœæ•° |
| `minScore` | number | 0 | æœ€ä½ç›¸å…³æ€§è¯„åˆ†é˜ˆå€¼ï¼ˆ0~1ï¼‰ |

**è¯­ä¹‰æœç´¢å‰ç½®æ¡ä»¶**ï¼šéœ€è¦ graph å¼•æ“ + `.devplan/config.json` ä¸­å¯ç”¨ `enableSemanticSearch: true`ã€‚VibeSynapseï¼ˆCandle MiniLM-L6-v2ï¼Œ384 ç»´ï¼‰è‡ªåŠ¨åˆå§‹åŒ–ã€‚è¯­ä¹‰æœç´¢ä¸å¯ç”¨æ—¶ï¼Œ`semantic`/`hybrid` æ¨¡å¼è‡ªåŠ¨é™çº§ä¸º `literal`ã€‚

**è¿”å›å€¼**åŒ…å« `score` å­—æ®µï¼ˆ0~1 ç›¸å…³æ€§è¯„åˆ†ï¼‰ï¼Œ`literal` æ¨¡å¼ä¸æä¾›è¯„åˆ†ã€‚

**`devplan_rebuild_index`** é‡å»ºæ‰€æœ‰æ–‡æ¡£çš„å‘é‡ Embedding ç´¢å¼•ã€‚é€‚ç”¨äºï¼šé¦–æ¬¡å¯ç”¨è¯­ä¹‰æœç´¢ã€åˆ‡æ¢ Embedding æ¨¡å‹ã€ä¿®å¤æŸåçš„ç´¢å¼•ã€‚è¿”å› `{ total, indexed, failed, durationMs }` ç»Ÿè®¡ä¿¡æ¯ã€‚

### 4.7 é«˜çº§åŠŸèƒ½ï¼ˆ5 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_sync_git` | åŒæ­¥ Git å†å²ä¸ä»»åŠ¡çŠ¶æ€ï¼ˆæ£€æµ‹å›æ»šè‡ªåŠ¨å›é€€ï¼‰ | `projectName` | `dryRun` |
| `devplan_export_graph` | å¯¼å‡ºå›¾ç»“æ„ç”¨äºå¯è§†åŒ–ï¼ˆä»… graph å¼•æ“ï¼‰ | `projectName` | `includeDocuments`, `includeModules` |
| `devplan_migrate_engine` | åœ¨ document â†” graph å¼•æ“ä¹‹é—´è¿ç§»æ•°æ® | `projectName`, `targetEngine` | `backup`, `dryRun` |
| `devplan_start_visual` | å¯åŠ¨é¡¹ç›®å›¾è°± HTTP æœåŠ¡å™¨ï¼ˆåå°è¿è¡Œï¼‰ | `projectName` | `port`ï¼ˆé»˜è®¤ 3210ï¼‰ |

**`devplan_start_visual`** ä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ªè½»é‡ HTTP æœåŠ¡å™¨ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨å±•ç¤ºäº¤äº’å¼é¡¹ç›®å›¾è°±é¡µé¢ã€‚ä»…æ”¯æŒä½¿ç”¨ graph å¼•æ“çš„é¡¹ç›®ã€‚

---

## 5. æ ¸å¿ƒæ¥å£ (IDevPlanStore)

`IDevPlanStore` å®šä¹‰äº† DevPlan çš„å…¨éƒ¨å­˜å‚¨æ“ä½œæ¥å£ï¼ˆ30+ æ–¹æ³•ï¼‰ï¼Œä¾›ä¸¤ä¸ªå¼•æ“å®ç°å…±ç”¨ï¼š
- `DevPlanDocumentStore` â€” åŸºäº `EnhancedDocumentStore`ï¼ˆJSONL æŒä¹…åŒ–ï¼‰
- `DevPlanGraphStore` â€” åŸºäº `SocialGraphV2`ï¼ˆå›¾ç»“æ„å­˜å‚¨ + å¯è§†åŒ–ï¼‰

### 5.1 æ–‡æ¡£æ“ä½œï¼ˆ6 + 5 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `saveSection(input)` | ä¿å­˜æ–‡æ¡£ç‰‡æ®µï¼ˆå·²å­˜åœ¨åˆ™è¦†ç›–ï¼Œå¯ç”¨è¯­ä¹‰æœç´¢æ—¶è‡ªåŠ¨ç´¢å¼•ï¼Œæ”¯æŒ `parentDoc` å»ºç«‹æ–‡æ¡£å±‚çº§ï¼‰ |
| `getSection(section, subSection?)` | è·å–æ–‡æ¡£ç‰‡æ®µï¼ˆè¿”å›å« `parentDoc` å’Œ `childDocs` å­—æ®µï¼‰ |
| `listSections()` | åˆ—å‡ºé¡¹ç›®çš„æ‰€æœ‰æ–‡æ¡£ç‰‡æ®µï¼ˆå»é‡åï¼Œå« `parentDoc` å­—æ®µï¼‰ |
| `updateSection(section, content, subSection?)` | æ›´æ–°æ–‡æ¡£ç‰‡æ®µå†…å®¹ |
| `searchSections(query, limit?)` | æœç´¢æ–‡æ¡£ç‰‡æ®µï¼ˆåŸºç¡€ç‰ˆï¼Œå¯ç”¨è¯­ä¹‰æœç´¢æ—¶è‡ªåŠ¨ä½¿ç”¨ hybrid æ¨¡å¼ï¼‰ |
| `deleteSection(section, subSection?)` | åˆ é™¤æ–‡æ¡£ç‰‡æ®µï¼ˆåŒæ—¶æ¸…ç†å‘é‡ç´¢å¼•å’Œæ–‡æ¡£å±‚çº§å…³ç³»ï¼‰ |
| `getChildDocs?(section, subSection?)` | è·å–æ–‡æ¡£çš„ç›´æ¥å­æ–‡æ¡£åˆ—è¡¨ï¼ˆå¯é€‰æ–¹æ³•ï¼‰ |
| `getDocTree?(section, subSection?)` | è·å–æ–‡æ¡£æ ‘ï¼ˆé€’å½’å«æ‰€æœ‰åä»£ï¼Œä»… Graph å¼•æ“æ”¯æŒï¼Œå¯é€‰æ–¹æ³•ï¼‰ |
| `searchSectionsAdvanced?(query, options?)` | é«˜çº§æœç´¢ï¼šæ”¯æŒ literal/semantic/hybrid ä¸‰ç§æ¨¡å¼ï¼Œè¿”å›å¸¦è¯„åˆ†ç»“æœï¼ˆå¯é€‰æ–¹æ³•ï¼‰ |
| `rebuildIndex?()` | é‡å»ºæ‰€æœ‰æ–‡æ¡£çš„å‘é‡ Embedding ç´¢å¼•ï¼ˆå¯é€‰æ–¹æ³•ï¼‰ |
| `isSemanticSearchEnabled?()` | æ£€æŸ¥è¯­ä¹‰æœç´¢æ˜¯å¦å¯ç”¨ï¼ˆå¯é€‰æ–¹æ³•ï¼‰ |

### 5.2 ä¸»ä»»åŠ¡æ“ä½œï¼ˆ5 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `createMainTask(input)` | åˆ›å»ºä¸»ä»»åŠ¡ |
| `upsertMainTask(input, options?)` | å¹‚ç­‰å¯¼å…¥ä¸»ä»»åŠ¡ï¼ˆUpsertï¼‰ |
| `getMainTask(taskId)` | è·å–ä¸»ä»»åŠ¡ |
| `listMainTasks(filter?)` | åˆ—å‡ºä¸»ä»»åŠ¡ï¼ˆå¯æŒ‰ status/priority/moduleId è¿‡æ»¤ï¼‰ |
| `updateMainTaskStatus(taskId, status)` | æ›´æ–°ä¸»ä»»åŠ¡çŠ¶æ€ |

### 5.3 å­ä»»åŠ¡æ“ä½œï¼ˆ5 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `addSubTask(input)` | æ·»åŠ å­ä»»åŠ¡ |
| `upsertSubTask(input, options?)` | å¹‚ç­‰å¯¼å…¥å­ä»»åŠ¡ï¼ˆUpsertï¼‰ |
| `getSubTask(taskId)` | è·å–å­ä»»åŠ¡ |
| `listSubTasks(parentTaskId, filter?)` | åˆ—å‡ºæŸä¸»ä»»åŠ¡ä¸‹çš„æ‰€æœ‰å­ä»»åŠ¡ |
| `updateSubTaskStatus(taskId, status, options?)` | æ›´æ–°å­ä»»åŠ¡çŠ¶æ€ |

### 5.4 å®Œæˆå·¥ä½œæµï¼ˆ2 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `completeSubTask(taskId)` | **æ ¸å¿ƒè‡ªåŠ¨åŒ–æ–¹æ³•**ï¼šæ›´æ–°å­ä»»åŠ¡çŠ¶æ€ â†’ é”šå®š Git commit â†’ åˆ·æ–°ä¸»ä»»åŠ¡è®¡æ•° â†’ å…¨éƒ¨å®Œæˆæ—¶è‡ªåŠ¨æ ‡è®°ä¸»ä»»åŠ¡ |
| `completeMainTask(taskId)` | æ‰‹åŠ¨å®Œæˆä¸»ä»»åŠ¡ï¼ˆè·³è¿‡å­ä»»åŠ¡æ£€æŸ¥ï¼‰ |

### 5.5 è¿›åº¦ä¸å¯¼å‡ºï¼ˆ3 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `getProgress()` | è·å–é¡¹ç›®æ•´ä½“è¿›åº¦ï¼ˆè¿”å› `ProjectProgress`ï¼‰ |
| `exportToMarkdown()` | å¯¼å‡ºå®Œæ•´çš„ Markdown æ–‡æ¡£ |
| `exportTaskSummary()` | å¯¼å‡ºä»…ä»»åŠ¡è¿›åº¦çš„ç®€æ´ Markdown |

### 5.6 æ¨¡å—æ“ä½œï¼ˆ6 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `createModule(input)` | åˆ›å»ºåŠŸèƒ½æ¨¡å— |
| `getModule(moduleId)` | è·å–åŠŸèƒ½æ¨¡å—ï¼ˆå«è‡ªåŠ¨è®¡ç®—çš„ taskCount/docCountï¼‰ |
| `listModules(filter?)` | åˆ—å‡ºæ‰€æœ‰åŠŸèƒ½æ¨¡å— |
| `updateModule(moduleId, updates)` | æ›´æ–°åŠŸèƒ½æ¨¡å— |
| `deleteModule(moduleId)` | åˆ é™¤åŠŸèƒ½æ¨¡å— |
| `getModuleDetail(moduleId)` | è·å–æ¨¡å—è¯¦æƒ…ï¼ˆå«å…³è”çš„ä»»åŠ¡å’Œæ–‡æ¡£ï¼‰ |

### 5.7 å·¥å…·æ–¹æ³•ï¼ˆ3 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `sync()` | å°†å­˜å‚¨çš„æ›´æ”¹åˆ·åˆ°ç£ç›˜ |
| `getProjectName()` | è·å–é¡¹ç›®åç§° |
| `syncWithGit(dryRun?)` | åŒæ­¥æ£€æŸ¥å·²å®Œæˆä»»åŠ¡ä¸ Git å†å²çš„ä¸€è‡´æ€§ |

### 5.8 å›¾å¯¼å‡ºï¼ˆå¯é€‰ï¼Œ1 ä¸ªæ–¹æ³•ï¼‰

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `exportGraph?(options?)` | å¯¼å‡ºå›¾ç»“æ„ç”¨äºå¯è§†åŒ–ï¼ˆä»… `DevPlanGraphStore` æ”¯æŒï¼‰ |

è¿”å› `{ nodes: DevPlanGraphNode[], edges: DevPlanGraphEdge[] }`ï¼Œå…¼å®¹ `vis-network`ã€‚

---

## 6. Git é›†æˆ

### 6.1 Commit é”šå®š

å½“é€šè¿‡ `completeSubTask(taskId)` å®Œæˆå­ä»»åŠ¡æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ï¼š

1. è°ƒç”¨ `git rev-parse --short HEAD` è·å–å½“å‰ commit çŸ­ hash
2. å°† hash å†™å…¥å­ä»»åŠ¡çš„ `completedAtCommit` å­—æ®µ
3. åŒæ—¶è®°å½• `completedAt` æ—¶é—´æˆ³

è¿™å»ºç«‹äº†**ä»»åŠ¡å®ŒæˆçŠ¶æ€ä¸ä»£ç ç‰ˆæœ¬çš„ç»‘å®šå…³ç³»**ã€‚

### 6.2 syncWithGit â€” Git åŒæ­¥æ£€æŸ¥

`devplan_sync_git` å·¥å…·ï¼ˆæˆ– `syncWithGit()` æ–¹æ³•ï¼‰æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

```
å¯¹æ¯ä¸ª status=completed ä¸”æœ‰ completedAtCommit çš„å­ä»»åŠ¡ï¼š
  1. è°ƒç”¨ git merge-base --is-ancestor {completedAtCommit} HEAD
  2. å¦‚æœè¯¥ commit ä¸æ˜¯å½“å‰ HEAD çš„ç¥–å…ˆ â†’ è¯´æ˜ä»£ç å·²å›æ»š
  3. è‡ªåŠ¨å›é€€ä»»åŠ¡çŠ¶æ€ä¸º pending
  4. è®°å½• revertReason: "Commit xxx not found in current branch"
```

### 6.3 dryRun æ¨¡å¼

| `dryRun` å€¼ | è¡Œä¸º |
|-------------|------|
| `true` | åªè¿”å›"å“ªäº›ä»»åŠ¡ä¼šè¢«å›é€€"çš„åˆ—è¡¨ï¼Œ**ä¸å®é™…ä¿®æ”¹æ•°æ®** |
| `false`ï¼ˆé»˜è®¤ï¼‰ | å®é™…æ‰§è¡Œå›é€€æ“ä½œ |

å»ºè®®ï¼šé¦–æ¬¡ä½¿ç”¨æ—¶å…ˆç”¨ `dryRun: true` æ£€æŸ¥å½±å“èŒƒå›´ã€‚

### 6.4 Git å‘½ä»¤ä¾èµ–

| å‘½ä»¤ | ç”¨é€” | å¤±è´¥å¤„ç† |
|------|------|---------|
| `git rev-parse --short HEAD` | è·å–å½“å‰ commit çŸ­ hash | è¿”å› undefinedï¼Œä»»åŠ¡æ­£å¸¸å®Œæˆä½†ä¸é”šå®š |
| `git merge-base --is-ancestor A B` | æ£€æŸ¥ A æ˜¯å¦æ˜¯ B çš„ç¥–å…ˆ | è¿”å› falseï¼ˆè§†ä¸ºéœ€è¦å›é€€ï¼‰ |

### 6.5 å‘åå…¼å®¹

- å·²æœ‰çš„å­ä»»åŠ¡æ•°æ®æ²¡æœ‰ `completedAtCommit` å­—æ®µ â†’ `syncWithGit()` è·³è¿‡è¿™äº›ä»»åŠ¡
- é Git ä»“åº“ä¸­ `getCurrentGitCommit()` è¿”å› undefined â†’ ä»»åŠ¡ç…§å¸¸å®Œæˆï¼Œåªæ˜¯ä¸é”šå®š

---

## 7. å¯è§†åŒ–æœåŠ¡

### 7.1 æ¶æ„æ¦‚è¿°

å¯è§†åŒ–æœåŠ¡æ˜¯ä¸€ä¸ªè½»é‡çº§ HTTP æœåŠ¡å™¨ï¼Œä½¿ç”¨ Node.js å†…ç½® `http` æ¨¡å—ï¼Œ**æ— éœ€ Express/React ç­‰æ¡†æ¶**ï¼Œä¿æŒé¡¹ç›®é›¶é¢å¤–ä¾èµ–ã€‚

```
CLI: aifastdb-devplan-visual --project <name> [--port <port>] [--base-path <path>]
MCP: devplan_start_visual (projectName, port?)
  â†“
HTTP Server (Node.js http æ¨¡å—)
  â”œâ”€â”€ GET  /                       â†’ è‡ªåŒ…å« HTML é¡µé¢ï¼ˆvis-network CDN + å†…è” JS/CSSï¼‰
  â”œâ”€â”€ GET  /api/graph              â†’ DevPlanGraphStore.exportGraph() â†’ JSON
  â”œâ”€â”€ GET  /api/progress           â†’ getProgress() â†’ JSON
  â”œâ”€â”€ GET  /api/stats              â†’ è¯¦ç»†ç»Ÿè®¡æ•°æ® â†’ JSON
  â”œâ”€â”€ GET  /api/doc                â†’ æ–‡æ¡£å†…å®¹æŸ¥è¯¢ â†’ JSON
  â”œâ”€â”€ GET  /api/docs               â†’ æ–‡æ¡£åˆ—è¡¨ï¼ˆå«å±‚çº§ä¿¡æ¯ï¼‰ â†’ JSON
  â”œâ”€â”€ GET  /api/auto/next-action   â†’ Autopilot ä¸‹ä¸€æ­¥åŠ¨ä½œå»ºè®® â†’ JSON (è§„åˆ’ä¸­)
  â”œâ”€â”€ GET  /api/auto/current-phase â†’ å½“å‰é˜¶æ®µè¯¦æƒ… â†’ JSON (è§„åˆ’ä¸­)
  â”œâ”€â”€ POST /api/auto/complete-task â†’ æ ‡è®°å­ä»»åŠ¡å®Œæˆ â†’ JSON (è§„åˆ’ä¸­)
  â”œâ”€â”€ POST /api/auto/start-phase   â†’ å¯åŠ¨æ–°é˜¶æ®µ â†’ JSON (è§„åˆ’ä¸­)
  â”œâ”€â”€ POST /api/auto/heartbeat     â†’ executor å¿ƒè·³ä¸ŠæŠ¥ â†’ JSON (è§„åˆ’ä¸­)
  â””â”€â”€ GET  /favicon.ico            â†’ 204 No Content
```

**æ ¸å¿ƒè®¾è®¡å†³ç­–**ï¼šæ¯æ¬¡ API è¯·æ±‚éƒ½åˆ›å»ºæ–°çš„ store å®ä¾‹ï¼ˆ`createFreshStore`ï¼‰ï¼Œç¡®ä¿è¯»å–ç£ç›˜ä¸Šæœ€æ–°çš„ WAL æ•°æ®ã€‚å› ä¸º MCP å·¥å…·åœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼Œå¤ç”¨å¯åŠ¨æ—¶çš„ store å®ä¾‹ä¼šå¯¼è‡´æ•°æ®è¿‡æ—¶ã€‚

### 7.2 API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | å“åº”ç±»å‹ | è¯´æ˜ |
|------|------|---------|------|
| `/` | GET | text/html | è‡ªåŒ…å«å¯è§†åŒ– HTML é¡µé¢ |
| `/api/graph` | GET | application/json | å›¾è°±æ•°æ® `{ nodes, edges }`ï¼Œæ”¯æŒ `?includeDocuments=false` å’Œ `?includeModules=false` è¿‡æ»¤ |
| `/api/progress` | GET | application/json | é¡¹ç›®è¿›åº¦ç»Ÿè®¡ï¼ˆ`ProjectProgress` ç»“æ„ï¼‰ |
| `/api/stats` | GET | application/json | è¯¦ç»†ç»Ÿè®¡æ•°æ®ï¼ˆå«æŒ‰ä¼˜å…ˆçº§ç»Ÿè®¡ã€æŒ‰çŠ¶æ€åˆ†ç»„çš„é˜¶æ®µåˆ—è¡¨ã€å„é˜¶æ®µå­ä»»åŠ¡è¯¦æƒ…ã€æ¨¡å—ç»Ÿè®¡ã€æ–‡æ¡£åˆ†å¸ƒï¼‰ |
| `/api/doc` | GET | application/json | æ–‡æ¡£å†…å®¹æŸ¥è¯¢ï¼Œå‚æ•° `?section=xxx&subSection=yyy` |
| `/api/docs` | GET | application/json | æ–‡æ¡£åˆ—è¡¨ï¼ˆä¸å«å†…å®¹ï¼‰ï¼Œè¿”å› `{ docs: [...] }`ï¼Œå« `parentDoc`/`childDocs` å±‚çº§ä¿¡æ¯ |
| `/favicon.ico` | GET | 204 | é¿å…æµè§ˆå™¨ 404 |
| `/api/auto/next-action` | GET | application/json | **(è§„åˆ’ä¸­)** Autopilot ä¸‹ä¸€æ­¥åŠ¨ä½œå»ºè®®ï¼Œè¯¦è§ [ç¬¬ 13.4.2 èŠ‚](#1342-å¯è§†åŒ–æœåŠ¡å™¨æ–°å¢-api-ç«¯ç‚¹5-ä¸ª) |
| `/api/auto/current-phase` | GET | application/json | **(è§„åˆ’ä¸­)** å½“å‰è¿›è¡Œä¸­é˜¶æ®µåŠå­ä»»åŠ¡çŠ¶æ€ |
| `/api/auto/complete-task` | POST | application/json | **(è§„åˆ’ä¸­)** executor å›æŠ¥å­ä»»åŠ¡å®Œæˆ |
| `/api/auto/start-phase` | POST | application/json | **(è§„åˆ’ä¸­)** executor è¯·æ±‚å¯åŠ¨æ–°é˜¶æ®µ |
| `/api/auto/heartbeat` | POST | application/json | **(è§„åˆ’ä¸­)** executor å¿ƒè·³ä¸ŠæŠ¥ |

**`/api/stats` è¿”å›ç»“æ„**ï¼ˆåœ¨ `/api/progress` åŸºç¡€ä¸Šæ‰©å±•ï¼‰ï¼š

```typescript
{
  // --- ç»§æ‰¿è‡ª ProjectProgress ---
  projectName, sectionCount, mainTaskCount, completedMainTasks,
  subTaskCount, completedSubTasks, overallPercent, tasks,
  // --- æ‰©å±•å­—æ®µ ---
  docCount: number,               // æ–‡æ¡£æ€»æ•°
  moduleCount: number,            // æ¨¡å—æ€»æ•°
  byPriority: {                   // æŒ‰ä¼˜å…ˆçº§ç»Ÿè®¡
    P0: { total, completed },
    P1: { total, completed },
    P2: { total, completed },
  },
  mainTaskByStatus: {             // ä¸»ä»»åŠ¡æŒ‰çŠ¶æ€ç»Ÿè®¡
    completed: number,
    in_progress: number,
    pending: number,
  },
  completedPhases: [{             // å·²å®Œæˆçš„é˜¶æ®µï¼ˆå«å­ä»»åŠ¡è¯¦æƒ…ï¼‰
    taskId, title, total, completed, percent, completedAt,
    subTasks: [{ taskId, title, status, completedAt }]
  }],
  inProgressPhases: [...],        // è¿›è¡Œä¸­çš„é˜¶æ®µï¼ˆç»“æ„åŒä¸Šï¼‰
  pendingPhases: [...],           // å¾…å¼€å§‹çš„é˜¶æ®µï¼ˆç»“æ„åŒä¸Šï¼‰
  moduleStats: [{                 // æ¨¡å—ç»Ÿè®¡
    moduleId, name, status, mainTaskCount, subTaskCount, completedSubTaskCount
  }],
  docBySection: {                 // æ–‡æ¡£æŒ‰ç±»å‹åˆ†å¸ƒ
    overview: 1, api_design: 2, ...
  },
}
```

### 7.3 é¡¹ç›®å›¾è°±é¡µé¢

åŸºäº **vis-network** åº“çš„äº¤äº’å¼å›¾è°±ï¼Œé€šè¿‡ CDN åŠ è½½ï¼ˆä¾æ¬¡å°è¯• unpkg â†’ jsdelivr â†’ cdnjs ä¸‰ä¸ªæºå®¹é”™ï¼‰ã€‚

#### 7.3.1 èŠ‚ç‚¹ç±»å‹ï¼ˆ5 ç§ï¼‰

| ç±»å‹ | å½¢çŠ¶ | é¢œè‰² | å¤§å°èŒƒå›´ | è¯´æ˜ |
|------|------|------|----------|------|
| `project` | æ˜Ÿå½¢ (star) | é‡‘è‰² `#f59e0b` | 35 ~ 65 | é¡¹ç›®æ ¹èŠ‚ç‚¹ï¼Œå±…ä¸­ |
| `module` | è±å½¢ (diamond) | ç»¿è‰² `#059669` | 20 ~ 45 | åŠŸèƒ½æ¨¡å— |
| `main-task` | åœ†å½¢ (dot) | æŒ‰çŠ¶æ€ç€è‰² | 14 ~ 38 | ä¸»ä»»åŠ¡/å¼€å‘é˜¶æ®µ |
| `sub-task` | å°åœ†ç‚¹ (dot) | æŒ‰çŠ¶æ€ç€è‰² | 7 ~ 18 | å­ä»»åŠ¡/å…·ä½“å·¥ä½œé¡¹ |
| `document` | æ–¹å½¢ (box) | ç´«è‰² `#7c3aed` | 12 ~ 30 | æ–‡æ¡£ç‰‡æ®µ |

**èŠ‚ç‚¹åŠ¨æ€å¤§å°è§„åˆ™ï¼š**

èŠ‚ç‚¹å¤§å°æ ¹æ®è¿æ¥æ•°ï¼ˆåº¦æ•°ï¼‰åŠ¨æ€è°ƒæ•´ï¼Œè¿æ¥è¶Šå¤šçš„èŠ‚ç‚¹è¶Šå¤§ï¼Œå¸®åŠ©ç”¨æˆ·ç›´è§‚è¯†åˆ«æ ¸å¿ƒèŠ‚ç‚¹ï¼š

- **åº¦æ•°** = è¯¥èŠ‚ç‚¹çš„å…¥è¾¹ + å‡ºè¾¹æ€»æ•°
- **ç¼©æ”¾å…¬å¼**ï¼š`size = min + scale Ã— âˆšdegree`ï¼Œä½¿ç”¨å¹³æ–¹æ ¹æ›²çº¿ï¼Œä½åº¦æ•°æ—¶å¢é•¿å¿«ã€é«˜åº¦æ•°æ—¶å¢é•¿è¶‹ç¼“
- **å­—å·è”åŠ¨**ï¼šèŠ‚ç‚¹æ ‡ç­¾å­—å·éšå°ºå¯¸ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼ˆ`baseFont` ~ `maxFont`ï¼‰
- æ¯ç§èŠ‚ç‚¹ç±»å‹æœ‰ç‹¬ç«‹çš„ `min/max/scale` å‚æ•°ï¼Œä¿æŒç±»å‹é—´çš„è§†è§‰å±‚çº§
- é¼ æ ‡æ‚¬åœæ—¶ tooltip ä¼šæ˜¾ç¤ºèŠ‚ç‚¹åç§°å’Œè¿æ¥æ•°

**ä»»åŠ¡çŠ¶æ€é¢œè‰²æ˜ å°„ï¼š**

| çŠ¶æ€ | é¢œè‰² | å«ä¹‰ |
|------|------|------|
| `completed` | ç»¿è‰² `#059669` | å·²å®Œæˆ |
| `in_progress` | è“è‰² `#2563eb` | è¿›è¡Œä¸­ï¼ˆä¸»ä»»åŠ¡å¸¦å‘¼å¸ç¯è„‰å†²åŠ¨ç”»ï¼‰ |
| `pending` | ç°è‰² `#4b5563` | å¾…å¼€å§‹ |
| `cancelled` | æ£•è‰² `#92400e` | å·²å–æ¶ˆ |

#### 7.3.2 è¾¹ç±»å‹ï¼ˆ5 ç§ï¼‰

| ç±»å‹ | æ ·å¼ | é¢œè‰² | è¯´æ˜ |
|------|------|------|------|
| `has_main_task` | å®çº¿ + ç®­å¤´ | ç°è‰² | é¡¹ç›® â†’ ä¸»ä»»åŠ¡ |
| `has_sub_task` | ç»†å®çº¿ + ç®­å¤´ | æ·±ç° | ä¸»ä»»åŠ¡ â†’ å­ä»»åŠ¡ |
| `has_document` | è™šçº¿ + ç®­å¤´ | æ·±ç° | é¡¹ç›® â†’ æ–‡æ¡£ |
| `module_has_task` | ç‚¹çº¿ + ç®­å¤´ | ç»¿è‰² | æ¨¡å— â†’ ä¸»ä»»åŠ¡ |
| `task_has_doc` | è™šçº¿ + ç®­å¤´ | ç¥ç€è‰² `#b45309` | ä¸»ä»»åŠ¡ â†’ æ–‡æ¡£ï¼ˆåŒå‘å…³è”ï¼‰ |

#### 7.3.3 äº¤äº’åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **èŠ‚ç‚¹è¯¦æƒ…é¢æ¿** | ç‚¹å‡»èŠ‚ç‚¹å¼¹å‡ºå³ä¾§è¯¦æƒ…é¢æ¿ï¼Œæ˜¾ç¤ºçŠ¶æ€ã€ä¼˜å…ˆçº§ã€å­ä»»åŠ¡å®Œæˆç‡ã€å®Œæˆæ—¶é—´ã€å…³è”æ–‡æ¡£/å…³è”ä»»åŠ¡ç­‰ |
| **é¢æ¿å¯¼èˆªè·¯ç”±** | é¢æ¿å†…ç‚¹å‡»ã€Œå…³è”æ–‡æ¡£ã€æˆ–ã€Œå…³è”ä»»åŠ¡ã€å¯è·³è½¬åˆ°å¯¹åº”èŠ‚ç‚¹è¯¦æƒ…ï¼Œæ ‡é¢˜æ å·¦ä¾§æ˜¾ç¤ºè¿”å›ç®­å¤´æŒ‰é’®ï¼Œæ”¯æŒå¤šçº§æ·±åº¦å¯¼èˆªé€çº§å›é€€ï¼›ç›´æ¥ç‚¹å‡»å›¾è°±èŠ‚ç‚¹æˆ–å…³é—­é¢æ¿æ—¶æ¸…ç©ºå†å²æ ˆ |
| **é¢æ¿å¯è°ƒèŠ‚** | æ‹–æ‹½è¯¦æƒ…é¢æ¿å·¦è¾¹ç¼˜å¯è°ƒèŠ‚å®½åº¦ï¼ŒåŒå‡»é¢æ¿æ ‡é¢˜æ å¯å±•å¼€/æŠ˜å è‡³åŒå€å®½åº¦ |
| **èŠ‚ç‚¹ç±»å‹ç­›é€‰** | é¡µé¢åº•éƒ¨å¤é€‰æ¡†ç­›é€‰ï¼ŒæŒ‰ç±»å‹ï¼ˆæ¨¡å—/ä¸»ä»»åŠ¡/å­ä»»åŠ¡/æ–‡æ¡£ï¼‰æ˜¾ç¤º/éšè— |
| **Ctrl+æ‹–æ‹½** | æŒ‰ä½ Ctrl æ‹–æ‹½èŠ‚ç‚¹å¯åŒæ—¶ç§»åŠ¨å…¶è¿æ¥çš„èŠ‚ç‚¹ |
| **æ–‡æ¡£å†…å®¹æŸ¥çœ‹** | ç‚¹å‡»æ–‡æ¡£èŠ‚ç‚¹å¯æŸ¥çœ‹å®Œæ•´çš„ Markdown å†…å®¹ï¼ˆå¸¦åŸºç¡€æ¸²æŸ“ï¼‰ |
| **å‘¼å¸ç¯åŠ¨ç”»** | `in_progress` çŠ¶æ€çš„ä¸»ä»»åŠ¡èŠ‚ç‚¹å¸¦æœ‰ Canvas è„‰å†²å…‰ç¯æ•ˆæœï¼šå¤–åœˆè“è‰²æè¾¹ç¯å‘¨æœŸæ€§æ‰©å¼ /æ”¶ç¼©å¹¶æ¸éšï¼Œå†…åœˆå¾„å‘æ¸å˜æŸ”å…‰éšèŠ‚å¥æ˜ç­ï¼›é€šè¿‡ `requestAnimationFrame` + `afterDrawing` äº‹ä»¶é©±åŠ¨ï¼Œæ—  in_progress èŠ‚ç‚¹æ—¶è‡ªåŠ¨åœæ­¢ä»¥èŠ‚çœæ€§èƒ½ |
| **ç‰©ç†å¼•æ“** | forceAtlas2Based åŠ›å¯¼å‘å¸ƒå±€ï¼Œç¨³å®šåŒ–åè‡ªåŠ¨å…³é—­ |
| **å‘¼å¸ç¯åŠ¨ç”»** | çŠ¶æ€ä¸º `in_progress` çš„ä¸»ä»»åŠ¡èŠ‚ç‚¹å¸¦æœ‰è„‰å†²å‘¼å¸å…‰ç¯æ•ˆæœï¼ˆå¤–åœˆè“è‰²è„‰å†²ç¯ + å†…åœˆå¾„å‘è¾‰å…‰ï¼‰ï¼Œé€šè¿‡ Canvas `afterDrawing` äº‹ä»¶ + `requestAnimationFrame` å®ç°å¹³æ»‘åŠ¨ç”»ï¼Œæ— è¿›è¡Œä¸­ä»»åŠ¡æ—¶è‡ªåŠ¨åœæ­¢ä»¥èŠ‚çœæ€§èƒ½ |
| **çŠ¶æ€æ ** | é¡¶éƒ¨é€æ˜çŠ¶æ€æ æ˜¾ç¤ºæ¨¡å—æ•°ã€ä¸»ä»»åŠ¡æ•°ã€å­ä»»åŠ¡æ•°ã€**æ–‡æ¡£æ•°**ã€å®Œæˆç‡è¿›åº¦æ¡ï¼›æ‰€æœ‰ç»Ÿè®¡é¡¹å‡å¯ç‚¹å‡»æ‰“å¼€å¯¹åº”çš„åˆ—è¡¨å¼¹å±‚ |
| **æ–‡æ¡£åˆ—è¡¨å¼¹å±‚** | ç‚¹å‡»é¡¶éƒ¨çŠ¶æ€æ ã€Œæ–‡æ¡£ã€æ•°å­—ï¼Œåœ¨å·¦ä¾§å¼¹å‡ºæ–‡æ¡£åˆ—è¡¨é¢æ¿ï¼ˆä¸æ¨¡å—/ä»»åŠ¡å¼¹å±‚å¤ç”¨åŒä¸€ UI æ¡†æ¶ï¼‰ï¼›æ–‡æ¡£æŒ‰å±‚çº§ç»“æ„å±•ç¤ºï¼ˆæ”¯æŒ `parentDoc` çˆ¶å­å…³ç³»ï¼‰ï¼Œä¸»æ–‡æ¡£å·¦ä¾§æ˜¾ç¤ºå±•å¼€/æŠ˜å æŒ‰é’®ï¼ˆ`+`/`âˆ’`ï¼‰ï¼Œç‚¹å‡»å¯å±•å¼€æ˜¾ç¤ºå­æ–‡æ¡£ï¼›ç‚¹å‡»æ–‡æ¡£æ ‡é¢˜ç›´æ¥èšç„¦åˆ°å›¾è°±ä¸­å¯¹åº”çš„æ–‡æ¡£èŠ‚ç‚¹å¹¶æ‰“å¼€å³ä¾§è¯¦æƒ…é¢æ¿ï¼ˆå¤ç”¨å·²æœ‰çš„èŠ‚ç‚¹è¯¦æƒ…é¢æ¿ï¼Œé¿å…é‡å¤å¼¹å±‚ï¼‰ |
| **å›¾ä¾‹** | é¡µé¢åº•éƒ¨æ˜¾ç¤ºèŠ‚ç‚¹ç±»å‹å’Œè¾¹ç±»å‹çš„å›¾ä¾‹ï¼Œä¸ç­›é€‰æ§ä»¶åˆå¹¶ |

#### 7.3.4 æ‰‹åŠ¨åˆ·æ–°

æä¾›ä¸¤ç§æ–¹å¼è·å–æœ€æ–°ä»»åŠ¡çŠ¶æ€æ•°æ®ï¼ˆå·²ç§»é™¤ 15 ç§’è‡ªåŠ¨è½®è¯¢ï¼Œæ”¹ä¸ºæŒ‰éœ€æ‰‹åŠ¨åˆ·æ–°ï¼‰ï¼š

| åˆ·æ–°æ–¹å¼ | æ“ä½œ | æ•ˆæœ |
|----------|------|------|
| **åˆ·æ–°æŒ‰é’®** | ç‚¹å‡»åº•éƒ¨ç­›é€‰æ å·¦ä¾§çš„åˆ·æ–°å›¾æ ‡ | å¢é‡åˆ·æ–°ï¼šä¿æŒå½“å‰å¸ƒå±€å’Œç¼©æ”¾ï¼Œä»…æ›´æ–°èŠ‚ç‚¹é¢œè‰²ã€å¤§å°ã€å‘¼å¸ç¯çŠ¶æ€ï¼›æŒ‰é’®æ˜¾ç¤ºæ—‹è½¬åŠ¨ç”»åé¦ˆ |
| **æµè§ˆå™¨ F5** | æŒ‰ F5 æˆ–æµè§ˆå™¨åˆ·æ–°æŒ‰é’® | å®Œæ•´é‡è½½ï¼šé‡æ–°è·å–æ‰€æœ‰æ•°æ®å¹¶é‡å»ºå›¾è°±ï¼ˆæœåŠ¡ç«¯å“åº”å¤´å·²è®¾ç½® `Cache-Control: no-cache` ç¡®ä¿ä¸ä½¿ç”¨ç¼“å­˜ï¼‰ |

**å®ç°ç»†èŠ‚ï¼š**

- ç‚¹å‡»åˆ·æ–°æŒ‰é’®è°ƒç”¨ `manualRefresh()` â†’ `silentRefresh(onDone)`ï¼Œå¤ç”¨å¢é‡æ›´æ–°é€»è¾‘ï¼ˆ`updateNodeStyles()`ï¼‰ï¼Œä¸é‡å»ºå›¾è°±å¸ƒå±€
- åˆ·æ–°æœŸé—´æŒ‰é’®å›¾æ ‡å¸¦æ—‹è½¬åŠ¨ç”»ï¼ˆ`spin-refresh`ï¼‰ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
- `silentRefresh()` é€šè¿‡æ¯”è¾ƒèŠ‚ç‚¹çŠ¶æ€å¿«ç…§æ£€æµ‹å˜åŒ–ï¼Œä»…åœ¨æœ‰å˜åŒ–æ—¶æ›´æ–°ï¼Œæ— å˜åŒ–æ—¶ä»…è¾“å‡ºæ—¥å¿—

### 7.4 ç»Ÿè®¡ä»ªè¡¨ç›˜é¡µé¢

æä¾›é¡¹ç›®çš„å…¨æ–¹ä½ç»Ÿè®¡è§†å›¾ï¼Œæ•°æ®æ¥è‡ª `/api/stats` ç«¯ç‚¹ã€‚

| åŒºåŸŸ | å†…å®¹ |
|------|------|
| **æ€»è¿›åº¦ç¯** | å¤§å‹ SVG ç¯å½¢è¿›åº¦æ¡ï¼Œå±•ç¤ºæ€»ä½“å®Œæˆç™¾åˆ†æ¯” |
| **æ¦‚è§ˆå¡ç‰‡** | ä¸»ä»»åŠ¡æ•°ã€å·²å®Œæˆå­ä»»åŠ¡/æ€»å­ä»»åŠ¡ã€æ–‡æ¡£æ•°ã€æ¨¡å—æ•°ã€å‰©ä½™ä»»åŠ¡æ•° |
| **ä¼˜å…ˆçº§ç»Ÿè®¡** | P0/P1/P2 å„è‡ªçš„è¿›åº¦æ¡å’Œå®Œæˆæ•°/æ€»æ•° |
| **è¿›è¡Œä¸­é˜¶æ®µ** | å±•å¼€å¼åˆ—è¡¨ï¼Œæ¯ä¸ªä¸»ä»»åŠ¡å¯å±•å¼€æ˜¾ç¤ºå…¶å­ä»»åŠ¡ï¼ˆå«çŠ¶æ€å›¾æ ‡ï¼‰å’Œå…³è”æ–‡æ¡£ |
| **å·²å®Œæˆé‡Œç¨‹ç¢‘** | å±•å¼€å¼åˆ—è¡¨ï¼Œæ˜¾ç¤ºä¸»ä»»åŠ¡å’Œå­ä»»åŠ¡çš„å®Œæˆæ—¶é—´æˆ³åŠå…³è”æ–‡æ¡£ |
| **å¾…å¼€å§‹ä»»åŠ¡** | å±•å¼€å¼åˆ—è¡¨ï¼Œæ˜¾ç¤ºå¾…å¼€å‘çš„ä¸»ä»»åŠ¡åŠå…¶å­ä»»åŠ¡å’Œå…³è”æ–‡æ¡£ |
| **æ¨¡å—æ¦‚è§ˆ** | å¡ç‰‡ç½‘æ ¼ï¼Œæ¯ä¸ªæ¨¡å—æ˜¾ç¤ºåç§°ã€çŠ¶æ€å’Œå­ä»»åŠ¡è¿›åº¦æ¡ |
| **æ–‡æ¡£åˆ†å¸ƒ** | æŒ‰ section ç±»å‹åˆ†ç»„çš„æ–‡æ¡£æ•°é‡ç»Ÿè®¡ |

**å®Œæˆæ—¶é—´æ ¼å¼**ï¼šå½“å¹´å†…æ˜¾ç¤º `MM-DD HH:mm`ï¼Œè¶…è¿‡å½“å¹´æ˜¾ç¤º `YYYY-MM-DD HH:mm`ã€‚

### 7.5 ä¾§è¾¹æ å¯¼èˆª

å·¦ä¾§å¯æŠ˜å ä¾§è¾¹æ ï¼Œæ”¯æŒä¸¤ç§æ¨¡å¼ï¼š

| æ¨¡å¼ | å®½åº¦ | æ˜¾ç¤ºå†…å®¹ |
|------|------|---------|
| æŠ˜å  | 48px | ä»…å›¾æ ‡ + å“ç‰Œç¼©å†™ "Ai" |
| å±•å¼€ | 200px | å›¾æ ‡ + æ–‡å­— + å“ç‰Œå…¨ç§° "AiFastDb-DevPlan" |

**å¯¼èˆªèœå•é¡¹ï¼š**

| å›¾æ ‡ | åç§° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| ğŸ”— | é¡¹ç›®å›¾è°± | å¯ç”¨ | é¡¹ç›®å›¾è°±é¡µé¢ |
| ğŸ“‹ | ä»»åŠ¡çœ‹æ¿ | å³å°†æ¨å‡º | å ä½ |
| ğŸ“„ | æ–‡æ¡£æµè§ˆ | å³å°†æ¨å‡º | å ä½ |
| ğŸ“Š | ç»Ÿè®¡ä»ªè¡¨ç›˜ | å¯ç”¨ | ä»ªè¡¨ç›˜é¡µé¢ |
| âš™ï¸ | é¡¹ç›®è®¾ç½® | å³å°†æ¨å‡º | å ä½ |

ä¾§è¾¹æ çŠ¶æ€é€šè¿‡ `localStorage` æŒä¹…åŒ–ï¼Œåˆ·æ–°é¡µé¢åä¿æŒæŠ˜å /å±•å¼€çŠ¶æ€ã€‚

å“ç‰Œ Logo ä½¿ç”¨ CSS æ¸å˜æ–‡å­—æ•ˆæœï¼ˆ`background-clip: text`ï¼‰ï¼Œä»è“è‰²åˆ°ç´«è‰²çš„æ¸å˜ï¼Œä¸ `aidb-viewer` é¦–é¡µæ ‡é¢˜é£æ ¼ä¸€è‡´ã€‚

### 7.6 æš—è‰²ä¸»é¢˜

å…¨å±€ä½¿ç”¨æš—è‰²ä¸»é¢˜ï¼ŒèƒŒæ™¯è‰² `#111827`ï¼Œä¸ `aifastdb_admin` é£æ ¼ä¸€è‡´ã€‚æ‰€æœ‰é¡µé¢ï¼ˆå›¾è°±ã€ä»ªè¡¨ç›˜ã€ä¾§è¾¹æ ï¼‰å…±äº«ç»Ÿä¸€çš„æš—è‰²è°ƒè‰²æ¿ã€‚

---

## 8. ä½¿ç”¨æ–¹å¼

### 8.1 ä½œä¸º MCP Server ä½¿ç”¨ï¼ˆæ¨èï¼‰

åœ¨ Cursor IDE æˆ– Claude Desktop ä¸­é…ç½® MCP Serverï¼š

```json
// .cursor/mcp.json æˆ– claude_desktop_config.json
{
  "mcpServers": {
    "aifastdb-devplan": {
      "command": "npx",
      "args": ["aifastdb-devplan"]
    }
  }
}
```

é…ç½®åå³å¯åœ¨ AI å¯¹è¯ä¸­ä½¿ç”¨å…¨éƒ¨ 23 ä¸ª `devplan_*` å·¥å…·ã€‚

### 8.2 ä½œä¸º npm åŒ…ç¼–ç¨‹ä½¿ç”¨

```typescript
import { createDevPlan } from 'aifastdb-devplan';

const plan = createDevPlan('my-project');

// åˆ›å»ºä¸»ä»»åŠ¡
plan.createMainTask({
  projectName: 'my-project',
  taskId: 'phase-1',
  title: 'é˜¶æ®µä¸€ï¼šåŸºç¡€æ­å»º',
  priority: 'P0',
});

// æ·»åŠ å­ä»»åŠ¡
plan.addSubTask({
  projectName: 'my-project',
  taskId: 'T1.1',
  parentTaskId: 'phase-1',
  title: 'åˆå§‹åŒ–é¡¹ç›®ç»“æ„',
});

// å®Œæˆä»»åŠ¡ï¼ˆè‡ªåŠ¨é”šå®š Git commitã€åˆ·æ–°ä¸»ä»»åŠ¡è®¡æ•°ï¼‰
plan.completeSubTask('T1.1');

// æŸ¥çœ‹è¿›åº¦
const progress = plan.getProgress();
console.log(`å®Œæˆç‡: ${progress.overallPercent}%`);
```

### 8.3 CLI å‘½ä»¤

é¡¹ç›®æä¾›ä¸¤ä¸ª bin å…¥å£ï¼š

#### 8.3.1 MCP Server

```bash
aifastdb-devplan
# é€šè¿‡ stdio æä¾› MCP åè®®æœåŠ¡ï¼Œé€šå¸¸ç”± Cursor/Claude Desktop è‡ªåŠ¨å¯åŠ¨
```

#### 8.3.2 å¯è§†åŒ–æœåŠ¡å™¨

```bash
aifastdb-devplan-visual --project <é¡¹ç›®åç§°> [--port <ç«¯å£>] [--base-path <è·¯å¾„>]
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--project` | string | (å¿…éœ€) | é¡¹ç›®åç§° |
| `--port` | number | 3210 | HTTP ç›‘å¬ç«¯å£ |
| `--base-path` | string | è‡ªåŠ¨è§£æ | DevPlan æ•°æ®å­˜å‚¨è·¯å¾„ |

ç¤ºä¾‹ï¼š

```bash
# é€šè¿‡ npm script
npm run visualize -- --project ai_db --base-path D:/Project/git/ai_db/.devplan

# é€šè¿‡ bin å…¥å£
aifastdb-devplan-visual --project ai_db --port 3212
```

### 8.4 npm åŒ…å¯¼å‡º

`aifastdb-devplan` npm åŒ…å¯¼å‡ºä»¥ä¸‹å…¬å…± APIï¼š

```typescript
export {
  // å·¥å‚å‡½æ•°
  createDevPlan, listDevPlans, getProjectEngine,
  // æ¥å£
  IDevPlanStore,
  // å®ç°ç±»
  DevPlanDocumentStore, DevPlanGraphStore,
  // è¿ç§»
  migrateEngine,
  // ç±»å‹
  DevPlanEngine, DevPlanSection, TaskStatus, TaskPriority, ModuleStatus,
  DevPlanDocInput, DevPlanDoc, DevPlanDocTree,
  MainTaskInput, MainTask, SubTaskInput, SubTask,
  CompleteSubTaskResult, SyncGitResult, RevertedTask,
  ModuleInput, Module, ModuleDetail,
  MainTaskProgress, ProjectProgress,
  DevPlanStoreConfig, DevPlanGraphStoreConfig,
  DevPlanGraphNode, DevPlanGraphEdge, DevPlanExportedGraph,
  // æœç´¢ç›¸å…³ç±»å‹
  SearchMode, ScoredDevPlanDoc, RebuildIndexResult,
  // å¸¸é‡
  ALL_SECTIONS, SECTION_DESCRIPTIONS,
};
```

---

## 9. æ•°æ®å…¼å®¹æ€§ä¸å­˜å‚¨

### 9.1 å­˜å‚¨è·¯å¾„è§£æ

è·¯å¾„è§£æä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

| ä¼˜å…ˆçº§ | è·¯å¾„æ¥æº | è¯´æ˜ |
|--------|---------|------|
| 1 | `AIFASTDB_DEVPLAN_PATH` ç¯å¢ƒå˜é‡ | æ˜¾å¼æŒ‡å®š |
| 2 | é¡¹ç›®å†… `.devplan/` ç›®å½• | é€šè¿‡æŸ¥æ‰¾ `.git` / `package.json` å®šä½é¡¹ç›®æ ¹ç›®å½• |
| 3 | `~/.aifastdb/dev-plans/` | å…œåº•è·¯å¾„ |

### 9.2 æ•°æ®ç›®å½•ç»“æ„

```
.devplan/{projectName}/
â”œâ”€â”€ engine.json                 # å¼•æ“é…ç½®
â”œâ”€â”€ documents.jsonl             # æ–‡æ¡£ç‰‡æ®µï¼ˆdocument å¼•æ“ï¼‰
â”œâ”€â”€ tasks.jsonl                 # ä¸»ä»»åŠ¡ + å­ä»»åŠ¡ï¼ˆdocument å¼•æ“ï¼‰
â”œâ”€â”€ modules.jsonl               # åŠŸèƒ½æ¨¡å—ï¼ˆdocument å¼•æ“ï¼‰
â””â”€â”€ graph-data/                 # å›¾æ•°æ®ç›®å½•ï¼ˆgraph å¼•æ“ï¼‰
    â”œâ”€â”€ wal.jsonl               # Write-Ahead Log
    â””â”€â”€ shard_*.jsonl           # åˆ†ç‰‡æ•°æ®æ–‡ä»¶
```

ä¸¤ç§å¼•æ“çš„æ•°æ®æ–‡ä»¶äº’ä¸å¹²æ‰°ï¼Œè¿ç§»åæ—§æ•°æ®ä¿ç•™ï¼ˆå¯é€‰å¤‡ä»½ï¼‰ã€‚

### 9.3 Append-Only JSONL æ—¶é—´æˆ³ç­–ç•¥ï¼ˆDocument å¼•æ“ï¼‰

Document å¼•æ“åº•å±‚ä½¿ç”¨ `EnhancedDocumentStore`ï¼ˆJSONL æ ¼å¼ï¼‰ï¼Œå…¶å…³é”®ç‰¹æ€§æ˜¯ **append-only**ï¼š

- **å†™å…¥**ï¼š`put()` åœ¨ JSONL æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€æ¡æ–°è®°å½•
- **åˆ é™¤**ï¼š`delete()` åœ¨å†…å­˜ä¸­æ ‡è®°åˆ é™¤ï¼Œä½† JSONL æ–‡ä»¶ä¸­çš„æ—§è®°å½•**ä»ç„¶ä¿ç•™**
- **é‡æ–°åŠ è½½**ï¼šæ‰€æœ‰å†å²ç‰ˆæœ¬éƒ½ä¼šè¢«åŠ è½½åˆ°å†…å­˜

å› æ­¤ç³»ç»Ÿä½¿ç”¨ **ä¸‰ä¸ªç§æœ‰æ–¹æ³•** åä½œä¿éšœæ•°æ®ä¸€è‡´æ€§ï¼š

| æ–¹æ³• | ä½œç”¨ |
|------|------|
| `getDocUpdatedAt(doc)` | ç»Ÿä¸€è¯»å–æ–‡æ¡£æ—¶é—´æˆ³ï¼ˆä¼˜å…ˆå– `metadata.updatedAt`ï¼‰ |
| `ensureTimestampAfter(refTimestamp)` | è‡ªæ—‹ç­‰å¾…ç›´åˆ° `Date.now()` ä¸¥æ ¼å¤§äºå‚è€ƒæ—¶é—´æˆ³ |
| `deleteAndEnsureTimestampAdvance(store, id)` | åˆ é™¤æ—§ç‰ˆæœ¬ + ç­‰å¾…æ—¶é—´æˆ³é€’å¢ï¼ˆç»„åˆæ“ä½œï¼‰ |

**å†™å…¥æ—¶**ï¼ˆæ›´æ–°æ“ä½œï¼‰ï¼š

```
1. è·å–å½“å‰ç‰ˆæœ¬
2. deleteAndEnsureTimestampAdvance â†’ åˆ é™¤æ—§ç‰ˆæœ¬ + è‡ªæ—‹ç­‰å¾…
3. put(æ–°ç‰ˆæœ¬, updatedAt: Date.now()) â†’ æ–°ç‰ˆæœ¬çš„ updatedAt ä¸€å®šä¸¥æ ¼å¤§äºæ—§ç‰ˆæœ¬
```

**è¯»å–æ—¶**ï¼ˆå»é‡ç­–ç•¥ï¼‰ï¼š

```
å•ä¸ªå®ä½“: findByTag â†’ æŒ‰ updatedAt é™åºæ’åº â†’ å–ç¬¬ä¸€ä¸ªï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
åˆ—è¡¨è¯»å–: Map<entityId, doc> â†’ éå†æ—¶åªä¿ç•™ updatedAt æ›´å¤§çš„ç‰ˆæœ¬
```

### 9.4 å‘åå…¼å®¹æ€§

- JSONL æ–‡ä»¶æ ¼å¼ä¸å˜ï¼Œå·²æœ‰æ•°æ®å¯ç›´æ¥è¢«æ–°ç‰ˆæœ¬è¯»å–
- æ—§æ•°æ®æ—  `completedAtCommit` å­—æ®µ â†’ `syncWithGit()` è·³è¿‡
- æ—§æ•°æ®æ—  `moduleId` å­—æ®µ â†’ ä¸å½±å“ä»»ä½•ç°æœ‰æ“ä½œ
- MCP å·¥å…·åç§°å®Œå…¨ä¸å˜ â†’ ç”¨æˆ·æ— éœ€ä¿®æ”¹ä»»ä½•å·¥å…·è°ƒç”¨

---

## 10. æŠ€æœ¯ç»†èŠ‚

### 10.1 ä¾èµ–å…³ç³»å›¾

```
ai_db (aifastdb npm åŒ…)                          â† ä¸å— devplan å½±å“ï¼Œæ— éœ€ä¿®æ”¹
â”œâ”€â”€ packages/node/ts/document-store.ts           â† å¯¼å‡º EnhancedDocumentStore
â”œâ”€â”€ packages/node/ts/social-graph-v2.ts          â† å¯¼å‡º SocialGraphV2
â”œâ”€â”€ packages/node/ts/social-types.ts             â† å¯¼å‡º Entity, Relation ç±»å‹
â”œâ”€â”€ packages/node/ts/index.ts                    â† ç»Ÿä¸€å¯¼å‡ºå…¥å£
â””â”€â”€ packages/node/ts/mcp-server/index.ts         â† 8 ä¸ª Legacy å·¥å…·ï¼ˆç‹¬ç«‹è¿è¡Œï¼‰

aifastdb-devplan (ç‹¬ç«‹é¡¹ç›®ï¼Œä¾èµ– aifastdb npm åŒ…)
â”œâ”€â”€ [TypeScript] src/
â”‚   â”œâ”€â”€ src/dev-plan-document-store.ts           â† import { EnhancedDocumentStore } from 'aifastdb'
â”‚   â”œâ”€â”€ src/dev-plan-graph-store.ts              â† import { SocialGraphV2, VibeSynapse } from 'aifastdb'
â”‚   â”œâ”€â”€ src/dev-plan-factory.ts                  â† æ ¹æ® engine.json é€‰æ‹©ä¸Šè¿°ä¸¤ä¸ªå®ç°ä¹‹ä¸€
â”‚   â”œâ”€â”€ src/dev-plan-migrate.ts                  â† æ•°æ®è¿ç§»å·¥å…·ï¼ˆdocument â†” graphï¼‰
â”‚   â”œâ”€â”€ src/visualize/template.ts                â† é¡¹ç›®å›¾è°± HTML æ¨¡æ¿ï¼ˆvis-networkï¼‰
â”‚   â”œâ”€â”€ src/visualize/server.ts                  â† è½»é‡ HTTP å¯è§†åŒ–æœåŠ¡å™¨ + /api/auto/* ç«¯ç‚¹ (è§„åˆ’ä¸­)
â”‚   â””â”€â”€ src/mcp-server/index.ts                  â† 23 + 3 ä¸ª devplan_* å·¥å…· (3 ä¸ª autopilot è§„åˆ’ä¸­)
â”‚
â””â”€â”€ [Python] executor/ (è§„åˆ’ä¸­ï¼Œä» cursor_auto é‡æ„è¿å…¥)
    â”œâ”€â”€ executor/src/devplan_client.py            â† HTTP å®¢æˆ·ç«¯ï¼Œè°ƒç”¨ /api/auto/* ç«¯ç‚¹
    â”œâ”€â”€ executor/src/engine.py                    â† åŒé€šé“å†³ç­–å¼•æ“ï¼ˆDevPlan çŠ¶æ€ + UI æˆªå›¾ï¼‰
    â”œâ”€â”€ executor/src/cursor_controller.py         â† GUI è‡ªåŠ¨åŒ–ï¼ˆpyautoguiï¼‰
    â””â”€â”€ executor/src/vision_analyzer.py           â† è§†è§‰åˆ†æï¼ˆOllamaï¼Œç²¾ç®€åï¼‰
```

**é€šä¿¡å…³ç³»**ï¼š

```
Cursor IDE ä¸­çš„ AI
  â”œâ†’ [MCP stdio] aifastdb-devplan MCP Server (23+3 ä¸ªå·¥å…·)
  â”‚     â””â†’ devplan_complete_task() æ›´æ–°ä»»åŠ¡çŠ¶æ€
  â”‚
  â””â†’ [GUI æ“ä½œ] cursor_controller.py æ¨¡æ‹Ÿé”®é¼ æ“ä½œ

executor (Python è¿›ç¨‹)
  â”œâ†’ [HTTP] GET/POST /api/auto/*  â†’  aifastdb-devplan-visual (Node.js HTTP æœåŠ¡å™¨)
  â”œâ†’ [æˆªå›¾] pyautogui.screenshot()  â†’  vision_analyzer.py â†’ Ollama
  â””â†’ [GUI] cursor_controller.py â†’ pyautogui â†’ Cursor IDE çª—å£
```

`ai_db` ä¸­ä¿ç•™çš„ 8 ä¸ª Legacy å·¥å…·ï¼ˆ`save_document`, `get_document`, `list_documents`, `search_documents`, `list_tasks`, `generate_task_id`, `save_architecture`, `get_architecture`ï¼‰ä¸ DevPlan å®Œå…¨éš”ç¦»ï¼š
- ç‹¬ç«‹å­˜å‚¨å¼•æ“ï¼Œæ•°æ®è·¯å¾„ä¸º `~/.aifastdb/cursor-planning/`
- é›¶ import å¼•ç”¨ `aifastdb-devplan`
- å·¥å…·åæ— äº¤å‰ï¼ˆLegacy ä½¿ç”¨é€šç”¨åï¼ŒDevPlan ç»Ÿä¸€ä½¿ç”¨ `devplan_` å‰ç¼€ï¼‰

### 10.2 SocialGraphV2 API ä½¿ç”¨

`DevPlanGraphStore` è°ƒç”¨çš„ SocialGraphV2 API æ–¹æ³•ï¼ˆå…± 16 ä¸ªï¼‰ï¼š

| æ–¹æ³• | ç”¨é€” |
|------|------|
| `addEntity` | åˆ›å»ºå®ä½“ï¼ˆé¡¹ç›®/ä»»åŠ¡/æ–‡æ¡£/æ¨¡å—ï¼‰ |
| `getEntity` | è·å–å•ä¸ªå®ä½“ |
| `updateEntity` | æ›´æ–°å®ä½“å±æ€§ |
| `deleteEntity` | åˆ é™¤å®ä½“ |
| `putRelation` | åˆ›å»ºå…³ç³»ï¼ˆçˆ¶å­ã€æ¨¡å—å…³è”ç­‰ï¼‰ |
| `deleteRelation` | åˆ é™¤å…³ç³» |
| `listEntitiesByType` | æŒ‰ç±»å‹åˆ—å‡ºå®ä½“ |
| `listRelations` | åˆ—å‡ºæŸå®ä½“çš„å…³ç³» |
| `getRelationBetween` | è·å–ä¸¤å®ä½“é—´çš„å…³ç³» |
| `exportGraph` | å¯¼å‡ºå®Œæ•´å›¾ç»“æ„ |
| `indexEntity` | å°† Embedding å‘é‡ç´¢å¼•åˆ° HNSWï¼ˆè¯­ä¹‰æœç´¢ï¼‰ |
| `searchEntitiesByVector` | å‘é‡è¿‘é‚»æœç´¢ï¼ˆè¯­ä¹‰æœç´¢ï¼‰ |
| `removeEntityVector` | åˆ é™¤æ–‡æ¡£å¯¹åº”çš„å‘é‡ç´¢å¼•ï¼ˆæ–‡æ¡£åˆ é™¤æ—¶ï¼‰ |
| `flush` | åˆ·ç›˜ |
| `recover` | æ¢å¤ï¼ˆWAL é‡æ”¾ï¼Œå«å‘é‡ WALï¼‰ |
| æ„é€ å‡½æ•° | åˆå§‹åŒ–åˆ†ç‰‡å­˜å‚¨ï¼ˆå« HNSW å‘é‡ç´¢å¼•é…ç½®ï¼‰ |

### 10.3 ä¸‰å±‚ä¿¡æ¯æ¶æ„

DevPlan è®¾è®¡äº†ä¸‰å±‚äº’è¡¥çš„ä¿¡æ¯æ¶æ„ï¼Œè§£å†³å¤§å‹é¡¹ç›®æ–‡æ¡£çš„ AI å¯è¯»æ€§é—®é¢˜ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: overview æ¦‚è§ˆæ–‡æ¡£ (é¸Ÿç°)                                â”‚
â”‚ â€¢ < 500 è¡Œï¼ŒAI ä¸€æ¬¡è¯»å®Œ                                         â”‚
â”‚ â€¢ "çŸ¥é“é¡¹ç›®æœ‰ä»€ä¹ˆã€åœ¨å“ªé‡Œã€å¤§æ¦‚æ€æ ·"                              â”‚
â”‚ â€¢ é€šè¿‡ devplan_get_section(section: 'overview') è·å–             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ æ·±å…¥ â†’ æŒ‰ section è¯»å–
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: DevPlan æ–‡æ¡£ç‰‡æ®µ (è¯¦ç»†)                                 â”‚
â”‚ â€¢ æŒ‰ section ç±»å‹æ‹†åˆ†å­˜å‚¨ï¼ŒæŒ‰éœ€åŠ è½½                               â”‚
â”‚ â€¢ "çŸ¥é“å…·ä½“æ€ä¹ˆåšã€ä¸ºä»€ä¹ˆè¿™æ ·åš"                                  â”‚
â”‚ â€¢ é€šè¿‡ devplan_get_section / devplan_list_sections è·å–          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ å®æ—¶æŸ¥è¯¢ â†’ MCP å·¥å…·
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: ä»»åŠ¡ä¸è¿›åº¦ (å®æ—¶)                                       â”‚
â”‚ â€¢ ä»»åŠ¡çŠ¶æ€ã€è¿›åº¦ç™¾åˆ†æ¯”ã€å®Œæˆæ—¶é—´ã€Git commit é”šå®š                 â”‚
â”‚ â€¢ "çŸ¥é“ç°åœ¨åšåˆ°å“ªé‡Œäº†"                                           â”‚
â”‚ â€¢ é€šè¿‡ devplan_get_progress / devplan_list_tasks è·å–            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. ç‰ˆæœ¬å†å²

### v1.0.0 â€” ç‹¬ç«‹é¡¹ç›®æ‹†åˆ† (2026-02-08)

- ä» `ai_db` é¡¹ç›®ä¸­å°† DevPlan æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ `aifastdb-devplan` é¡¹ç›®
- æ ¸å¿ƒé€»è¾‘è¿ç§»ï¼ˆä»…æ”¹ 3 è¡Œ importï¼‰ï¼Œ2268 è¡Œä»£ç é›¶é€»è¾‘æ”¹åŠ¨
- 16 ä¸ª MCP å·¥å…·ï¼šæ–‡æ¡£ç®¡ç†(4) + ä»»åŠ¡ç®¡ç†(5) + è¿›åº¦å¯¼å‡º(2) + æ¨¡å—ç®¡ç†(4) + Git åŒæ­¥(1)
- `ai_db` ä¾§æ¸…ç†ï¼šåˆ é™¤ `dev-plan-store.ts`ï¼ŒMCP Server ä» 1607 è¡Œç²¾ç®€è‡³ 583 è¡Œ
- å‘å¸ƒ `aifastdb-devplan@1.0.0` npm åŒ…

**æ‹†åˆ†å‰çš„åŠŸèƒ½ç§¯ç´¯**ï¼ˆåœ¨ `ai_db` å†…å®Œæˆï¼‰ï¼š
- Git Commit é”šå®š + `devplan_sync_git` å·¥å…·
- è·¨ä¸»ä»»åŠ¡å­ä»»åŠ¡æŸ¥è¯¢ï¼ˆ`devplan_list_tasks` å¢å¼ºï¼‰
- åŠŸèƒ½æ¨¡å—æ³¨å†Œè¡¨ï¼ˆModule Registryï¼‰â€” 4 ä¸ªæ–° MCP å·¥å…·
- Append-Only JSONL æ—¶é—´æˆ³ç­–ç•¥

### v2.0.0 â€” åŒå¼•æ“æ¶æ„ (2026-02-09)

- æ–°å¢ `DevPlanGraphStore`ï¼ˆåŸºäº `SocialGraphV2`ï¼‰ä½œä¸ºç¬¬äºŒç§å­˜å‚¨å¼•æ“
- æŠ½å– `IDevPlanStore` æ¥å£ï¼ˆ30+ æ–¹æ³•ï¼‰ï¼Œä¸¤ä¸ªå®ç°å…±ç”¨
- æå– `types.ts` ç±»å‹å®šä¹‰æ–‡ä»¶ï¼ˆ463 è¡Œï¼‰
- æ–°å¢ `dev-plan-factory.ts` å·¥å‚å‡½æ•° + `engine.json` å¼•æ“é€‰æ‹©æœºåˆ¶
- æ–°å¢ `devplan_export_graph` MCP å·¥å…·
- MCP å·¥å…·ä» 16 ä¸ªå¢åŠ åˆ° 17 ä¸ª

### v2.1.0 â€” æ•°æ®è¿ç§»å·¥å…· (2026-02-09)

- æ–°å¢ `dev-plan-migrate.ts` è¿ç§»æ¨¡å—
- æ–°å¢ `devplan_migrate_engine` MCP å·¥å…·
- æ”¯æŒ `document` â†” `graph` åŒå‘è¿ç§»
- è¿ç§»å‰è‡ªåŠ¨å¤‡ä»½ + dryRun é¢„è§ˆæ¨¡å¼
- MCP å·¥å…·ä» 17 ä¸ªå¢åŠ åˆ° 18 ä¸ª

### v3.0.0 â€” é¡¹ç›®å›¾è°±æœåŠ¡ (2026-02-09)

- æ–°å¢ `src/visualize/` ç›®å½•ï¼ˆ`template.ts` + `server.ts`ï¼‰
- è½»é‡ HTTP æœåŠ¡å™¨ï¼ˆNode.js å†…ç½® `http` æ¨¡å—ï¼Œæ— é¢å¤–ä¾èµ–ï¼‰
- vis-network äº¤äº’å¼å›¾è°±ï¼ˆ5 ç§èŠ‚ç‚¹ + 4 ç§è¾¹ + åŠ›å¯¼å‘å¸ƒå±€ï¼‰
- èŠ‚ç‚¹è¯¦æƒ…é¢æ¿ + ç»Ÿè®¡æ  + ç±»å‹ç­›é€‰ + æš—è‰²ä¸»é¢˜
- æ–°å¢ `aifastdb-devplan-visual` CLI å‘½ä»¤
- æ–°å¢ `devplan_start_visual` MCP å·¥å…·
- MCP å·¥å…·ä» 18 ä¸ªå¢åŠ åˆ° 20 ä¸ªï¼ˆå« `devplan_sync_git` ä» ai_db è¿ç§»åé‡æ–°è®¡æ•°ï¼‰

### v3.x â€” å¯è§†åŒ–å¢å¼º (2026-02-09)

- **ç»Ÿè®¡ä»ªè¡¨ç›˜é¡µé¢**ï¼šæ€»è¿›åº¦ç¯ã€æ¦‚è§ˆå¡ç‰‡ã€ä¼˜å…ˆçº§ç»Ÿè®¡ã€å¯å±•å¼€é‡Œç¨‹ç¢‘ï¼ˆå«å­ä»»åŠ¡è¯¦æƒ…ï¼‰ã€æ¨¡å—ç»Ÿè®¡ã€æ–‡æ¡£åˆ†å¸ƒ
- **ä¾§è¾¹æ å¯¼èˆª**ï¼šå¯æŠ˜å ä¾§è¾¹æ ï¼ˆ48px/200pxï¼‰ã€5 ä¸ªèœå•é¡¹ã€localStorage æŒä¹…åŒ–ã€å“ç‰Œ Logo æ¸å˜æ–‡å­—
- **æ–°å¢ API ç«¯ç‚¹**ï¼š`/api/stats`ï¼ˆè¯¦ç»†ç»Ÿè®¡æ•°æ®ï¼‰ã€`/api/doc`ï¼ˆæ–‡æ¡£å†…å®¹æŸ¥è¯¢ï¼‰ã€`/api/docs`ï¼ˆæ–‡æ¡£åˆ—è¡¨ï¼Œå«å±‚çº§ä¿¡æ¯ï¼‰
- **æ¯æ¬¡ API è¯·æ±‚åˆ›å»ºæ–° store å®ä¾‹**ï¼šç¡®ä¿è·¨è¿›ç¨‹æ•°æ®å®æ—¶åŒæ­¥
- **å®Œæˆæ—¶é—´æˆ³æ˜¾ç¤º**ï¼šé‡Œç¨‹ç¢‘å’Œå›¾è°±è¯¦æƒ…é¢æ¿ä¸­æ˜¾ç¤ºä¸»ä»»åŠ¡/å­ä»»åŠ¡çš„å®Œæˆæ—¶é—´
- **æ™ºèƒ½æ—¥æœŸæ ¼å¼**ï¼šå½“å¹´å†…çœç•¥å¹´ä»½ï¼ˆ`MM-DD HH:mm`ï¼‰ï¼Œè·¨å¹´æ˜¾ç¤ºå®Œæ•´æ—¥æœŸ
- **UI æ”¹è¿›**ï¼š
  - è¯¦æƒ…é¢æ¿å¯æ‹–æ‹½è°ƒæ•´å®½åº¦ + åŒå‡»æ ‡é¢˜æ å±•å¼€/æŠ˜å 
  - ç­›é€‰æ§ä»¶ä»é¡¶éƒ¨ç§»è‡³åº•éƒ¨ï¼Œä¸å›¾ä¾‹åˆå¹¶
  - æŒ‰é’®ç­›é€‰æ”¹ä¸ºå¤é€‰æ¡†ç­›é€‰
  - é¡¶éƒ¨çŠ¶æ€æ æ”¹ä¸ºé€æ˜èƒŒæ™¯
  - 15 ç§’é™é»˜è‡ªåŠ¨åˆ·æ–°ï¼ˆä¸å½±å“å›¾è°±å¸ƒå±€ï¼‰
  - CDN ä¸‰æºå®¹é”™ï¼ˆunpkg â†’ jsdelivr â†’ cdnjsï¼‰

### v3.x â€” æ–‡æ¡£-ä»»åŠ¡åŒå‘å…³è” (2026-02-09)

- **æ–°å¢å…³ç³»ç±»å‹ `task_has_doc`**ï¼šä¸»ä»»åŠ¡ä¸æ–‡æ¡£ä¹‹é—´çš„åŒå‘å…³è”
- **æ•°æ®æ¨¡å‹æ‰©å±•**ï¼š
  - `DevPlanDoc` æ–°å¢ `relatedTaskIds` å­—æ®µï¼ˆå…³è”çš„ä¸»ä»»åŠ¡ ID åˆ—è¡¨ï¼‰
  - `MainTask` æ–°å¢ `relatedSections` å­—æ®µï¼ˆå…³è”çš„æ–‡æ¡£ç‰‡æ®µæ ‡è¯†åˆ—è¡¨ï¼‰
- **MCP å·¥å…·å‚æ•°æ‰©å±•**ï¼š
  - `devplan_save_section` æ–°å¢å¯é€‰å‚æ•° `relatedTaskIds`ï¼ˆå…³è”ä¸»ä»»åŠ¡ï¼‰
  - `devplan_create_main_task` æ–°å¢å¯é€‰å‚æ•° `relatedDocSections`ï¼ˆå…³è”æ–‡æ¡£ç‰‡æ®µï¼‰
  - `devplan_upsert_task` æ–°å¢å¯é€‰å‚æ•° `relatedDocSections`ï¼ˆå…³è”æ–‡æ¡£ç‰‡æ®µï¼‰
- **Graph å¼•æ“**ï¼šé€šè¿‡ `task_has_doc` å…³ç³»ç±»å‹ç‰©ç†å­˜å‚¨åŒå‘å…³è”ï¼Œæ”¯æŒ `getTaskRelatedDocs()` / `getDocRelatedTasks()` æŸ¥è¯¢
- **Document å¼•æ“**ï¼šé€šè¿‡ `metadata.relatedTaskIds` å’Œ `data.relatedSections` å­—æ®µç»´æŠ¤å…³è”
- **å¯è§†åŒ–å¢å¼º**ï¼š
  - å›¾è°±ä¸­æ–°å¢ç¥ç€è‰²è™šçº¿è¾¹è¡¨ç¤ºä»»åŠ¡-æ–‡æ¡£å…³è”
  - ä¸»ä»»åŠ¡è¯¦æƒ…é¢æ¿æ˜¾ç¤ºã€Œå…³è”æ–‡æ¡£ã€åˆ—è¡¨ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰
  - æ–‡æ¡£è¯¦æƒ…é¢æ¿æ˜¾ç¤ºã€Œå…³è”ä»»åŠ¡ã€åˆ—è¡¨ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰
  - ç»Ÿè®¡ä»ªè¡¨ç›˜ä¸­ä¸»ä»»åŠ¡å±•å¼€åŒºæ˜¾ç¤ºå…³è”æ–‡æ¡£
  - åº•éƒ¨å›¾ä¾‹æ–°å¢ã€Œä»»åŠ¡-æ–‡æ¡£ã€è¾¹ç±»å‹
  - **èŠ‚ç‚¹åŠ¨æ€å¤§å°**ï¼šæ ¹æ®è¿æ¥æ•°ï¼ˆåº¦æ•°ï¼‰åŠ¨æ€è°ƒæ•´èŠ‚ç‚¹å°ºå¯¸å’Œå­—å·ï¼Œè¿æ¥è¶Šå¤šèŠ‚ç‚¹è¶Šå¤§ï¼Œæ ¸å¿ƒæ¢çº½èŠ‚ç‚¹ä¸€ç›®äº†ç„¶ï¼›ä½¿ç”¨ `âˆšdegree` å¹³æ–¹æ ¹æ›²çº¿å¹³æ»‘ç¼©æ”¾ï¼Œæ¯ç§èŠ‚ç‚¹ç±»å‹æœ‰ç‹¬ç«‹çš„ min/max/scale å‚æ•°

### é˜¶æ®µäºŒåäºŒéªŒè¯è®°å½•ï¼ˆT22.7ï¼‰

- **éªŒè¯æ—¶é—´**ï¼š2026-02-10
- **Rust åŠŸèƒ½æµ‹è¯•**ï¼š
  - `cargo test -p aifastdb-core test_export_graph_node_degree_default_enabled -- --nocapture`
  - `cargo test -p aifastdb-core test_export_graph_node_degree_can_be_disabled -- --nocapture`
  - ç»“æœï¼š2 é¡¹æµ‹è¯•å‡é€šè¿‡ï¼ŒéªŒè¯é»˜è®¤ä¸‹å‘ `node.degree`ï¼Œå¹¶æ”¯æŒ `include_node_degree: false` å…³é—­é€ä¼ 
- **15s åˆ·æ–°è·¯å¾„æ€§èƒ½å›å½’ï¼ˆå¾®åŸºå‡†ï¼‰**ï¼š
  - 300 nodes / 900 edges / 1500 roundsï¼š53.16ms -> 2.32msï¼ˆ95.64% ä¸‹é™ï¼‰
  - 800 nodes / 2400 edges / 1000 roundsï¼š90.82ms -> 2.58msï¼ˆ97.16% ä¸‹é™ï¼‰
  - 2000 nodes / 7000 edges / 400 roundsï¼š115.14ms -> 1.26msï¼ˆ98.91% ä¸‹é™ï¼‰
- **ç»“è®º**ï¼šé˜¶æ®µäºŒåäºŒ `T22.7` å·²å®Œæˆï¼Œ15 ç§’é™é»˜åˆ·æ–°åœºæ™¯ä¸­å‰ç«¯é‡å¤éå†å¼€é”€æ˜¾è‘—ä¸‹é™

### v3.x â€” é¢æ¿å¯¼èˆªè·¯ç”± + å‘¼å¸ç¯åŠ¨ç”» (2026-02-10)

- **é¢æ¿å¯¼èˆªè·¯ç”±ï¼ˆè¿”å›æŒ‰é’®ï¼‰**ï¼š
  - æ–°å¢ `panelHistory` å¯¼èˆªå†å²æ ˆï¼Œè¿½è¸ªé¢æ¿æµè§ˆè½¨è¿¹
  - é¢æ¿å†…ç‚¹å‡»ã€Œå…³è”æ–‡æ¡£ã€æˆ–ã€Œå…³è”ä»»åŠ¡ã€é“¾æ¥æ—¶ï¼Œå½“å‰èŠ‚ç‚¹ ID å‹æ ˆï¼Œè·³è½¬åˆ°ç›®æ ‡èŠ‚ç‚¹è¯¦æƒ…
  - æ ‡é¢˜æ å·¦ä¾§æ–°å¢è¿”å›ç®­å¤´æŒ‰é’®ï¼ˆSVG å›¾æ ‡ï¼‰ï¼Œæœ‰å†å²æ—¶è‡ªåŠ¨æ˜¾ç¤ºï¼Œç‚¹å‡»å¯é€çº§å›é€€
  - æ”¯æŒå¤šçº§æ·±åº¦å¯¼èˆªï¼ˆå¦‚ï¼šä¸»ä»»åŠ¡ â†’ æ–‡æ¡£ â†’ å…³è”ä»»åŠ¡ â†’ è¿”å›æ–‡æ¡£ â†’ è¿”å›ä¸»ä»»åŠ¡ï¼‰
  - ç›´æ¥ç‚¹å‡»å›¾è°±èŠ‚ç‚¹æ—¶æ¸…ç©ºå†å²æ ˆï¼Œé‡æ–°å¼€å§‹å¯¼èˆªï¼›å…³é—­é¢æ¿æ—¶åŒæ­¥æ¸…ç©º
  - æ–°å¢å‡½æ•°ï¼š`navigateToPanel()`ã€`panelGoBack()`ã€`updateBackButton()`
  - æ–°å¢ CSSï¼š`.panel-back`ï¼ˆè¿”å›æŒ‰é’®æ ·å¼ï¼‰ã€`.panel-header-left`ï¼ˆæ ‡é¢˜æ å·¦ä¾§å¸ƒå±€ï¼‰

- **å‘¼å¸ç¯åŠ¨ç”»ï¼ˆin_progress ä¸»ä»»åŠ¡ï¼‰**ï¼š
  - `in_progress` çŠ¶æ€çš„ä¸»ä»»åŠ¡èŠ‚ç‚¹åœ¨å›¾è°± Canvas ä¸Šæ˜¾ç¤ºè„‰å†²å…‰ç¯åŠ¨ç”»
  - **å¤–åœˆè„‰å†²å…‰ç¯**ï¼šè“è‰²æè¾¹ç¯ä»èŠ‚ç‚¹å‘å¤–æ‰©å¼ å†æ”¶ç¼©ï¼Œé€æ˜åº¦éšæ‰©å¼ é€’å‡ï¼Œè¥é€ å‘¼å¸æ„Ÿ
  - **å†…åœˆæŸ”å…‰**ï¼šå¾„å‘æ¸å˜åœ¨èŠ‚ç‚¹å‘¨å›´å½¢æˆæŸ”å’Œè¾‰å…‰ï¼Œå¤§å°å’Œäº®åº¦éšå‘¼å¸å‘¨æœŸå˜åŒ–
  - åŠ¨ç”»å¼•æ“ï¼š`requestAnimationFrame` é©±åŠ¨ + vis-network `afterDrawing` äº‹ä»¶åœ¨ Canvas ä¸Šç»˜åˆ¶
  - åŠ¨ç”»ç›¸ä½é€šè¿‡ `Math.sin(breathPhase)` äº§ç”Ÿ 0â†’1â†’0 å¹³æ»‘å¾ªç¯ï¼Œæ­¥è¿› 0.03/å¸§
  - æ€§èƒ½ä¼˜åŒ–ï¼šæ—  `in_progress` ä¸»ä»»åŠ¡æ—¶è‡ªåŠ¨è°ƒç”¨ `stopBreathAnimation()` åœæ­¢åŠ¨ç”»å¾ªç¯
  - å¢é‡æ›´æ–°å…¼å®¹ï¼šé™é»˜åˆ·æ–°åè‡ªåŠ¨æ£€æµ‹ï¼Œä»»åŠ¡çŠ¶æ€å˜åŒ–æ—¶åŠ¨æ€å¯åœå‘¼å¸ç¯
  - æ–°å¢å‡½æ•°ï¼š`startBreathAnimation()`ã€`stopBreathAnimation()`ã€`getInProgressMainTaskIds()`

### v3.x â€” å¼€å‘é˜¶æ®µè‡ªåŠ¨æ‰§è¡Œ (2026-02-12)

- **æ–°å¢ `devplan_start_phase` MCP å·¥å…·**ï¼šå¯åŠ¨/æ¢å¤å¼€å‘é˜¶æ®µçš„ä¸€ç«™å¼å…¥å£
  - è‡ªåŠ¨å°†ä¸»ä»»åŠ¡æ ‡è®°ä¸º `in_progress`ï¼ˆå¹‚ç­‰æ“ä½œï¼šå·²æ˜¯ in_progress/completed åˆ™è·³è¿‡ï¼‰
  - è¿”å›ä¸»ä»»åŠ¡ä¿¡æ¯ + å…¨éƒ¨å­ä»»åŠ¡åˆ—è¡¨ï¼ˆä¿ç•™å®é™…çŠ¶æ€ï¼‰ï¼Œè¾“å‡ºæ ¼å¼é€‚åˆç›´æ¥åˆ›å»º Cursor TodoList
  - è¿”å›å…³è”çš„æ–‡æ¡£ç‰‡æ®µæ ‡è¯†åˆ—è¡¨ï¼Œæ–¹ä¾¿ AI æŒ‰éœ€è¯»å–ç›¸å…³æ–‡æ¡£
- **AI ç«¯è‡ªåŠ¨æ‰§è¡Œå¼€å‘ä»»åŠ¡å·¥ä½œæµ**ï¼š
  - ç”¨æˆ·è¯´å‡º"å¼€å§‹/ç»§ç»­/æ¢å¤ phase-X å¼€å‘"æ—¶ï¼ŒAI è‡ªåŠ¨è°ƒç”¨ `devplan_start_phase`
  - AI å°†è¿”å›çš„å­ä»»åŠ¡åˆ—è¡¨è‡ªåŠ¨è½¬ä¸º Cursor TodoListï¼ˆTodoWriteï¼‰ï¼Œä¿ç•™å·²å®ŒæˆçŠ¶æ€
  - AI è¾“å‡ºé˜¶æ®µè¿›åº¦æ‘˜è¦åï¼Œè‡ªåŠ¨å®šä½å¹¶å¼€å§‹æ‰§è¡Œç¬¬ä¸€ä¸ª pending å­ä»»åŠ¡
  - æ¯å®Œæˆä¸€ä¸ªå­ä»»åŠ¡ï¼Œè‡ªåŠ¨è°ƒç”¨ `devplan_complete_task` å›å†™çŠ¶æ€ï¼Œç„¶åç»§ç»­ä¸‹ä¸€ä¸ª
  - æ‰€æœ‰å­ä»»åŠ¡å®Œæˆåï¼Œç³»ç»Ÿè‡ªåŠ¨æ ‡è®°ä¸»ä»»åŠ¡ä¸º completed
- **Cursor Rules é…ç½®æ›´æ–°**ï¼šåœ¨ `dev-plan-management.mdc` ä¸­æ–°å¢"å¯åŠ¨/æ¢å¤å¼€å‘é˜¶æ®µ"ç« èŠ‚ï¼Œå®šä¹‰è§¦å‘è¯å’Œå·¥ä½œæµ
- MCP å·¥å…·ä» 20 ä¸ªå¢åŠ åˆ° 21 ä¸ª

### v4.0.0 â€” ä»»åŠ¡æ’åº + è¯­ä¹‰æœç´¢ (2026-02-13)

- **ä»»åŠ¡æ’åºï¼ˆ`order` å­—æ®µï¼‰**ï¼š
  - `MainTaskInput`ã€`MainTask`ã€`SubTaskInput`ã€`SubTask` ç±»å‹å‡æ–°å¢ `order?: number` å­—æ®µ
  - MCP å·¥å…· `devplan_create_main_task`ã€`devplan_add_sub_task`ã€`devplan_upsert_task` æ–°å¢ `order` å¯é€‰å‚æ•°
  - ä¸æŒ‡å®š `order` æ—¶è‡ªåŠ¨åˆ†é…ï¼ˆå½“å‰æœ€å¤§ order + 1ï¼‰ï¼Œè¿½åŠ åˆ°åˆ—è¡¨æœ«å°¾
  - `listMainTasks()` å’Œ `listSubTasks()` è¿”å›ç»“æœæŒ‰ `order` å‡åºæ’åˆ—ï¼ˆorder ä¸ºç©ºæ’æœ€åï¼Œç›¸åŒ order æŒ‰ `createdAt` æ’åºï¼‰
  - æ’åºé€»è¾‘åœ¨ Graph å¼•æ“å’Œ Document å¼•æ“ä¸­å‡å·²å®ç°ï¼ˆ`sortByOrder()` + `getNextMainTaskOrder()` / `getNextSubTaskOrder()`ï¼‰

- **æ–‡æ¡£è¯­ä¹‰æœç´¢ï¼ˆVibeSynapse é›†æˆï¼‰**ï¼š
  - æ–°å¢ MCP å·¥å…· `devplan_search_sections`ï¼šæ”¯æŒ `literal`ï¼ˆå­—é¢åŒ¹é…ï¼‰ã€`semantic`ï¼ˆè¯­ä¹‰å‘é‡æœç´¢ï¼‰ã€`hybrid`ï¼ˆRRF èåˆæ’åºï¼‰ä¸‰ç§æœç´¢æ¨¡å¼
  - æ–°å¢ MCP å·¥å…· `devplan_rebuild_index`ï¼šé‡å»ºæ‰€æœ‰æ–‡æ¡£çš„å‘é‡ Embedding ç´¢å¼•
  - æ–°å¢ `IDevPlanStore` æ¥å£æ–¹æ³•ï¼š`searchSectionsAdvanced()`ã€`rebuildIndex()`ã€`isSemanticSearchEnabled()`
  - æ–°å¢ç±»å‹ï¼š`SearchMode`ã€`ScoredDevPlanDoc`ï¼ˆå¸¦è¯„åˆ†çš„æœç´¢ç»“æœï¼‰ã€`RebuildIndexResult`
  - **VibeSynapse Embedding å¼•æ“**ï¼šä½¿ç”¨ Candle MiniLM-L6-v2ï¼ˆ384 ç»´ï¼‰ç¦»çº¿ç”Ÿæˆ Embeddingï¼Œé›¶ API ä¾èµ–
  - **SocialGraphV2 å‘é‡ç´¢å¼•**ï¼šé…ç½® HNSW ç´¢å¼•ï¼ˆ`vectorSearch` é…ç½®ï¼‰ï¼Œæ”¯æŒ `indexEntity()` / `searchEntitiesByVector()` / `removeEntityVector()`
  - **è‡ªåŠ¨ç´¢å¼•**ï¼š`saveSection()` ä¿å­˜æ–‡æ¡£æ—¶è‡ªåŠ¨è°ƒç”¨ `autoIndexDocument()` ç”Ÿæˆ Embedding å¹¶ç´¢å¼•
  - **RRF èåˆç®—æ³•**ï¼š`rrfFusion()` å°†è¯­ä¹‰å’Œå­—é¢æœç´¢ç»“æœé€šè¿‡ Reciprocal Rank Fusionï¼ˆk=60ï¼‰èåˆæ’åº
  - **ä¼˜é›…é™çº§**ï¼šVibeSynapse åˆå§‹åŒ–å¤±è´¥æ—¶è‡ªåŠ¨é™çº§ä¸ºçº¯å­—é¢æœç´¢ï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½
  - **é…ç½®**ï¼šé€šè¿‡ `.devplan/config.json` ä¸­çš„ `enableSemanticSearch: true` å¯ç”¨
  - `DevPlanGraphStoreConfig` æ–°å¢ `enableSemanticSearch` å’Œ `embeddingDimension` é…ç½®é¡¹

- MCP å·¥å…·ä» 21 ä¸ªå¢åŠ åˆ° 23 ä¸ª

### v4.1.0 â€” æ–‡æ¡£å±‚çº§å…³ç³» (parentDoc) (2026-02-13)

- **æ–‡æ¡£å±‚çº§å…³ç³»ï¼ˆ`parentDoc` å­—æ®µï¼‰**ï¼š
  - `DevPlanDocInput` æ–°å¢ `parentDoc?: string` å¯é€‰å­—æ®µï¼ˆæ ¼å¼ï¼š"section" æˆ– "section|subSection"ï¼‰
  - `DevPlanDoc` æ–°å¢ `parentDoc?: string` å’Œ `childDocs?: string[]` å­—æ®µï¼ˆ`childDocs` ä¸ºè‡ªåŠ¨è®¡ç®—å±æ€§ï¼‰
  - æ–°å¢ `DevPlanDocTree` ç±»å‹ï¼Œæ”¯æŒé€’å½’æ–‡æ¡£æ ‘ç»“æ„
  - MCP å·¥å…· `devplan_save_section` æ–°å¢ `parentDoc` å¯é€‰å‚æ•°
  - `devplan_get_section` è¿”å›å€¼è‡ªåŠ¨åŒ…å« `parentDoc` å’Œ `childDocs`
  - `devplan_list_sections` è¿”å›å€¼è‡ªåŠ¨åŒ…å« `parentDoc`

- **Graph å¼•æ“å®ç°**ï¼š
  - æ–°å¢å…³ç³»ç±»å‹ `doc_has_child`ï¼ˆparent doc â†’ child docï¼‰ï¼Œå…³ç³»æ¨¡å‹ä» 6 ç§æ‰©å±•åˆ° 7 ç§
  - `saveSection()` åˆ›å»º/æ›´æ–°æ—¶è‡ªåŠ¨ç»´æŠ¤ `DOC_HAS_CHILD` å…³ç³»
  - `deleteSection()` åˆ é™¤æ–‡æ¡£æ—¶è‡ªåŠ¨æ–­å¼€çˆ¶å­å…³ç³»ï¼Œå­æ–‡æ¡£çš„ `parentDoc` å±æ€§æ¸…ç©º
  - `exportGraph()` å¯¼å‡º `doc_has_child` è¾¹ï¼Œå¯è§†åŒ–å±•ç¤ºæ–‡æ¡£å±‚çº§
  - æ–°å¢ `getChildDocs()` æ–¹æ³•ï¼šè·å–ç›´æ¥å­æ–‡æ¡£åˆ—è¡¨
  - æ–°å¢ `getDocTree()` æ–¹æ³•ï¼šé€’å½’è·å–æ–‡æ¡£æ ‘
  - æ–°å¢ `updateParentDocRelation()` ç§æœ‰æ–¹æ³•ï¼šæ›´æ–°æ–‡æ¡£çˆ¶å­å…³ç³»

- **Document å¼•æ“å®ç°**ï¼š
  - `saveSection()` åœ¨ `metadata` ä¸­å­˜å‚¨ `parentDoc` å­—æ®µ
  - `docToDevPlanDoc()` ä» `metadata.parentDoc` è¯»å–
  - æ–°å¢ `getChildDocs()` æ–¹æ³•ï¼šé€šè¿‡æ‰«ææ‰€æœ‰æ–‡æ¡£çš„ `parentDoc` å±æ€§å®ç°

- **IDevPlanStore æ¥å£æ–°å¢å¯é€‰æ–¹æ³•**ï¼š`getChildDocs()`ã€`getDocTree()`
- **æ•°æ®è¿ç§»**ï¼š`migrateEngine()` è‡ªåŠ¨è¿ç§» `parentDoc` å­—æ®µ
- å·¥å…·æ•°é‡ä¿æŒ 23 ä¸ªä¸å˜ï¼ˆé€šè¿‡ç°æœ‰å·¥å…·çš„å‚æ•°æ‰©å±•å®ç°ï¼‰

### v4.2.0 â€” æ–‡æ¡£åˆ—è¡¨å¼¹å±‚ä¸ç»Ÿè®¡æ å¢å¼º (2026-02-13)

- **é¡¶éƒ¨ç»Ÿè®¡æ æ–°å¢æ–‡æ¡£æ•°é‡**ï¼š
  - çŠ¶æ€æ æ–°å¢å¯ç‚¹å‡»çš„ã€Œæ–‡æ¡£ã€ç»Ÿè®¡é¡¹ï¼ˆç»¿è‰²æ•°å­—ï¼‰ï¼Œä¸æ¨¡å—/ä¸»ä»»åŠ¡/å­ä»»åŠ¡ç»Ÿä¸€äº¤äº’é£æ ¼
  - æ–‡æ¡£æ•°é‡ä»å›¾è°±èŠ‚ç‚¹ä¸­å®æ—¶ç»Ÿè®¡ï¼ˆ`type === 'document'`ï¼‰

- **æ–‡æ¡£åˆ—è¡¨å¼¹å±‚ï¼ˆå±‚çº§å±•ç¤ºï¼‰**ï¼š
  - ç‚¹å‡»é¡¶éƒ¨ã€Œæ–‡æ¡£ã€æ•°å­—æ‰“å¼€å·¦ä¾§æ–‡æ¡£åˆ—è¡¨å¼¹å±‚ï¼Œé€šè¿‡ `/api/docs` è·å–æ–‡æ¡£å…ƒä¿¡æ¯
  - æ–‡æ¡£æŒ‰ `parentDoc` / `childDocs` çˆ¶å­å…³ç³»æ„å»ºå±‚çº§æ ‘ç»“æ„
  - é¡¶å±‚æ–‡æ¡£æŒ‰ `section` å’Œ `title` æ’åºï¼Œå­æ–‡æ¡£è·Ÿéšçˆ¶æ–‡æ¡£åµŒå¥—ç¼©è¿›å±•ç¤º
  - æœ‰å­æ–‡æ¡£çš„æ¡ç›®å·¦ä¾§æ˜¾ç¤ºå±•å¼€/æŠ˜å æŒ‰é’®ï¼ˆ`+`/`âˆ’`ï¼‰ï¼Œå¯é€’å½’å±•å¼€å¤šçº§å­æ–‡æ¡£
  - æŠ˜å çŠ¶æ€é€šè¿‡ `docModalCollapsedState` å…¨å±€å¯¹è±¡æŒä¹…åŒ–ï¼ˆä¼šè¯å†…ï¼‰

- **å¤ç”¨å·²æœ‰è¯¦æƒ…é¢æ¿**ï¼š
  - ç‚¹å‡»æ–‡æ¡£åˆ—è¡¨ä¸­çš„æ ‡é¢˜ï¼Œç›´æ¥è°ƒç”¨ `statsModalGoToNode()` èšç„¦å›¾è°±èŠ‚ç‚¹å¹¶æ‰“å¼€å³ä¾§è¯¦æƒ…é¢æ¿
  - å¤ç”¨å·²æœ‰çš„èŠ‚ç‚¹è¯¦æƒ…é¢æ¿æ˜¾ç¤ºæ–‡æ¡£å†…å®¹ã€å…ƒä¿¡æ¯ã€å…³è”ä»»åŠ¡ç­‰ï¼Œé¿å…é‡å¤å¼¹å±‚

- **æ–°å¢ API ç«¯ç‚¹ `/api/docs`**ï¼š
  - è¿”å›æ‰€æœ‰æ–‡æ¡£ç‰‡æ®µçš„å…ƒä¿¡æ¯åˆ—è¡¨ï¼ˆä¸å« `content` å†…å®¹ï¼Œå‡å°‘ä¼ è¾“é‡ï¼‰
  - æ¯æ¡è®°å½•åŒ…å« `section`ã€`subSection`ã€`title`ã€`version`ã€`moduleId`ã€`parentDoc`ã€`childDocs`ã€`updatedAt`
  - ç”¨äºæ–‡æ¡£åˆ—è¡¨å¼¹å±‚çš„å·¦ä¾§æ–‡æ¡£æ ‘æ¸²æŸ“

---

## 12. è·¯çº¿å›¾ï¼šæ–‡æ¡£å±‚çº§å…³ç³» (parentDocId) ~~ä¸æœç´¢å¢å¼º~~

> è§„åˆ’æ—¥æœŸ: 2026-02-12  
> æ›´æ–°æ—¥æœŸ: 2026-02-13  
> çŠ¶æ€: **å…¨éƒ¨å·²å®Œæˆ** â€” æœç´¢å¢å¼ºï¼ˆv4.0.0ï¼‰+ æ–‡æ¡£å±‚çº§å…³ç³»ï¼ˆv4.1.0ï¼‰

### 12.1 èƒŒæ™¯ä¸é—®é¢˜

#### 12.1.1 æ–‡æ¡£å±‚çº§é—®é¢˜ âœ… å·²è§£å†³ï¼ˆv4.1.0ï¼‰

> **æ­¤é—®é¢˜å·²åœ¨ v4.1.0 ä¸­è§£å†³**ã€‚ä»¥ä¸‹ä¸ºåŸå§‹é—®é¢˜è®°å½•ï¼Œä¿ç•™ä¾›å‚è€ƒã€‚

~~å½“å‰æ–‡æ¡£æ¨¡å‹æ˜¯**æ‰å¹³ç»“æ„**~~ï¼š~~æ‰€æœ‰æ–‡æ¡£é€šè¿‡ `section` + `subSection` æ„æˆè‡³å¤šä¸¤çº§çš„åˆ†ç±»ä½“ç³»~~ã€‚ç°å·²é€šè¿‡ `parentDoc` å­—æ®µå’Œ `doc_has_child` å…³ç³»å®ç°å¤šçº§æ–‡æ¡£å±‚çº§ï¼š

- ~~**æ–‡æ¡£æ ‘**ï¼šæ— æ³•è¡¨è¾¾"ç« èŠ‚ â†’ å°èŠ‚ â†’ æ®µè½"çš„å¤šçº§æ–‡æ¡£ç»“æ„~~ â†’ `getDocTree()` æ”¯æŒé€’å½’æ–‡æ¡£æ ‘
- ~~**çˆ¶å­å¯¼èˆª**ï¼šæ— æ³•ä»å­æ–‡æ¡£ä¸Šæº¯åˆ°çˆ¶æ–‡æ¡£~~ â†’ `parentDoc` å­—æ®µ + `childDocs` è‡ªåŠ¨è®¡ç®—å±æ€§
- ~~**æ‰¹é‡æ“ä½œ**ï¼šæ— æ³•æŒ‰æ–‡æ¡£æ ‘æ‰¹é‡åˆ é™¤/ç§»åŠ¨æŸä¸ªæ–‡æ¡£åˆ†æ”¯~~ â†’ `deleteSection()` è‡ªåŠ¨æ–­å¼€çˆ¶å­å…³ç³»

#### 12.1.2 æœç´¢èƒ½åŠ›é—®é¢˜ âœ… å·²è§£å†³ï¼ˆv4.0.0ï¼‰

> **æ­¤é—®é¢˜å·²åœ¨ v4.0.0 ä¸­å®Œå…¨è§£å†³**ã€‚ä»¥ä¸‹ä¸ºåŸå§‹é—®é¢˜è®°å½•ï¼Œä¿ç•™ä¾›å‚è€ƒã€‚

~~å½“å‰ `searchSections()` å®ç°æ˜¯**çº¯ JavaScript æš´åŠ›æ‰«æ**~~ï¼š

```typescript
// dev-plan-graph-store.ts â€” v4.0.0 ä¹‹å‰çš„æ—§å®ç°ï¼ˆå·²æ›¿æ¢ï¼‰
searchSections(query: string, limit: number = 10): DevPlanDoc[] {
  const queryLower = query.toLowerCase();
  return this.listSections()
    .filter(doc =>
      doc.content.toLowerCase().includes(queryLower) ||
      doc.title.toLowerCase().includes(queryLower)
    )
    .slice(0, limit);
}
```

~~é—®é¢˜~~ï¼ˆå·²å…¨éƒ¨è§£å†³ï¼‰ï¼š
- ~~**å…¨é‡åŠ è½½**ï¼šæ¯æ¬¡æœç´¢éƒ½è¦åŠ è½½æ‰€æœ‰æ–‡æ¡£åˆ°å†…å­˜~~ â†’ è¯­ä¹‰æœç´¢é€šè¿‡ HNSW å‘é‡ç´¢å¼•å®ç°ï¼Œæ— éœ€å…¨é‡åŠ è½½
- ~~**ä»…å­—é¢åŒ¹é…**ï¼šä¸æ”¯æŒè¯­ä¹‰æœç´¢~~ â†’ æ”¯æŒ `literal` / `semantic` / `hybrid` ä¸‰ç§æ¨¡å¼
- ~~**æ— æ’åº**ï¼šç»“æœæŒ‰å­˜å‚¨é¡ºåºè¿”å›~~ â†’ RRF èåˆæ’åºï¼Œè¿”å›å¸¦ `score` è¯„åˆ†çš„ç»“æœ
- ~~**æœªåˆ©ç”¨ aifastdb åŸç”Ÿèƒ½åŠ›**~~ â†’ é›†æˆ VibeSynapseï¼ˆCandle MiniLMï¼‰+ SocialGraphV2 å‘é‡ç´¢å¼•

### 12.2 ä»»åŠ¡ä¸å­ä»»åŠ¡çš„çˆ¶å­å…³ç³»æœºåˆ¶ï¼ˆå‚è€ƒæ¨¡å‹ï¼‰

å­ä»»åŠ¡ä¸ä¸»ä»»åŠ¡çš„çˆ¶å­å…³ç³»é€šè¿‡**åŒé‡æœºåˆ¶**å®ç°ï¼š

| å±‚çº§ | æœºåˆ¶ | å­—æ®µ / å…³ç³» | ä½œç”¨ |
|------|------|-------------|------|
| å±æ€§å±‚ | `SubTask.parentTaskId` | `parentTaskId: "phase-7"` | å¿«é€Ÿå±æ€§æŸ¥è¯¢ |
| å›¾å±‚ | `HAS_SUB_TASK` å…³ç³» | `main-task â†’ sub-task` | å›¾éå†å’Œå¯è§†åŒ– |

æ–‡æ¡£å±‚çº§å°†å‚ç…§æ­¤æ¨¡å¼è®¾è®¡ã€‚

### 12.3 æ–‡æ¡£å±‚çº§æ–¹æ¡ˆè®¾è®¡

#### 12.3.1 ç±»å‹å˜æ›´

```typescript
// types.ts â€” æ–°å¢å­—æ®µ
interface DevPlanDocInput {
  // ... ç°æœ‰å­—æ®µ ...
  /** çˆ¶æ–‡æ¡£æ ‡è¯†ï¼ˆsection æˆ– section|subSection æ ¼å¼ï¼Œå¯é€‰ï¼‰ */
  parentDoc?: string;
}

interface DevPlanDoc {
  // ... ç°æœ‰å­—æ®µ ...
  /** çˆ¶æ–‡æ¡£æ ‡è¯†ï¼ˆsection æˆ– section|subSection æ ¼å¼ï¼‰ */
  parentDoc?: string;
  /** å­æ–‡æ¡£ ID åˆ—è¡¨ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼Œä»… Graph å¼•æ“æ”¯æŒï¼‰ */
  childDocs?: string[];
}
```

**è®¾è®¡å†³ç­–ï¼š**

- å­—æ®µåä½¿ç”¨ `parentDoc` è€Œé `parentDocId`ï¼Œå› ä¸ºæ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†æ˜¯ `section|subSection` ç»„åˆè€Œéæ•°æ®åº“ ID
- `childDocs` æ˜¯è®¡ç®—å±æ€§ï¼ˆä»å›¾å…³ç³»åå‘æŸ¥è¯¢ï¼‰ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç»´æŠ¤
- å‘åå…¼å®¹ï¼š`parentDoc` ä¸ºå¯é€‰å­—æ®µï¼Œç°æœ‰æ–‡æ¡£æ— éœ€ä¿®æ”¹

#### 12.3.2 æ–°å¢å…³ç³»ç±»å‹

```typescript
// dev-plan-graph-store.ts
const RT = {
  // ... ç°æœ‰å…³ç³» ...
  DOC_HAS_CHILD: 'doc_has_child',  // æ–°å¢ï¼šæ–‡æ¡£ â†’ å­æ–‡æ¡£
} as const;
```

å…³ç³»æ¨¡å‹æ‰©å±•åçš„å®Œæ•´å›¾ï¼š

```
Module â”€â”€1:Nâ”€â”€â–¶ MainTask â”€â”€1:Nâ”€â”€â–¶ SubTask
Module â”€â”€1:Nâ”€â”€â–¶ DevPlanDoc
MainTask â—€â”€â”€N:Mâ”€â”€â–¶ DevPlanDoc       (task_has_doc)
DevPlanDoc â”€â”€1:Nâ”€â”€â–¶ DevPlanDoc       (doc_has_child) â† æ–°å¢
```

#### 12.3.3 å­˜å‚¨å±‚å˜æ›´

**Graph å¼•æ“ (`DevPlanGraphStore`)ï¼š**

| æ“ä½œ | å˜æ›´ |
|------|------|
| `saveSection()` | æ–°å¢ï¼šè‹¥ `input.parentDoc` å­˜åœ¨ï¼Œè§£æçˆ¶æ–‡æ¡£ Entity â†’ åˆ›å»º `DOC_HAS_CHILD` å…³ç³» |
| `getSection()` | æ–°å¢ï¼šæŸ¥è¯¢ `DOC_HAS_CHILD` å…¥å‘å…³ç³»è·å– `parentDoc`ï¼ŒæŸ¥è¯¢å‡ºå‘å…³ç³»è·å– `childDocs` |
| `listSections()` | æ–°å¢ï¼šè¿”å›ç»“æœä¸­å¡«å…… `parentDoc` å­—æ®µ |
| `deleteSection()` | æ–°å¢ï¼šçº§è”åˆ é™¤æ‰€æœ‰å­æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰ï¼Œæˆ–ä»…æ–­å¼€å…³ç³» |
| `exportGraph()` | æ–°å¢ï¼šå¯¼å‡º `doc_has_child` è¾¹ |

**Document å¼•æ“ (`DevPlanDocumentStore`)ï¼š**

| æ“ä½œ | å˜æ›´ |
|------|------|
| `saveSection()` | æ–°å¢ï¼šåœ¨ `metadata` ä¸­å­˜å‚¨ `parentDoc` å­—æ®µ |
| `getSection()` | æ–°å¢ï¼šä» `metadata.parentDoc` è¯»å– |
| `listSections()` | æ–°å¢ï¼šè¿”å›ç»“æœä¸­å¡«å…… `parentDoc` å­—æ®µ |

#### 12.3.4 MCP å·¥å…·å˜æ›´

| å·¥å…· | å˜æ›´ |
|------|------|
| `devplan_save_section` | æ–°å¢å¯é€‰å‚æ•° `parentDoc`ï¼ˆæ ¼å¼ï¼š"section" æˆ– "section\|subSection"ï¼‰ |
| `devplan_get_section` | è¿”å›å€¼æ–°å¢ `parentDoc` å’Œ `childDocs` å­—æ®µ |
| `devplan_list_sections` | è¿”å›å€¼æ–°å¢ `parentDoc` å­—æ®µ |

**æ— éœ€æ–°å¢ MCP å·¥å…·**ï¼šæ–‡æ¡£å±‚çº§é€šè¿‡ç°æœ‰å·¥å…·çš„å‚æ•°æ‰©å±•å®ç°ï¼Œä¿æŒ 23 ä¸ªå·¥å…·ä¸å˜ã€‚

#### 12.3.5 å¯è§†åŒ–å˜æ›´

| ç»„ä»¶ | å˜æ›´ |
|------|------|
| å›¾è°±è¾¹ | æ–°å¢ `doc_has_child` è¾¹ç±»å‹ï¼ˆç´«è‰²è™šçº¿ï¼Œè¡¨ç¤ºæ–‡æ¡£åŒ…å«å…³ç³»ï¼‰ |
| è¯¦æƒ…é¢æ¿ | æ–‡æ¡£èŠ‚ç‚¹æ˜¾ç¤º"çˆ¶æ–‡æ¡£"ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰å’Œ"å­æ–‡æ¡£åˆ—è¡¨"ï¼ˆå¯ç‚¹å‡»è·³è½¬ï¼‰ |
| åº•éƒ¨å›¾ä¾‹ | æ–°å¢"æ–‡æ¡£-å­æ–‡æ¡£"è¾¹ç±»å‹ |

#### 12.3.6 æ¥å£å˜æ›´ (IDevPlanStore)

```typescript
// dev-plan-interface.ts â€” æ–°å¢æ–¹æ³•ï¼ˆå¯é€‰ï¼‰
interface IDevPlanStore {
  // ... ç°æœ‰æ–¹æ³• ...

  /**
   * è·å–æ–‡æ¡£çš„å­æ–‡æ¡£åˆ—è¡¨
   */
  getChildDocs?(section: DevPlanSection, subSection?: string): DevPlanDoc[];

  /**
   * è·å–æ–‡æ¡£æ ‘ï¼ˆé€’å½’ï¼Œå«æ‰€æœ‰åä»£æ–‡æ¡£ï¼‰
   */
  getDocTree?(section: DevPlanSection, subSection?: string): DevPlanDocTree;
}

interface DevPlanDocTree {
  doc: DevPlanDoc;
  children: DevPlanDocTree[];
}
```

### 12.4 æœç´¢å¢å¼ºæ–¹æ¡ˆï¼ˆä¸‰é˜¶æ®µï¼‰ âœ… å·²å…¨éƒ¨å®Œæˆ

> **ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µå·²åœ¨ v4.0.0 ä¸­ä¸€æ¬¡æ€§å®Œæˆ**ï¼Œå®é™…å®ç°åˆå¹¶äº†çŸ­æœŸ/ä¸­æœŸ/é•¿æœŸæ–¹æ¡ˆã€‚

#### 12.4.1 âœ… çŸ­æœŸï¼šåˆ©ç”¨ SocialGraphV2 å±æ€§ç´¢å¼•ï¼ˆå·²å®Œæˆï¼‰

å·²å®ç° `literalSearch()` æ–¹æ³•ï¼Œä½œä¸ºå­—é¢æœç´¢çš„åŸºç¡€å®ç°ï¼ŒåŒæ—¶ä½œä¸ºè¯­ä¹‰æœç´¢ä¸å¯ç”¨æ—¶çš„é™çº§æ–¹æ¡ˆã€‚

#### 12.4.2 âœ… ä¸­æœŸï¼šæ–‡æ¡£ Embedding + å‘é‡ç´¢å¼•ï¼ˆå·²å®Œæˆï¼‰

å·²å®ç°å®Œæ•´çš„è¯­ä¹‰æœç´¢ç®¡çº¿ï¼š

- `saveSection()` ä¿å­˜æ–‡æ¡£æ—¶è‡ªåŠ¨è°ƒç”¨ `autoIndexDocument()` ç”Ÿæˆ Embedding å¹¶ç´¢å¼•åˆ° SocialGraphV2 HNSW
- `searchSectionsAdvanced()` æ”¯æŒä¸‰ç§æœç´¢æ¨¡å¼ï¼š`literal` / `semantic` / `hybrid`
- `rebuildIndex()` æ”¯æŒå…¨é‡é‡å»ºå‘é‡ç´¢å¼•
- Embedding æä¾›è€…é€‰æ‹©äº† **Candle æœ¬åœ°**ï¼ˆMiniLM-L6-v2ï¼Œ384 ç»´ï¼‰ï¼Œé›¶ API ä¾èµ–ï¼Œç¦»çº¿å¯ç”¨

#### 12.4.3 âœ… é•¿æœŸï¼šæ¥å…¥ VibeSynapseï¼ˆå·²å®Œæˆï¼‰

å·²é›†æˆ VibeSynapse ä½œä¸º Embedding å¼•æ“ï¼Œä½¿ç”¨ Candle MiniLM-L6-v2 æœ¬åœ°æ¨¡å‹ï¼š

- `VibeSynapse` å®ä¾‹åœ¨ `DevPlanGraphStore` æ„é€ æ—¶è‡ªåŠ¨åˆå§‹åŒ–
- é€šè¿‡ `synapse.embed(text)` ç”Ÿæˆ Embedding å‘é‡
- é€šè¿‡ `graph.searchEntitiesByVector(embedding, limit, entityType)` è¿›è¡Œå‘é‡è¿‘é‚»æœç´¢
- `rrfFusion()` ä½¿ç”¨ RRFï¼ˆReciprocal Rank Fusion, k=60ï¼‰èåˆè¯­ä¹‰å’Œå­—é¢æœç´¢ç»“æœ
- ä¼˜é›…é™çº§ï¼š`hasPerception` æ£€æŸ¥ + dry-run æµ‹è¯•ï¼Œåˆå§‹åŒ–å¤±è´¥æ—¶è‡ªåŠ¨é™çº§ä¸ºå­—é¢æœç´¢

> **æ³¨æ„**ï¼šVibeSynapse å¤šæ¨¡æ€æœç´¢çš„æ›´é«˜çº§èƒ½åŠ›ï¼ˆè·¨æ–‡æ¡£å…³è”æ¨èã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ’åºï¼‰å¯ä½œä¸ºæœªæ¥å¢å¼ºæ–¹å‘ã€‚

### 12.5 å®æ–½ä¼˜å…ˆçº§

| é˜¶æ®µ | å†…å®¹ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|------|------|--------|----------|------|
| 1 | ~~æ–‡æ¡£å±‚çº§ `parentDoc` å­—æ®µ + Graph å¼•æ“å®ç°~~ | ~~P1~~ | ~~4h~~ | âœ… v4.1.0 å·²å®Œæˆ |
| 2 | ~~æ–‡æ¡£å±‚çº§ Document å¼•æ“å®ç°~~ | ~~P2~~ | ~~2h~~ | âœ… v4.1.0 å·²å®Œæˆ |
| 3 | ~~MCP å·¥å…·å‚æ•°æ‰©å±•ï¼ˆ`parentDoc`ï¼‰~~ | ~~P1~~ | ~~2h~~ | âœ… v4.1.0 å·²å®Œæˆ |
| 4 | ~~å¯è§†åŒ– `doc_has_child` è¾¹ + é¢æ¿æ›´æ–°~~ | ~~P2~~ | ~~3h~~ | âœ… v4.1.0 å·²å®Œæˆ |
| 5 | ~~æœç´¢çŸ­æœŸä¼˜åŒ–ï¼ˆå±æ€§ç´¢å¼•ï¼‰~~ | ~~P1~~ | ~~2h~~ | âœ… v4.0.0 å·²å®Œæˆ |
| 6 | ~~æœç´¢ä¸­æœŸï¼ˆEmbedding + å‘é‡ç´¢å¼•ï¼‰~~ | ~~P2~~ | ~~8h~~ | âœ… v4.0.0 å·²å®Œæˆ |
| 7 | ~~æœç´¢é•¿æœŸï¼ˆVibeSynapse é›†æˆï¼‰~~ | ~~P2~~ | ~~16h~~ | âœ… v4.0.0 å·²å®Œæˆ |

---

## 13. Autopilot æ¨¡å— â€” cursor_auto èåˆæ–¹æ¡ˆ

> è§„åˆ’æ—¥æœŸ: 2026-02-15  
> çŠ¶æ€: **è§„åˆ’ä¸­**  
> å…³è”é¡¹ç›®: `cursor_auto`ï¼ˆ`D:\Project\git\cursor_auto`ï¼‰

### 13.1 èƒŒæ™¯ä¸åŠ¨æœº

#### 13.1.1 cursor_auto é¡¹ç›®æ¦‚è¿°

[cursor_auto](../cursor_auto/) æ˜¯ä¸€ä¸ª Cursor IDE æ— äººå€¼å®ˆè‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ ¸å¿ƒèƒ½åŠ›ï¼š

| èƒ½åŠ› | å®ç°æ–¹å¼ |
|------|---------|
| **å±å¹•çŠ¶æ€æ„ŸçŸ¥** | æˆªå›¾ + Ollama è§†è§‰æ¨¡å‹ï¼ˆGemma 3:27bï¼‰è¯†åˆ« UI çŠ¶æ€ |
| **GUI è‡ªåŠ¨åŒ–** | pyautogui + pygetwindow + pyperclip æ“ä½œ Cursor çª—å£ |
| **ä»»åŠ¡é˜Ÿåˆ—** | `tasks.txt` çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œé€è¡Œå‘é€ç»™ Cursor AI |
| **Web ç›‘æ§** | Flask + SSE å®æ—¶æ¨é€çŠ¶æ€åˆ°æµè§ˆå™¨ |

**cursor_auto å½“å‰æŠ€æœ¯æ ˆ**ï¼š

```
Python 3.x
â”œâ”€â”€ pyautogui >= 0.9.54      # GUI è‡ªåŠ¨åŒ–ï¼ˆé¼ æ ‡ã€é”®ç›˜ã€æˆªå›¾ï¼‰
â”œâ”€â”€ pygetwindow              # çª—å£ç®¡ç†ï¼ˆæ¿€æ´»ã€å®šä½ï¼‰
â”œâ”€â”€ ollama >= 0.1.0          # è§†è§‰ AI æ¨¡å‹è°ƒç”¨
â”œâ”€â”€ Pillow >= 10.0.0         # å›¾åƒå¤„ç†ï¼ˆæˆªå›¾è£å‰ªï¼‰
â”œâ”€â”€ pyperclip >= 1.8.2       # å‰ªè´´æ¿æ“ä½œ
â””â”€â”€ Flask >= 3.0.0           # Web UI åç«¯ + SSE
```

**cursor_auto å½“å‰ä»£ç é‡**ï¼ˆçº¦ 2624 è¡Œï¼‰ï¼š

| æ¨¡å— | è¡Œæ•° | èŒè´£ |
|------|------|------|
| `automator.py` | 614 | ä¸»æ§å¾ªç¯ï¼šæˆªå›¾â†’åˆ†æâ†’å†³ç­–â†’æ‰§è¡Œ |
| `cursor_controller.py` | 447 | GUI æ“ä½œï¼šçª—å£æ¿€æ´»ã€æ–‡æœ¬è¾“å…¥ã€å¿«æ·é”® |
| `vision_analyzer.py` | 395 | è§†è§‰åˆ†æï¼šæˆªå›¾â†’Ollamaâ†’çŠ¶æ€è¯†åˆ« |
| `ui_server.py` | 225 | Web UIï¼šFlask + SSE å®æ—¶ç›‘æ§ |
| `task_manager.py` | 199 | ä»»åŠ¡ç®¡ç†ï¼šä» tasks.txt åŠ è½½/åˆ‡æ¢ä»»åŠ¡ |
| `config.py` | 76 | é…ç½®ï¼šæ¨¡å‹ã€è¶…æ—¶ã€åæ ‡ã€çŠ¶æ€æ ‡è®° |
| `templates/index.html` | 668 | Web å‰ç«¯é¡µé¢ |

#### 13.1.2 æ ¸å¿ƒé—®é¢˜ï¼šçº¯æˆªå›¾æ–¹æ¡ˆçš„ç¼ºé™·

cursor_auto å½“å‰çš„ä¿¡æ¯è·å–å®Œå…¨ä¾èµ–"æˆªå›¾ â†’ è§†è§‰ AI è¯†åˆ«"ï¼Œå­˜åœ¨æ ¹æœ¬æ€§ç¼ºé™·ï¼š

| é—®é¢˜ | è¡¨ç° | å½±å“ |
|------|------|------|
| **çŠ¶æ€è¯†åˆ«ä¸å‡†ç¡®** | Ollama è§†è§‰æ¨¡å‹å¯¹å¤æ‚ UI çš„è¯†åˆ«ç‡ä¸ç¨³å®š | è¯¯åˆ¤å¯¼è‡´é”™è¯¯æ“ä½œï¼ˆå¦‚è¯¯å‘"è¯·ç»§ç»­"ï¼‰ |
| **ç¼ºä¹è¯­ä¹‰ç†è§£** | åªèƒ½è¯†åˆ« UI è§†è§‰ç‰¹å¾ï¼Œæ— æ³•ç†è§£"ä»»åŠ¡æ˜¯å¦çœŸæ­£å®Œæˆ" | COMPLETED çŠ¶æ€å¯èƒ½åªæ˜¯ AI ç”Ÿæˆäº†å›å¤ä½†æœªé€šè¿‡æµ‹è¯• |
| **æ— ä»»åŠ¡ä¸Šä¸‹æ–‡** | ä¸çŸ¥é“å½“å‰ Cursor åœ¨æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ã€å±äºå“ªä¸ªé˜¶æ®µ | ä»»åŠ¡åˆ‡æ¢ç›²ç›®ï¼Œåªèƒ½æŒ‰ `tasks.txt` é¡ºåºå‘é€ |
| **çŠ¶æ€ä¸æŒä¹…** | é‡å¯åä¸¢å¤±æ‰€æœ‰è¿›åº¦ï¼Œæ— æ³•æ–­ç‚¹ç»­ä¼  | é•¿æ—¶é—´è¿è¡Œä»»åŠ¡é“¾æ—¶é£é™©æé«˜ |
| **èµ„æºæµªè´¹** | æ¯æ¬¡è½®è¯¢éƒ½è¦è°ƒç”¨è§†è§‰æ¨¡å‹ï¼Œå³ä½¿ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿ | å¢åŠ  GPU/CPU å¼€é”€å’Œå»¶è¿Ÿ |

#### 13.1.3 DevPlan å·²ç»è§£å†³äº†ä»»åŠ¡æ„ŸçŸ¥

DevPlan çš„ä»»åŠ¡ç³»ç»Ÿå¤©ç„¶æä¾›äº† cursor_auto ç¼ºå¤±çš„èƒ½åŠ›ï¼š

```
å½“å‰æ–¹æ¡ˆï¼ˆæˆªå›¾é©±åŠ¨ï¼‰:
  [æˆªå›¾] â†’ [Ollamaåˆ†æ] â†’ "è¿™çœ‹èµ·æ¥åƒæ˜¯å®Œæˆäº†" â†’ [å‘é€ä¸‹ä¸€ä¸ªä»»åŠ¡]
                                â†‘ ä¸ç¡®å®š! å¯èƒ½è¯¯åˆ¤!

å‡çº§æ–¹æ¡ˆï¼ˆMCP ä»»åŠ¡æ„ŸçŸ¥ï¼‰:
  [DevPlan API è½®è¯¢] â†’ task.status === "completed" â†’ [ç¡®å®šå®Œæˆ!] â†’ [è‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€é˜¶æ®µ]
  [æˆªå›¾åˆ†æ] â†’ "AI åœåœ¨ç­‰å¾…ç¡®è®¤/ä¸­æ–­/æŠ¥é”™" â†’ [å‘é€"è¯·ç»§ç»­"]
```

**æ ¸å¿ƒæ€è·¯**ï¼šDevPlan è´Ÿè´£"åšä»€ä¹ˆ"ï¼ˆä»»åŠ¡ç¼–æ’ï¼‰ï¼Œæˆªå›¾åˆ†æè´Ÿè´£"ä»€ä¹ˆæ—¶å€™èƒ½æ“ä½œ"ï¼ˆUI çŠ¶æ€æ£€æµ‹ï¼‰ã€‚

### 13.2 èåˆæ–¹æ¡ˆé€‰æ‹©ï¼šæ–¹æ¡ˆ C â€” Monorepo + æ¸…æ™°åˆ†åŒº

#### 13.2.1 ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”

| | æ–¹æ¡ˆ Aï¼šä¿æŒ 2 ä¸ª repo | æ–¹æ¡ˆ Bï¼šå®Œå…¨æ··åˆåˆå¹¶ | **æ–¹æ¡ˆ Cï¼šMonorepo + æ¸…æ™°åˆ†åŒº** âœ… |
|---|---|---|---|
| **ç»“æ„** | å„è‡ªç‹¬ç«‹ | Python ä»£ç æ··åœ¨ TypeScript ä¸­ | Python ä»£ç æ”¾ `executor/` ç›®å½•ï¼ŒTypeScript ä¸åŠ¨ |
| **API åŒæ­¥** | æ”¹äº† TS API è¦è·‘åˆ°å¦ä¸€ä¸ª repo æ”¹ Python å®¢æˆ·ç«¯ | åŒ repo ä¸€èµ·æ”¹ | åŒ repo ä¸€èµ·æ”¹ âœ… |
| **npm å‘å¸ƒ** | ä¸å—å½±å“ | éœ€è¦å°å¿ƒæ’é™¤ Python æ–‡ä»¶ | `package.json` çš„ `files: ["dist"]` å¤©ç„¶æ’é™¤ âœ… |
| **TypeScript ç¼–è¯‘** | ä¸å—å½±å“ | å¯èƒ½å†²çª | `tsconfig.json` çš„ `include: ["src/**/*"]` å®Œå…¨å¿½ç•¥ `executor/` âœ… |
| **Git ç‰ˆæœ¬** | API å˜æ›´éœ€ä¸¤è¾¹åè°ƒ commit | ä¸€ä¸ª commit æå®š | ä¸€ä¸ª commit æå®š âœ… |
| **æ„å»ºäº’ä¸å¹²æ‰°** | å¤©ç„¶éš”ç¦» | å¯èƒ½å†²çª | `tsc` åªç¼–è¯‘ `src/`ï¼ŒPython æ— éœ€ç¼–è¯‘ âœ… |

#### 13.2.2 æ–¹æ¡ˆ C å¯è¡Œæ€§è®ºè¯

**æ„å»ºéš”ç¦»**å·²ç”±ç°æœ‰é…ç½®å¤©ç„¶ä¿è¯ï¼š

```json
// package.json â€” npm å‘å¸ƒä»…åŒ…å« dist/
"files": ["dist", "README.md", "LICENSE"]

// tsconfig.json â€” TypeScript ç¼–è¯‘å™¨ä»…å¤„ç† src/
"include": ["src/**/*"],
"exclude": ["node_modules", "dist"]
```

Python ä»£ç æ”¾åœ¨ `executor/` ç›®å½•ä¸‹ï¼Œå¯¹ TypeScript ç¼–è¯‘å’Œ npm å‘å¸ƒ**é›¶å½±å“**ã€‚

**æŠ€æœ¯æ ˆå·®å¼‚åˆ†æ**ï¼š

| ç»´åº¦ | TypeScript (DevPlan) | Python (Executor) | ç»“è®º |
|------|---------------------|-------------------|------|
| **èŒè´£** | ä»»åŠ¡ç¼–æ’ï¼ˆå¤§è„‘ï¼‰ | GUI æ“ä½œï¼ˆåŒæ‰‹ï¼‰ | äº’è¡¥ä¸é‡å  |
| **è¿è¡Œæ—¶** | Node.jsï¼ˆMCP Serverï¼‰ | æ¡Œé¢è¿›ç¨‹ï¼ˆéœ€ GUI è®¿é—®ï¼‰ | ç‹¬ç«‹è¿›ç¨‹ |
| **æ„å»º** | `tsc` â†’ `dist/` | æ— éœ€ç¼–è¯‘ | äº’ä¸å¹²æ‰° |
| **ä¾èµ–** | npm (`package.json`) | pip (`pyproject.toml`) | å„è‡ªç®¡ç† |
| **å‘å¸ƒ** | npm registry | ä¸å‘å¸ƒï¼ˆæœ¬åœ°å·¥å…·ï¼‰ | æ— å†²çª |

### 13.3 åˆå¹¶åçš„ç›®å½•ç»“æ„

```
aifastdb-devplan/                          # é¡¹ç›®æ ¹ (Git repo)
â”‚
â”œâ”€â”€ src/                                   # TypeScript â€” DevPlan æ ¸å¿ƒ + MCP + API
â”‚   â”œâ”€â”€ types.ts                           #   ç±»å‹å®šä¹‰ï¼ˆç°æœ‰ + Autopilot ç±»å‹æ‰©å±•ï¼‰
â”‚   â”œâ”€â”€ dev-plan-interface.ts              #   IDevPlanStore æ¥å£ï¼ˆç°æœ‰ï¼‰
â”‚   â”œâ”€â”€ dev-plan-graph-store.ts            #   Graph å¼•æ“ï¼ˆç°æœ‰ï¼‰
â”‚   â”œâ”€â”€ dev-plan-document-store.ts         #   Document å¼•æ“ï¼ˆç°æœ‰ï¼‰
â”‚   â”œâ”€â”€ dev-plan-factory.ts                #   å·¥å‚å‡½æ•°ï¼ˆç°æœ‰ï¼‰
â”‚   â”œâ”€â”€ dev-plan-migrate.ts                #   å¼•æ“è¿ç§»ï¼ˆç°æœ‰ï¼‰
â”‚   â”œâ”€â”€ index.ts                           #   npm åŒ…å¯¼å‡ºå…¥å£ï¼ˆç°æœ‰ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ mcp-server/
â”‚   â”‚   â””â”€â”€ index.ts                       #   MCP Serverï¼ˆç°æœ‰ 23 ä¸ªå·¥å…· + æ–°å¢ 3 ä¸ª autopilot å·¥å…·ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ visualize/
â”‚       â”œâ”€â”€ server.ts                      #   HTTP æœåŠ¡å™¨ï¼ˆç°æœ‰ API + æ–°å¢ /api/auto/* ç«¯ç‚¹ï¼‰
â”‚       â””â”€â”€ template.ts                    #   å¯è§†åŒ– HTML æ¨¡æ¿ï¼ˆç°æœ‰ï¼‰
â”‚
â”œâ”€â”€ executor/                              # Python â€” Autopilot æ‰§è¡Œå™¨ï¼ˆä» cursor_auto é‡æ„è¿å…¥ï¼‰
â”‚   â”œâ”€â”€ pyproject.toml                     #   Python ä¾èµ–ä¸é¡¹ç›®å…ƒæ•°æ®
â”‚   â”œâ”€â”€ README.md                          #   executor ä½¿ç”¨è¯´æ˜
â”‚   â”‚
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ engine.py                      #   â˜… ä¸»æ§å¼•æ“ï¼ˆåŸ automator.py é‡å†™ï¼‰
â”‚   â”‚   â”œâ”€â”€ devplan_client.py              #   â˜… DevPlan HTTP å®¢æˆ·ç«¯ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ cursor_controller.py           #   GUI è‡ªåŠ¨åŒ–ï¼ˆä» cursor_auto è¿å…¥ï¼‰
â”‚   â”‚   â”œâ”€â”€ vision_analyzer.py             #   è§†è§‰åˆ†æï¼ˆç²¾ç®€åï¼Œåªåˆ¤æ–­ UI çŠ¶æ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ ui_server.py                   #   Web UI ç›‘æ§ï¼ˆå¢å¼ºï¼šé›†æˆ DevPlan è¿›åº¦ï¼‰
â”‚   â”‚   â””â”€â”€ config.py                      #   é…ç½®ç®¡ç†ï¼ˆå‡çº§ä¸º dataclass/pydanticï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ index.html                     #   Web UI å‰ç«¯ï¼ˆå¢å¼ºç‰ˆï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ tests/
â”‚       â”œâ”€â”€ test_devplan_client.py
â”‚       â””â”€â”€ test_engine.py
â”‚
â”œâ”€â”€ package.json                           # npm é…ç½®ï¼ˆç°æœ‰ï¼Œä¸å˜ï¼‰
â”œâ”€â”€ tsconfig.json                          # TypeScript é…ç½®ï¼ˆç°æœ‰ï¼Œä¸å˜ï¼‰
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ dist/                                  # TypeScript ç¼–è¯‘äº§ç‰©
â”œâ”€â”€ DEVPLAN_ReadMe.md                      # æœ¬æ–‡æ¡£
â”œâ”€â”€ LICENSE
â””â”€â”€ README.md
```

**å…³é”®éš”ç¦»ç‚¹**ï¼š

| æ–‡ä»¶/é…ç½® | èŒƒå›´ | executor/ å¯è§æ€§ |
|-----------|------|-----------------|
| `tsconfig.json` â†’ `include: ["src/**/*"]` | ä»…ç¼–è¯‘ `src/` | âŒ ä¸å¯è§ |
| `package.json` â†’ `files: ["dist", ...]` | ä»…å‘å¸ƒ `dist/` | âŒ ä¸å¯è§ |
| `.gitignore` | å…¨ repo | âœ… å…±äº«ï¼ˆéœ€æ–°å¢ `executor/__pycache__/` ç­‰ï¼‰ |
| `git commit` | å…¨ repo | âœ… TS + Python å˜æ›´ä¸€æ¬¡æäº¤ |

### 13.4 TypeScript ä¾§æ–°å¢ï¼šAutopilot æ¨¡å—

#### 13.4.1 æ–°å¢ MCP å·¥å…·ï¼ˆ3 ä¸ª â†’ å…± 26 ä¸ªï¼‰

| å·¥å…·å | è¯´æ˜ | å¿…éœ€å‚æ•° | å¯é€‰å‚æ•° |
|--------|------|---------|---------|
| `devplan_auto_status` | æŸ¥è¯¢è‡ªåŠ¨åŒ–æ‰§è¡ŒçŠ¶æ€ï¼šæ˜¯å¦æœ‰è¿›è¡Œä¸­é˜¶æ®µã€å½“å‰å­ä»»åŠ¡ã€é˜»å¡åŸå›  | `projectName` | â€” |
| `devplan_auto_next` | æ™ºèƒ½æ¨èä¸‹ä¸€æ­¥åŠ¨ä½œï¼šå‘é€ä»»åŠ¡ / è¯·ç»§ç»­ / å¯åŠ¨æ–°é˜¶æ®µ / ç­‰å¾… / å…¨éƒ¨å®Œæˆ | `projectName` | â€” |
| `devplan_auto_config` | é…ç½®è‡ªåŠ¨åŒ–å‚æ•°ï¼šè½®è¯¢é—´éš”ã€è‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€é˜¶æ®µã€æœ€å¤§é‡è¯•æ¬¡æ•° | `projectName` | `config` |

**`devplan_auto_status` è¿”å›å€¼**ï¼š

```typescript
{
  hasActivePhase: boolean;           // æ˜¯å¦æœ‰è¿›è¡Œä¸­çš„é˜¶æ®µ
  activePhase?: {
    taskId: string;
    title: string;
    totalSubtasks: number;
    completedSubtasks: number;
    percent: number;
  };
  currentSubTask?: {                 // å½“å‰è¿›è¡Œä¸­çš„å­ä»»åŠ¡
    taskId: string;
    title: string;
    status: TaskStatus;
  };
  nextPendingSubTask?: {             // ä¸‹ä¸€ä¸ªå¾…æ‰§è¡Œçš„å­ä»»åŠ¡
    taskId: string;
    title: string;
  };
  nextPendingPhase?: {               // ä¸‹ä¸€ä¸ªå¾…å¯åŠ¨çš„é˜¶æ®µ
    taskId: string;
    title: string;
    priority: string;
  };
  remainingPhases: number;           // å‰©ä½™æœªå®Œæˆé˜¶æ®µæ•°
}
```

**`devplan_auto_next` è¿”å›å€¼**ï¼š

```typescript
{
  action: 'send_task' | 'send_continue' | 'start_phase' | 'wait' | 'all_done';
  phase?: { taskId, title, status, totalSubtasks, completedSubtasks };
  subTask?: { taskId, title, description, status };
  message: string;                   // äººç±»å¯è¯»çš„è¡ŒåŠ¨å»ºè®®
}
```

#### 13.4.2 å¯è§†åŒ–æœåŠ¡å™¨æ–°å¢ API ç«¯ç‚¹ï¼ˆ5 ä¸ªï¼‰

åœ¨ `src/visualize/server.ts` çš„ `switch (url.pathname)` ä¸­æ–°å¢ï¼š

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ | è°ƒç”¨è€… |
|------|------|------|--------|
| `GET /api/auto/next-action` | GET | è·å–ä¸‹ä¸€æ­¥è¯¥æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œï¼ˆç­‰æ•ˆäº `devplan_auto_next`ï¼‰ | executor è½®è¯¢ |
| `GET /api/auto/current-phase` | GET | è·å–å½“å‰è¿›è¡Œä¸­é˜¶æ®µåŠå…¨éƒ¨å­ä»»åŠ¡çŠ¶æ€ | executor è½®è¯¢ |
| `POST /api/auto/complete-task` | POST | æ ‡è®°å­ä»»åŠ¡å®Œæˆï¼ˆç­‰æ•ˆäº `devplan_complete_task`ï¼‰ | executor å›è°ƒ |
| `POST /api/auto/start-phase` | POST | å¯åŠ¨æ–°é˜¶æ®µï¼ˆç­‰æ•ˆäº `devplan_start_phase`ï¼‰ | executor è¯·æ±‚ |
| `POST /api/auto/heartbeat` | POST | executor å¿ƒè·³ä¸ŠæŠ¥ï¼ˆå« UI çŠ¶æ€ä¿¡æ¯ï¼‰ | executor å®šæ—¶ |

**`GET /api/auto/next-action` å“åº”ç¤ºä¾‹**ï¼š

```json
{
  "action": "send_task",
  "phase": {
    "taskId": "phase-17",
    "title": "é˜¶æ®µåä¸ƒ: åˆ†å¸ƒå¼æŸ¥è¯¢ä¼˜åŒ–",
    "status": "in_progress",
    "totalSubtasks": 8,
    "completedSubtasks": 3
  },
  "subTask": {
    "taskId": "T17.4",
    "title": "å®ç°æŸ¥è¯¢è®¡åˆ’ç¼“å­˜",
    "description": "ä¸ºè·¨åº“æŸ¥è¯¢è®¡åˆ’æ·»åŠ  LRU ç¼“å­˜...",
    "status": "pending"
  },
  "message": "å½“å‰é˜¶æ®µæœ‰ 5 ä¸ªå¾…å®Œæˆå­ä»»åŠ¡ï¼Œä¸‹ä¸€ä¸ª: T17.4 â€” å®ç°æŸ¥è¯¢è®¡åˆ’ç¼“å­˜"
}
```

**`POST /api/auto/heartbeat` è¯·æ±‚ä½“**ï¼š

```json
{
  "executorId": "cursor-auto-001",
  "status": "active",
  "lastScreenState": "WORKING",
  "timestamp": 1739612345678
}
```

**è®¾è®¡å†³ç­– â€” ä¸ºä»€ä¹ˆé€šè¿‡ HTTP API è€Œä¸æ˜¯ç›´æ¥è¯» JSONL/WAL**ï¼š

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| ç›´æ¥è¯»å– `.devplan/` æ•°æ®æ–‡ä»¶ | é›¶å»¶è¿Ÿï¼Œæ— éœ€ç½‘ç»œ | è€¦åˆå­˜å‚¨æ ¼å¼ï¼Œå¼•æ“åˆ‡æ¢æ—¶éœ€é€‚é…ï¼›Python éœ€è§£æ WAL |
| MCP stdio å­è¿›ç¨‹ | æ ‡å‡†åè®®ï¼Œå®Œå…¨è§£è€¦ | éœ€ç®¡ç†å­è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸï¼Œå®ç°å¤æ‚ |
| **HTTP API** âœ… | ç®€å•å¯é ï¼ŒPython `requests` å³å¯ï¼›å¯è§†åŒ–æœåŠ¡å™¨å·²æœ‰å®Œæ•´æ¡†æ¶ | éœ€è¦å¯è§†åŒ–æœåŠ¡å™¨åœ¨è¿è¡Œ |

é€‰æ‹© HTTP API å› ä¸ºï¼š
1. å¯è§†åŒ–æœåŠ¡å™¨å·²æœ‰ `createFreshStore()` æ¨¡å¼ï¼Œæ¯æ¬¡è¯·æ±‚è¯»å–æœ€æ–°æ•°æ®
2. å·²æœ‰ CORS å¤´ã€é”™è¯¯å¤„ç†ã€CLI å‚æ•°è§£æç­‰åŸºç¡€è®¾æ–½
3. Python çš„ `requests` è°ƒç”¨ HTTP API æå…¶ç®€å•
4. å¯è§†åŒ–æœåŠ¡å™¨æœ¬å°±éœ€è¦è¿è¡Œï¼ˆæä¾›ä»ªè¡¨ç›˜ï¼‰ï¼Œä¸å¢åŠ è¿ç»´è´Ÿæ‹…

#### 13.4.3 æ•°æ®æ¨¡å‹æ‰©å±•

åœ¨ `src/types.ts` ä¸­æ–°å¢ï¼š

```typescript
// ============================================================================
// Autopilot ç›¸å…³ç±»å‹
// ============================================================================

/** Autopilot è‡ªåŠ¨åŒ–é…ç½® */
export interface AutopilotConfig {
  /** æ˜¯å¦å¯ç”¨ autopilot */
  enabled: boolean;
  /** executor è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ */
  pollIntervalSeconds: number;
  /** é˜¶æ®µå®Œæˆåè‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€ä¸ª */
  autoStartNextPhase: boolean;
  /** å‘é€"è¯·ç»§ç»­"çš„æœ€å¤§è¿ç»­é‡è¯•æ¬¡æ•° */
  maxContinueRetries: number;
  /** å­ä»»åŠ¡å¡ä½è¶…æ—¶æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ */
  stuckTimeoutMinutes: number;
}

/** Autopilot ä¸‹ä¸€æ­¥åŠ¨ä½œç±»å‹ */
export type AutopilotAction = 
  | 'send_task'       // å‘é€æ–°çš„å­ä»»åŠ¡å†…å®¹ç»™ Cursor
  | 'send_continue'   // å‘é€"è¯·ç»§ç»­"ï¼ˆAI è¢«ä¸­æ–­/é™é€Ÿï¼‰
  | 'start_phase'     // å¯åŠ¨æ–°é˜¶æ®µ
  | 'wait'            // ç­‰å¾…ï¼ˆä»»åŠ¡è¿›è¡Œä¸­ï¼Œæ— éœ€æ“ä½œï¼‰
  | 'all_done';       // å…¨éƒ¨ä»»åŠ¡å®Œæˆ

/** Autopilot åŠ¨ä½œå»ºè®® */
export interface AutopilotNextAction {
  action: AutopilotAction;
  phase?: {
    taskId: string;
    title: string;
    status: TaskStatus;
    totalSubtasks: number;
    completedSubtasks: number;
  };
  subTask?: {
    taskId: string;
    title: string;
    description?: string;
    status: TaskStatus;
  };
  message: string;
}

/** Autopilot æ‰§è¡ŒçŠ¶æ€ */
export interface AutopilotStatus {
  hasActivePhase: boolean;
  activePhase?: {
    taskId: string;
    title: string;
    totalSubtasks: number;
    completedSubtasks: number;
    percent: number;
  };
  currentSubTask?: {
    taskId: string;
    title: string;
    status: TaskStatus;
  };
  nextPendingSubTask?: {
    taskId: string;
    title: string;
  };
  nextPendingPhase?: {
    taskId: string;
    title: string;
    priority: string;
  };
  remainingPhases: number;
}

/** Executor å¿ƒè·³æ•°æ® */
export interface ExecutorHeartbeat {
  executorId: string;
  status: 'active' | 'paused' | 'stopped';
  lastScreenState?: string;
  timestamp: number;
}
```

### 13.5 Python ä¾§ï¼šAutopilot Executor

#### 13.5.1 æ¨¡å—èŒè´£å¯¹æ¯”ï¼ˆé‡æ„å‰ â†’ é‡æ„åï¼‰

| åŸæ¨¡å— (cursor_auto) | é‡æ„æ–¹å‘ | æ–°æ¨¡å— (executor) |
|----------------------|---------|-------------------|
| `task_manager.py` | **åˆ é™¤**ï¼Œç”± DevPlan API æ›¿ä»£ | `devplan_client.py` â˜… æ–°å¢ |
| `automator.py` | **é‡å†™**ä¸ºåŒé€šé“å†³ç­–å¼•æ“ | `engine.py` |
| `vision_analyzer.py` | **ç²¾ç®€** Promptï¼Œä¸å†åˆ¤æ–­"ä»»åŠ¡å®Œæˆ" | `vision_analyzer.py` |
| `cursor_controller.py` | **åŸºæœ¬ä¿ç•™**ï¼Œä¿®å¤åæ ‡ç¡¬ç¼–ç  | `cursor_controller.py` |
| `config.py` | **å‡çº§**ä¸º dataclass/pydantic | `config.py` |
| `ui_server.py` | **å¢å¼º**ï¼šé›†æˆ DevPlan è¿›åº¦ä¿¡æ¯ | `ui_server.py` |
| `tasks.txt` | **åˆ é™¤** | â€” |

#### 13.5.2 devplan_client.py â€” DevPlan HTTP å®¢æˆ·ç«¯

```python
"""
DevPlan HTTP å®¢æˆ·ç«¯ â€” ä¸ aifastdb-devplan å¯è§†åŒ–æœåŠ¡å™¨é€šä¿¡ã€‚

é€šè¿‡ /api/auto/* ç«¯ç‚¹è·å–ä»»åŠ¡çŠ¶æ€ã€æäº¤å®Œæˆã€å¯åŠ¨æ–°é˜¶æ®µã€‚
"""
import requests
from dataclasses import dataclass
from typing import Optional

@dataclass
class DevPlanConfig:
    base_url: str = "http://localhost:3210"
    timeout: int = 10  # ç§’

class DevPlanClient:
    def __init__(self, config: DevPlanConfig = None):
        self.config = config or DevPlanConfig()
        self.session = requests.Session()
    
    def get_next_action(self) -> dict:
        """GET /api/auto/next-action â€” è·å–ä¸‹ä¸€æ­¥åŠ¨ä½œå»ºè®®"""
        resp = self.session.get(
            f"{self.config.base_url}/api/auto/next-action",
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
    
    def get_current_phase(self) -> dict:
        """GET /api/auto/current-phase â€” è·å–å½“å‰é˜¶æ®µè¯¦æƒ…"""
        resp = self.session.get(
            f"{self.config.base_url}/api/auto/current-phase",
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
    
    def complete_task(self, task_id: str) -> dict:
        """POST /api/auto/complete-task â€” æ ‡è®°å­ä»»åŠ¡å®Œæˆ"""
        resp = self.session.post(
            f"{self.config.base_url}/api/auto/complete-task",
            json={"taskId": task_id},
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
    
    def start_phase(self, task_id: str) -> dict:
        """POST /api/auto/start-phase â€” å¯åŠ¨æ–°é˜¶æ®µ"""
        resp = self.session.post(
            f"{self.config.base_url}/api/auto/start-phase",
            json={"taskId": task_id},
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
    
    def heartbeat(self, executor_id: str, status: str, 
                  screen_state: Optional[str] = None) -> dict:
        """POST /api/auto/heartbeat â€” å¿ƒè·³ä¸ŠæŠ¥"""
        resp = self.session.post(
            f"{self.config.base_url}/api/auto/heartbeat",
            json={
                "executorId": executor_id,
                "status": status,
                "lastScreenState": screen_state,
            },
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
    
    def get_progress(self) -> dict:
        """GET /api/progress â€” è·å–é¡¹ç›®è¿›åº¦ï¼ˆç°æœ‰ç«¯ç‚¹ï¼‰"""
        resp = self.session.get(
            f"{self.config.base_url}/api/progress",
            timeout=self.config.timeout
        )
        resp.raise_for_status()
        return resp.json()
```

#### 13.5.3 åŒé€šé“å†³ç­–å¼•æ“

executor çš„æ ¸å¿ƒåˆ›æ–°æ˜¯**åŒé€šé“è”åˆå†³ç­–**ï¼šåŒæ—¶é‡‡é›† DevPlan ä»»åŠ¡çŠ¶æ€å’Œ UI æˆªå›¾çŠ¶æ€ï¼Œç»¼åˆåˆ¤æ–­ä¸‹ä¸€æ­¥æ“ä½œã€‚

**å†³ç­–çŸ©é˜µ**ï¼š

| DevPlan ä»»åŠ¡çŠ¶æ€ | æˆªå›¾ UI çŠ¶æ€ | è”åˆåˆ¤æ–­ | æ‰§è¡ŒåŠ¨ä½œ |
|----------------|-------------|---------|---------|
| æœ‰ pending å­ä»»åŠ¡ | IDLEï¼ˆç©ºé—²ï¼‰ | âœ… å¯ä»¥å‘é€æ–°ä»»åŠ¡ | å‘é€å­ä»»åŠ¡å†…å®¹åˆ° Cursor |
| å­ä»»åŠ¡ in_progress | WORKING | æ­£å¸¸ï¼Œç­‰å¾… | ä¸æ“ä½œ |
| å­ä»»åŠ¡ in_progress | INTERRUPTED / ä¸­æ–­ | AI è¢«ä¸­æ–­ | å‘é€"è¯·ç»§ç»­" |
| å­ä»»åŠ¡ in_progress | ERROR | AI é‡åˆ°é”™è¯¯ | å‘é€"è¯·ç»§ç»­"æˆ–é”™è¯¯å¤„ç† |
| å­ä»»åŠ¡ in_progress | IDLEï¼ˆè¶…æ—¶ï¼‰ | AI å¯èƒ½å®Œæˆäº†ä½†æ²¡å›è°ƒ | é‡æ–°æ£€æŸ¥ DevPlan çŠ¶æ€ |
| å…¨éƒ¨å­ä»»åŠ¡ completed | ä»»æ„ | é˜¶æ®µå®Œæˆ | è‡ªåŠ¨ start_phase ä¸‹ä¸€é˜¶æ®µ |
| æ—  pending é˜¶æ®µ | ä»»æ„ | å…¨éƒ¨å®Œæˆ | åœæ­¢è‡ªåŠ¨åŒ– |

**å…³é”®æ”¹è¿›**ï¼š

1. **ä¸å†ä¾èµ–æˆªå›¾åˆ¤æ–­"ä»»åŠ¡æ˜¯å¦å®Œæˆ"** â€” ç”± Cursor ä¸­çš„ AI è°ƒç”¨ `devplan_complete_task` æä¾›ç²¾ç¡®çŠ¶æ€
2. **æˆªå›¾åªè´Ÿè´£åˆ¤æ–­ UI å±‚é¢çš„å¡ä½/ä¸­æ–­/æŠ¥é”™** â€” è¿™æ˜¯è§†è§‰åˆ†æçœŸæ­£æ“…é•¿çš„äº‹
3. **æ”¯æŒ"ä»»åŠ¡å®Œæˆ â†’ è‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€é˜¶æ®µ"** â€” å…¨ç¨‹è‡ªåŠ¨ï¼Œæ— éœ€äººå·¥å‘é€æ–°ä»»åŠ¡

#### 13.5.4 ç²¾ç®€åçš„ VisionAnalyzer Prompt

é‡æ„åï¼ŒVisionAnalyzer çš„ Prompt å¤§å¹…ç²¾ç®€â€”â€”ä¸å†éœ€è¦åˆ¤æ–­"ä»»åŠ¡å®Œæˆ/ä¸‹ä¸€æ­¥"ï¼š

```
åŸ Promptï¼ˆåˆ¤æ–­ 8 ç§çŠ¶æ€ï¼‰ï¼š
  INTERRUPTED | WAITING_CONFIRMATION | TERMINAL_RUNNING | 
  ERROR | COMPLETED | WORKING | IDLE | UNKNOWN

ç²¾ç®€å Promptï¼ˆåªåˆ¤æ–­ 4 ç§ UI çŠ¶æ€ï¼‰ï¼š
  WORKING    â€” AI æ­£åœ¨ç”Ÿæˆå†…å®¹
  IDLE       â€” è¾“å…¥æ¡†ç©ºé—²ï¼Œæ— æ´»åŠ¨
  INTERRUPTED â€” å‡ºç°"Continue"æŒ‰é’®æˆ–é™é€Ÿæç¤º
  ERROR      â€” å‡ºç°é”™è¯¯ä¿¡æ¯
```

å»æ‰äº† `COMPLETED`ï¼ˆç”± DevPlan ç²¾ç¡®åˆ¤æ–­ï¼‰å’Œ `TERMINAL_RUNNING`/`WAITING_CONFIRMATION`ï¼ˆåˆå¹¶åˆ° `WORKING`ï¼‰ã€‚

### 13.6 å®Œæ•´å·¥ä½œæµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Autopilot å…¨æµç¨‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                            â”‚
â”‚  1. ç”¨æˆ·åœ¨ Cursor IDE ä¸­è¯´ "å¼€å§‹ phase-17 å¼€å‘"                            â”‚
â”‚     â”œâ†’ AI è°ƒç”¨ devplan_start_phase("phase-17")                            â”‚
â”‚     â”œâ†’ AI åˆ›å»º TodoListï¼Œå¼€å§‹æ‰§è¡Œç¬¬ä¸€ä¸ªå­ä»»åŠ¡ T17.1                        â”‚
â”‚     â””â†’ DevPlan æ ‡è®° phase-17 ä¸º in_progress                               â”‚
â”‚                                                                            â”‚
â”‚  2. executor (Python) åå°è‡ªåŠ¨è¿è¡Œä¸­                                       â”‚
â”‚     â”œâ†’ è½®è¯¢ GET /api/auto/current-phase                                  â”‚
â”‚     â”‚  â†’ phase-17 in_progress, T17.1 in_progress                         â”‚
â”‚     â”œâ†’ æˆªå›¾åˆ¤æ–­ UI çŠ¶æ€ = WORKING                                        â”‚
â”‚     â””â†’ è”åˆå†³ç­–: ä»»åŠ¡è¿›è¡Œä¸­ + UI æ­£åœ¨å·¥ä½œ = ä¸æ“ä½œï¼Œç­‰å¾…                   â”‚
â”‚                                                                            â”‚
â”‚  3. AI é‡åˆ°é™é€Ÿ/ä¸­æ–­                                                      â”‚
â”‚     â”œâ†’ Cursor æ˜¾ç¤º "Continue" æŒ‰é’®                                       â”‚
â”‚     â”œâ†’ executor æˆªå›¾æ£€æµ‹ UI = INTERRUPTED                                â”‚
â”‚     â”œâ†’ DevPlan çŠ¶æ€: T17.1 ä» in_progressï¼ˆAI æ²¡æœºä¼šè°ƒ completeï¼‰         â”‚
â”‚     â”œâ†’ è”åˆå†³ç­–: ä»»åŠ¡æœªå®Œæˆ + UI ä¸­æ–­ = å‘é€"è¯·ç»§ç»­"                      â”‚
â”‚     â””â†’ executor é€šè¿‡ GUI è‡ªåŠ¨åŒ–å‘é€"è¯·ç»§ç»­"                               â”‚
â”‚                                                                            â”‚
â”‚  4. AI å®Œæˆå­ä»»åŠ¡ T17.1                                                   â”‚
â”‚     â”œâ†’ AI è°ƒç”¨ devplan_complete_task("T17.1")                             â”‚
â”‚     â”œâ†’ DevPlan æ ‡è®° T17.1 completedï¼Œæ›´æ–° phase-17 è¿›åº¦ (1/8)            â”‚
â”‚     â”œâ†’ AI ç»§ç»­æ‰§è¡Œ T17.2                                                 â”‚
â”‚     â””â†’ executor ä¸‹æ¬¡è½®è¯¢çœ‹åˆ° T17.1 completed, T17.2 in_progress          â”‚
â”‚                                                                            â”‚
â”‚  5. phase-17 å…¨éƒ¨ 8 ä¸ªå­ä»»åŠ¡å®Œæˆ                                          â”‚
â”‚     â”œâ†’ DevPlan è‡ªåŠ¨æ ‡è®° phase-17 completed                               â”‚
â”‚     â”œâ†’ executor è½®è¯¢ GET /api/auto/next-action                           â”‚
â”‚     â”‚  â†’ { action: "start_phase", phase: { taskId: "phase-18" } }        â”‚
â”‚     â”œâ†’ executor POST /api/auto/start-phase { taskId: "phase-18" }        â”‚
â”‚     â”œâ†’ executor åœ¨ Cursor IDE ä¸­å‘é€ "è¯·å¼€å§‹ phase-18 çš„ä»»åŠ¡"             â”‚
â”‚     â””â†’ AI æ”¶åˆ°æŒ‡ä»¤ï¼Œè°ƒç”¨ devplan_start_phase("phase-18")ï¼Œç»§ç»­å¼€å‘       â”‚
â”‚                                                                            â”‚
â”‚  6. å¾ªç¯ç›´åˆ°æ‰€æœ‰é˜¶æ®µå®Œæˆ                                                  â”‚
â”‚     â”œâ†’ /api/auto/next-action è¿”å› { action: "all_done" }                 â”‚
â”‚     â””â†’ executor åœæ­¢è‡ªåŠ¨åŒ–ï¼Œé€šçŸ¥ç”¨æˆ·                                      â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.7 ä¸ç°æœ‰åŠŸèƒ½çš„å¯¹æ¯”

| ç»´åº¦ | cursor_auto å½“å‰ | èåˆå (Autopilot) |
|------|----------------|-------------------|
| **ä»»åŠ¡æ„ŸçŸ¥** | çº¯æˆªå›¾çŒœæµ‹ | DevPlan ç²¾ç¡®çŠ¶æ€ + æˆªå›¾è¾…åŠ© |
| **ä»»åŠ¡æ¥æº** | `tasks.txt` æ‰‹å†™ | DevPlan ç»“æ„åŒ–ä»»åŠ¡ï¼ˆä¼˜å…ˆçº§ã€æ’åºã€å…³è”æ–‡æ¡£ï¼‰ |
| **è¿›åº¦è¿½è¸ª** | æ— ï¼ˆé‡å¯ä¸¢å¤±ï¼‰ | Git é”šå®š + å¯è§†åŒ–ä»ªè¡¨ç›˜ |
| **æ–­ç‚¹ç»­ä¼ ** | ä¸æ”¯æŒ | DevPlan å®Œç¾æ”¯æŒï¼ˆä»»åŠ¡çŠ¶æ€æŒä¹…åŒ–ï¼‰ |
| **å¤šé¡¹ç›®** | ä¸€æ¬¡åªèƒ½è·‘ä¸€ä¸ª `tasks.txt` | DevPlan å¤šé¡¹ç›®ç®¡ç† |
| **å¯è§†åŒ–** | ç®€é™‹ Web UI | DevPlan é¡¹ç›®å›¾è°± + ç»Ÿè®¡ä»ªè¡¨ç›˜ |
| **å‡†ç¡®æ€§** | Ollama è§†è§‰æ¨¡å‹åˆ¤æ–­ | DevPlan ç²¾ç¡®çŠ¶æ€ï¼ˆ100%ï¼‰+ æˆªå›¾è¾…åŠ©ï¼ˆUI å±‚ï¼‰ |
| **AI ä¸Šä¸‹æ–‡** | AI ä¸çŸ¥é“æœ‰è‡ªåŠ¨åŒ–å·¥å…·åœ¨è¿è¡Œ | AI é€šè¿‡ MCP å·¥å…·æ„ŸçŸ¥ autopilot çŠ¶æ€ |

### 13.8 å®æ–½è·¯çº¿å›¾

#### é˜¶æ®µä¸€ï¼ˆP0ï¼‰ï¼šcursor_auto åŸºç¡€é‡æ„

> ç›®æ ‡ï¼šè§£å†³å½“å‰ä»£ç è´¨é‡é—®é¢˜ï¼Œä¸º MCP é›†æˆåšå‡†å¤‡ã€‚

| å­ä»»åŠ¡ | è¯´æ˜ |
|--------|------|
| å¼•å…¥ç­–ç•¥æ¨¡å¼ç»Ÿä¸€çŠ¶æ€å¤„ç† | å°†é‡å¤çš„ `_handle_*` æ–¹æ³•æŠ½è±¡ä¸ºçŠ¶æ€å¤„ç†ç­–ç•¥ |
| åˆ†ç¦»å…³æ³¨ç‚¹ | CursorController ä¸åº”åŒ…å« AI æ¨¡å‹è°ƒç”¨ |
| ä½¿ç”¨æ ‡å‡† logging æ¨¡å— | æ›¿æ¢è‡ªåˆ¶æ—¥å¿—ç³»ç»Ÿ |
| é…ç½®ç³»ç»Ÿå‡çº§ | å¼•å…¥ dataclass æˆ– pydanticï¼Œæ”¯æŒ YAML/TOML |
| å¼‚æ­¥æ¶æ„æ”¹é€  | ä½¿ç”¨ `asyncio` æ›¿æ¢é˜»å¡å¼ `time.sleep()` |

#### é˜¶æ®µäºŒï¼ˆP0ï¼‰ï¼šDevPlan Autopilot API

> ç›®æ ‡ï¼šåœ¨å¯è§†åŒ–æœåŠ¡å™¨ä¸­æ–°å¢è‡ªåŠ¨åŒ– API ç«¯ç‚¹ï¼Œåœ¨ MCP Server ä¸­æ–°å¢ 3 ä¸ªå·¥å…·ã€‚

| å­ä»»åŠ¡ | æ¶‰åŠæ–‡ä»¶ |
|--------|---------|
| è®¾è®¡å¹¶å®ç° `/api/auto/next-action` ç«¯ç‚¹ | `src/visualize/server.ts` |
| å®ç° `/api/auto/current-phase` ç«¯ç‚¹ | `src/visualize/server.ts` |
| å®ç° `/api/auto/complete-task` å’Œ `/api/auto/start-phase` ç«¯ç‚¹ | `src/visualize/server.ts` |
| å®ç° `/api/auto/heartbeat` ç«¯ç‚¹ | `src/visualize/server.ts` |
| æ–°å¢ `devplan_auto_status` MCP å·¥å…· | `src/mcp-server/index.ts` |
| æ–°å¢ `devplan_auto_next` MCP å·¥å…· | `src/mcp-server/index.ts` |
| æ–°å¢ `devplan_auto_config` MCP å·¥å…· | `src/mcp-server/index.ts` |
| æ–°å¢ Autopilot ç±»å‹å®šä¹‰ | `src/types.ts` |

#### é˜¶æ®µä¸‰ï¼ˆP1ï¼‰ï¼šexecutor è¿å…¥ + æ¥å…¥ DevPlan

> ç›®æ ‡ï¼šå°† cursor_auto é‡æ„ä¸º executorï¼Œè¿å…¥ devplan é¡¹ç›®ï¼Œæ¥å…¥ HTTP APIã€‚

| å­ä»»åŠ¡ | è¯´æ˜ |
|--------|------|
| åˆ›å»º `executor/` ç›®å½•ç»“æ„ | `pyproject.toml`ã€`src/`ã€`tests/` |
| å®ç° `devplan_client.py` | HTTP å®¢æˆ·ç«¯ï¼Œå°è£… `/api/auto/*` è°ƒç”¨ |
| é‡å†™ `engine.py` | åŒé€šé“å†³ç­–å¼•æ“ï¼ˆDevPlan çŠ¶æ€ + UI æˆªå›¾ï¼‰ |
| ç²¾ç®€ `vision_analyzer.py` | Prompt ç²¾ç®€ä¸º 4 ç§ UI çŠ¶æ€ |
| è¿å…¥ `cursor_controller.py` | GUI è‡ªåŠ¨åŒ–ï¼ˆåŸºæœ¬ä¿ç•™ï¼‰ |
| åˆ é™¤ `tasks.txt` ä¾èµ– | æ‰€æœ‰ä»»åŠ¡ä» DevPlan è·å– |
| å®ç°è‡ªåŠ¨é˜¶æ®µåˆ‡æ¢ | é˜¶æ®µå®Œæˆåè‡ªåŠ¨ `start_phase` ä¸‹ä¸€é˜¶æ®µ |

#### é˜¶æ®µå››ï¼ˆP2ï¼‰ï¼šå¢å¼ºä¸ä¼˜åŒ–

| å­ä»»åŠ¡ | è¯´æ˜ |
|--------|------|
| è¾“å…¥æ¡†å®šä½æ”¹è¿› | ä½¿ç”¨ UI Automation API æ›¿ä»£åæ ‡ç¡¬ç¼–ç  |
| AI æ¨¡å‹å±‚æŠ½è±¡ | æ”¯æŒ Ollama / OpenAI ç­‰å¤šåç«¯ |
| Web UI é›†æˆ DevPlan è¿›åº¦ | åœ¨ executor çš„ Web UI ä¸­å±•ç¤ºé˜¶æ®µè¿›åº¦ |
| å¯è§†åŒ–é›†æˆ | åœ¨ DevPlan å›¾è°±ä¸­å±•ç¤º autopilot çŠ¶æ€ |
| æµ‹è¯•è¦†ç›– | å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯• |

### 13.9 cursor_auto åŸ repo å¤„ç†

åˆå¹¶å®Œæˆåï¼š

1. `D:\Project\git\cursor_auto` å½’æ¡£ï¼ˆä¿ç•™ä½†ä¸å†æ›´æ–°ï¼‰
2. åœ¨ cursor_auto çš„ README ä¸­æ ‡æ³¨ï¼š"æœ¬é¡¹ç›®å·²è¿ç§»è‡³ `aifastdb-devplan/executor/`"
3. åç»­æ‰€æœ‰å¼€å‘åœ¨ `aifastdb-devplan` é¡¹ç›®ä¸­è¿›è¡Œ

---

> **æ–‡æ¡£ç»´æŠ¤è¯´æ˜**ï¼šæœ¬æ–‡æ¡£æ˜¯ `aifastdb-devplan` é¡¹ç›®çš„å®Œæ•´åŠŸèƒ½æ–‡æ¡£ã€‚å½“é¡¹ç›®æœ‰é‡å¤§åŠŸèƒ½å˜æ›´æ—¶ï¼Œè¯·åŒæ­¥æ›´æ–°æœ¬æ–‡æ¡£å¯¹åº”ç« èŠ‚ã€‚

